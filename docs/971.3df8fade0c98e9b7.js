"use strict";(self.webpackChunkYugiTournamnet=self.webpackChunkYugiTournamnet||[]).push([[971],{9971:(yr,b,u)=>{u.r(b),u.d(b,{AdminModule:()=>gr});var m=u(316),_=u(4827),T=u(9204),d=u(4597),e=u(8450),M=u(3665),j=u(9101),f=u(4285),P=u(7137),I=u(5716),v=u(9706),l=u(4456);function w(n,i){if(1&n){const t=e.RV6();e.j41(0,"li",36),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectPlayer(a))}),e.j41(1,"span",37),e.EFF(2),e.k0s(),e.j41(3,"button",38),e.bIt("click",function(r){const o=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.confirmDelete(o,r))}),e.EFF(4," X "),e.k0s()()}if(2&n){const t=i.$implicit,s=e.XpG(2);e.AVh("bg-blue-600",(null==s.selectedPlayer?null:s.selectedPlayer.playerId)===t.playerId),e.R7$(2),e.JRh(t.fullName)}}function N(n,i){if(1&n&&(e.j41(0,"ul"),e.DNE(1,w,5,3,"li",35),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.players)}}function S(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openModal())}),e.EFF(1," Add Player "),e.k0s()}}const y=function(n){return{"opacity-50 cursor-not-allowed":n}};function R(n,i){if(1&n){const t=e.RV6();e.j41(0,"tr",46)(1,"td",47),e.EFF(2),e.k0s(),e.j41(3,"td",47),e.EFF(4),e.k0s(),e.j41(5,"td",47),e.EFF(6),e.k0s(),e.j41(7,"td",48)(8,"button",49),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.updateMatch(a.matchId,a.player1Id))}),e.EFF(9),e.k0s(),e.j41(10,"button",50),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.updateMatch(a.matchId,a.player2Id))}),e.EFF(11),e.k0s(),e.j41(12,"button",51),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.updateMatch(a.matchId,null))}),e.EFF(13),e.k0s(),e.j41(14,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.resetMatch(a.matchId))}),e.EFF(15),e.k0s()()()}if(2&n){const t=i.$implicit,s=i.index,r=e.XpG(2);e.Y8G("ngClass",s%2==0?"bg-gray-900":"bg-gray-950"),e.R7$(2),e.JRh(t.player1Name),e.R7$(2),e.JRh(t.player2Name),e.R7$(2),e.Lme(" ",t.score1," - ",t.score2," "),e.R7$(2),e.Y8G("disabled",t.isCompleted)("ngClass",e.eq3(15,y,t.isCompleted)),e.R7$(1),e.SpI(" ",r.loadingMatches[t.matchId]?"Load..":"Win P1"," "),e.R7$(1),e.Y8G("disabled",t.isCompleted)("ngClass",e.eq3(17,y,t.isCompleted)),e.R7$(1),e.SpI(" ",r.loadingMatches[t.matchId]?"Load..":"Win P2"," "),e.R7$(1),e.Y8G("disabled",t.isCompleted)("ngClass",e.eq3(19,y,t.isCompleted)),e.R7$(1),e.SpI(" ",r.loadingMatches[t.matchId]?"Load..":"Draw"," "),e.R7$(2),e.SpI(" ",r.loadingMatches[t.matchId]?"Load..":"Undo"," ")}}function D(n,i){if(1&n&&(e.j41(0,"div",40)(1,"h2",41),e.EFF(2),e.k0s(),e.j41(3,"table",42)(4,"thead")(5,"tr",43)(6,"th",44),e.EFF(7,"Player 1"),e.k0s(),e.j41(8,"th",44),e.EFF(9,"Player 2"),e.k0s(),e.j41(10,"th",44),e.EFF(11,"Result"),e.k0s(),e.j41(12,"th",44),e.EFF(13,"Actions"),e.k0s()()(),e.j41(14,"tbody"),e.DNE(15,R,16,21,"tr",45),e.k0s()()()),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Matches for ",t.selectedPlayer.fullName," "),e.R7$(13),e.Y8G("ngForOf",t.displayMatches)}}function E(n,i){if(1&n&&(e.j41(0,"div",53)(1,"h4",54),e.EFF(2),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.JRh(t.totalMessagesLeft)}}function G(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",55),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openStartLeagueModal())}),e.EFF(1," Start New League "),e.k0s()}}function $(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showEndLeagueModal=!0)}),e.EFF(1," End League "),e.k0s()}}function V(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",57),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onTournamentStageButtonClick())}),e.EFF(1),e.k0s()}if(2&n){const t=e.XpG();e.R7$(1),e.SpI(" \u{1f3c6} ",t.tournamentStageButtonText," ")}}function X(n,i){if(1&n&&(e.j41(0,"div",58)(1,"div",19)(2,"h3",20),e.EFF(3," League Description "),e.k0s(),e.j41(4,"p",59),e.EFF(5),e.k0s()(),e.j41(6,"div",19)(7,"h3",20),e.EFF(8,"\u0646\u0648\u0639 \u0627\u0644\u0628\u0637\u0648\u0644\u0629"),e.k0s(),e.j41(9,"p",59)(10,"span"),e.EFF(11),e.k0s(),e.EFF(12),e.k0s()(),e.j41(13,"div",19)(14,"h3",20),e.EFF(15,"\u0646\u0638\u0627\u0645 \u0627\u0644\u0628\u0637\u0648\u0644\u0629"),e.k0s(),e.j41(16,"p",59)(17,"span"),e.EFF(18),e.k0s(),e.EFF(19),e.k0s()(),e.j41(20,"div",19)(21,"h3",20),e.EFF(22,"Start Date"),e.k0s(),e.j41(23,"p",59),e.EFF(24),e.nI1(25,"date"),e.k0s()(),e.j41(26,"div",19)(27,"h3",20),e.EFF(28,"League Name"),e.k0s(),e.j41(29,"p",59),e.EFF(30),e.k0s()()()),2&n){const t=e.XpG();e.R7$(5),e.JRh(t.leagueData.description),e.R7$(6),e.JRh(t.getLeagueTypeIcon(t.leagueData.typeOfLeague)),e.R7$(1),e.SpI(" ",t.getLeagueTypeText(t.leagueData.typeOfLeague)," "),e.R7$(6),e.JRh(t.getSystemTypeIcon(t.leagueData.systemOfLeague)),e.R7$(1),e.SpI(" ",void 0!==t.leagueData.systemOfLeague?t.getSystemTypeText(t.leagueData.systemOfLeague):"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"," "),e.R7$(5),e.SpI(" ",e.i5U(25,7,t.leagueData.createdOn,"fullDate")," "),e.R7$(6),e.JRh(t.leagueData.name)}}const B=function(n,i){return{"bg-gray-900":n,"bg-gray-950":i}};function A(n,i){if(1&n){const t=e.RV6();e.j41(0,"tr",60)(1,"td",61),e.EFF(2),e.k0s(),e.j41(3,"td",30),e.EFF(4),e.k0s(),e.j41(5,"td",61),e.EFF(6),e.k0s(),e.j41(7,"td",61),e.EFF(8),e.k0s(),e.j41(9,"td",61),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td",61),e.EFF(13),e.k0s(),e.j41(14,"td",30)(15,"button",62),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.openDeleteLeagueModal(a.leagueId))}),e.EFF(16," Delete League "),e.k0s()()()}if(2&n){const t=i.$implicit,s=i.index,r=e.XpG();e.Y8G("ngClass",e.l_i(14,B,s%2==0,s%2!=0)),e.R7$(2),e.SpI(" ",t.leagueName," "),e.R7$(1),e.AVh("text-green-500",!t.isFinished)("text-red-500",t.isFinished),e.R7$(1),e.SpI(" ",t.isFinished?"Finished":"Live Now!!"," "),e.R7$(2),e.SpI(" ",r.getLeagueTypeTextForTable(t.leagueType)," "),e.R7$(2),e.SpI(" ",r.getSystemTypeTextForTable(t.systemOfLeague)," "),e.R7$(2),e.SpI(" ",e.i5U(11,11,t.createdOn,"yyyy/MM/dd")," "),e.R7$(3),e.SpI(" ",r.getWinnerForLeague(t)," ")}}function Y(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",63)(1,"div",64)(2,"h2",65),e.EFF(3,"Confirm Delete"),e.k0s(),e.j41(4,"p",66),e.EFF(5),e.k0s(),e.j41(6,"div",67)(7,"button",68),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeDeleteLeagueModal())}),e.EFF(8," Cancel "),e.k0s(),e.j41(9,"button",69),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.deleteConfirmedLeague())}),e.EFF(10," Delete "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI(' Are you sure you want to delete league "',null==t.selectedLeagueToDelete?null:t.selectedLeagueToDelete.leagueName,'"? ')}}function L(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h2",72),e.EFF(3,"Confirm Delete"),e.k0s(),e.j41(4,"p",73),e.EFF(5," Are you sure you want to delete "),e.j41(6,"strong"),e.EFF(7),e.k0s(),e.EFF(8,"? "),e.k0s(),e.j41(9,"div",74)(10,"button",75),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showDeleteModal=!1)}),e.EFF(11," Cancel "),e.k0s(),e.j41(12,"button",76),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.deleteConfirmedPlayer())}),e.EFF(13," Delete "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(7),e.JRh(null==t.selectedPlayerToDelete?null:t.selectedPlayerToDelete.fullName)}}function O(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h2",72),e.EFF(3,"Add New Player"),e.k0s(),e.j41(4,"input",77),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newPlayerName=r)}),e.k0s(),e.j41(5,"div",74)(6,"button",78),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeModal())}),e.EFF(7," Cancel "),e.k0s(),e.j41(8,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.addPlayer())}),e.EFF(9," Add "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngModel",t.newPlayerName)}}function U(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",81)(1,"label",82),e.EFF(2,"Rounds Per Match"),e.k0s(),e.j41(3,"input",88),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG(2);return e.Njj(a.newLeague.roundsPerMatch=r)}),e.k0s(),e.j41(4,"small",89),e.EFF(5," Number of rounds each player will play in a match (Points system only) "),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(3),e.Y8G("ngModel",t.newLeague.roundsPerMatch)}}function z(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",70)(1,"div",80)(2,"h2",72),e.EFF(3,"Start New League"),e.k0s(),e.j41(4,"div",81)(5,"label",82),e.EFF(6,"League Name"),e.k0s(),e.j41(7,"input",83),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newLeague.name=r)}),e.k0s()(),e.j41(8,"div",81)(9,"label",82),e.EFF(10,"League Description"),e.k0s(),e.j41(11,"textarea",84),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newLeague.description=r)}),e.k0s()(),e.j41(12,"div",81)(13,"label",82),e.EFF(14,"League Type"),e.k0s(),e.j41(15,"select",85),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newLeague.typeOfLeague=r)}),e.j41(16,"option",86),e.EFF(17,"Single"),e.k0s(),e.j41(18,"option",86),e.EFF(19,"Multi"),e.k0s(),e.j41(20,"option",86),e.EFF(21,"Groups"),e.k0s()()(),e.j41(22,"div",81)(23,"label",82),e.EFF(24,"System Of League"),e.k0s(),e.j41(25,"select",85),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newLeague.systemOfLeague=r)}),e.j41(26,"option",86),e.EFF(27,"Points"),e.k0s(),e.j41(28,"option",86),e.EFF(29,"Classic"),e.k0s()()(),e.DNE(30,U,6,1,"div",87),e.j41(31,"div",74)(32,"button",75),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeStartLeagueModal())}),e.EFF(33," Cancel "),e.k0s(),e.j41(34,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.startLeague())}),e.EFF(35," Start League "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngModel",t.newLeague.name),e.R7$(4),e.Y8G("ngModel",t.newLeague.description),e.R7$(4),e.Y8G("ngModel",t.newLeague.typeOfLeague),e.R7$(1),e.Y8G("ngValue",0),e.R7$(2),e.Y8G("ngValue",1),e.R7$(2),e.Y8G("ngValue",2),e.R7$(5),e.Y8G("ngModel",t.newLeague.systemOfLeague),e.R7$(1),e.Y8G("ngValue",0),e.R7$(2),e.Y8G("ngValue",1),e.R7$(2),e.Y8G("ngIf",0===t.newLeague.systemOfLeague)}}function J(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"h2",72),e.EFF(3,"Confirm End League"),e.k0s(),e.j41(4,"p",73),e.EFF(5," Are you sure you want to end the current league? This action cannot be undone. "),e.k0s(),e.j41(6,"div",74)(7,"button",75),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showEndLeagueModal=!1)}),e.EFF(8," Cancel "),e.k0s(),e.j41(9,"button",76),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.resetTournament(r.leagueData.id))}),e.EFF(10," Confirm End "),e.k0s()()()()}}function H(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2).$implicit,a=e.XpG(2);return e.Njj(a.toggleHideNote(r))}),e.EFF(1," Show "),e.k0s()}}function Q(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",106),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2).$implicit,a=e.XpG(2);return e.Njj(a.toggleHideNote(r))}),e.EFF(1," Hide "),e.k0s()}}function q(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",102)(1,"p",103),e.EFF(2),e.k0s(),e.j41(3,"button",78),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.toggleDeleteNote(r.id))}),e.EFF(4," Delete "),e.k0s(),e.DNE(5,H,2,0,"button",104),e.DNE(6,Q,2,0,"button",105),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",t.content," "),e.R7$(3),e.Y8G("ngIf",1==t.isHidden),e.R7$(1),e.Y8G("ngIf",0==t.isHidden)}}function W(n,i){if(1&n&&(e.j41(0,"div"),e.DNE(1,q,7,3,"div",101),e.k0s()),2&n){const t=i.$implicit;e.R7$(1),e.Y8G("ngIf",0==t.isDeleted)}}function Z(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",70)(1,"div",90)(2,"div")(3,"h2",91),e.EFF(4,"Add New Note"),e.k0s(),e.j41(5,"div")(6,"label",92)(7,"span",93),e.EFF(8,"Notes"),e.k0s(),e.j41(9,"div",94)(10,"textarea",95),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newNote=r)}),e.k0s(),e.j41(11,"div",96)(12,"button",97),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.sendNote())}),e.EFF(13," Save "),e.k0s()()()()()(),e.j41(14,"div",98),e.DNE(15,W,2,1,"div",99),e.k0s(),e.j41(16,"button",100),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeNoteModal())}),e.EFF(17," Cancel "),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(10),e.Y8G("ngModel",t.newNote),e.R7$(5),e.Y8G("ngForOf",t.notes)}}const K=function(n,i){return{"w-64 p-4 sm:min-h-screen":n,"w-0 p-0":i}};let x=(()=>{class n{constructor(t,s,r,a,o,c){this.playerService=t,this.matchService=s,this.toastr=r,this.leagueService=a,this.noteService=o,this.adminDashboardService=c,this.players=[],this.selectedPlayer=null,this.playerMatches=[],this.displayMatches=[],this.notes=[],this.showModal=!1,this.newPlayerName="",this.isSidebarOpen=!1,this.showDeleteModal=!1,this.showNoteModal=!1,this.showDeleteLeagueModal=!1,this.showEndLeagueModal=!1,this.loadingMatches={},this.leagueData=null,this.showStartLeagueModal=!1,this.newLeague={name:"",description:"",typeOfLeague:0,systemOfLeague:0,roundsPerMatch:3},this.totalMessagesLeft=0,this.totalPlayers=0,this.totalMatches=0,this.totalMatchesLeft=0,this.totalMessages=0,this.leagues=[],this.newNote="",this.selectedLeagueToDelete=null,this.currentMatches=[],this.showTournamentStageButton=!1,this.tournamentStageButtonText="",this.tournamentStageButtonAction=null,this.requestQueue=[],this.isProcessingQueue=!1,this.showResetModal=!1,this.selectedPlayerToDelete=null}ngOnInit(){this.loadEssentialData()}ngOnDestroy(){}loadEssentialData(){this.adminDashboardService.getEssentialData().subscribe({next:t=>{this.players=t.players,this.currentMatches=t.matches,this.leagueData=t.currentLeague,this.leagues=t.allLeagues.reverse(),this.notes=t.notes,this.totalPlayers=t.stats.totalPlayers,this.totalMatches=t.stats.totalMatches,this.totalMatchesLeft=t.stats.totalMatchesLeft,this.totalMessagesLeft=t.stats.totalMessagesLeft,this.updateTournamentStageButton()},error:t=>{this.toastr.error("\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a")}})}toggleSidebar(){this.isSidebarOpen=!this.isSidebarOpen,this.selectedPlayer=null}selectPlayer(t){this.selectedPlayer=t,this.loadMatches()}loadMatches(){this.selectedPlayer&&this.matchService.getAdminMatches().subscribe(t=>{this.playerMatches=t.filter(s=>s.player1Id===this.selectedPlayer.playerId||s.player2Id===this.selectedPlayer.playerId).sort((s,r)=>{const a=(s.player1Id===this.selectedPlayer.playerId?s.player2Name:s.player1Name)?.toLowerCase()??"",o=(r.player1Id===this.selectedPlayer.playerId?r.player2Name:r.player1Name)?.toLowerCase()??"";return a.localeCompare(o)}),this.displayMatches=this.playerMatches.map(s=>s.player2Id===this.selectedPlayer.playerId?{...s,player1Name:s.player2Name,player2Name:s.player1Name,score1:s.score2,score2:s.score1,player1Id:s.player2Id,player2Id:s.player1Id}:{...s}),this.playerMatches.forEach(s=>{this.loadingMatches[s.matchId]=!1})})}addToQueue(t){this.requestQueue.push(t),this.processQueue()}processQueue(){var t=this;return(0,T.A)(function*(){if(t.isProcessingQueue||0===t.requestQueue.length)return;t.isProcessingQueue=!0;const s=t.requestQueue.shift();if(s)try{yield s()}catch{}t.isProcessingQueue=!1,t.processQueue()})()}updateMatch(t,s){this.loadingMatches[t]=!0,this.addToQueue(()=>new Promise((r,a)=>{this.matchService.updateMatch(t,s).subscribe({next:o=>{o.success?(this.toastr.success(o.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData(),this.loadMatches()):this.toastr.error(o.message),this.loadingMatches[t]=!1,r()},error:o=>{this.toastr.error(o.error.message),this.loadingMatches[t]=!1,a(o)}})}))}resetMatch(t){this.loadingMatches[t]=!0,this.addToQueue(()=>new Promise((s,r)=>{this.matchService.resetMatch(t).subscribe({next:a=>{a.success?(this.toastr.success(a.message),this.loadMatches()):this.toastr.error(a.message,"Error"),this.loadingMatches[t]=!1,s()},error:a=>{this.toastr.error(a.error.message),this.loadingMatches[t]=!1,r(a)}})}))}deletePlayer(t,s){s.stopPropagation(),this.playerService.deletePlayer(t).subscribe(()=>{this.toastr.warning("Player deleted!","Deleted"),this.loadMatches(),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData(),this.updateTournamentStageButton(),this.selectedPlayer?.playerId===t&&(this.selectedPlayer=null,this.playerMatches=[],this.displayMatches=[])})}openModal(){this.showModal=!0}closeModal(){this.showModal=!1,this.newPlayerName=""}addPlayer(){this.newPlayerName.trim()&&this.playerService.addPlayer(this.newPlayerName).subscribe(t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData(),this.loadMatches(),this.closeModal()):this.toastr.warning(t.message)})}confirmDelete(t,s){s.stopPropagation(),this.selectedPlayerToDelete=t,this.showDeleteModal=!0}deleteConfirmedPlayer(){this.selectedPlayerToDelete&&(this.playerService.deletePlayer(this.selectedPlayerToDelete.playerId).subscribe(t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData(),this.loadMatches()):this.toastr.error(t.message,"Error")}),this.showDeleteModal=!1,this.selectedPlayerToDelete=null)}resetTournament(t){this.leagueService.resetLeague(t).subscribe({next:s=>{s.success?(this.toastr.success(s.message),this.showResetModal=!1,this.loadMatches(),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData(),this.showEndLeagueModal=!1):this.toastr.error(s.message)},error:s=>{this.toastr.error(s.error.message)}})}openStartLeagueModal(){this.showStartLeagueModal=!0,this.newLeague={name:"",description:"",typeOfLeague:0,systemOfLeague:0,roundsPerMatch:3}}closeStartLeagueModal(){this.showStartLeagueModal=!1}startLeague(){this.newLeague.name.trim()?0!==this.newLeague.systemOfLeague||this.newLeague.roundsPerMatch&&!(this.newLeague.roundsPerMatch<1)?this.leagueService.startLeague(this.newLeague).subscribe({next:t=>{t.success?(this.toastr.success(t.message),this.closeStartLeagueModal(),this.loadMatches(),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()):this.toastr.error(t.message,"Error")},error:t=>{this.toastr.error(t.error.message)}}):this.toastr.error("Rounds per match is required for Points system and must be at least 1","Error"):this.toastr.error("League name is required","Error")}DeleteLeague(t){this.leagueService.DeleteLeague(t).subscribe({next:s=>{s.success?(this.toastr.success(s.message),this.showDeleteLeagueModal=!1):this.toastr.error(s.message)},error:s=>{this.toastr.error(s.error.message)}})}openDeleteLeagueModal(t){this.selectedLeagueToDelete=this.leagues.find(s=>s.leagueId===t)||null,this.showDeleteLeagueModal=!0}closeDeleteLeagueModal(){this.showDeleteLeagueModal=!1,this.selectedLeagueToDelete=null}deleteConfirmedLeague(){this.selectedLeagueToDelete&&(this.DeleteLeague(this.selectedLeagueToDelete.leagueId),this.leagues=this.leagues.filter(t=>t.leagueId!==this.selectedLeagueToDelete?.leagueId),this.closeDeleteLeagueModal())}sendNote(){this.newNote.trim()&&this.noteService.sendNote(this.newNote).subscribe({next:t=>{this.toastr.success(t.message),this.newNote="",this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()},error:()=>this.toastr.error("\u062d\u0635\u0644 \u0645\u0634\u0643\u0644\u0629 \u0648\u0627\u0646\u062a \u0628\u062a\u0628\u0639\u062a \u0627\u0644\u0645\u0644\u0627\u062d\u0638\u0629")})}toggleHideNote(t){this.noteService.toggleMarHide(t.id,!t.isHidden).subscribe({next:s=>{this.toastr.success(s.message),this.loadEssentialData()},error:()=>this.toastr.error("\u062d\u0635\u0644 \u0645\u0634\u0643\u0644\u0629 \u0648\u0627\u0646\u062a \u0628\u062a\u063a\u064a\u0631 \u0627\u0644\u0638\u0647\u0648\u0631")})}toggleDeleteNote(t){this.noteService.DeleteNote(t,!1).subscribe({next:s=>{this.toastr.warning(s.message),this.loadEssentialData()},error:()=>this.toastr.error("\u062d\u0635\u0644 \u0645\u0634\u0643\u0644\u0629 \u0648\u0627\u0646\u062a \u0628\u062a\u062d\u0630\u0641 ")})}openNoteModal(){this.showNoteModal=!0}closeNoteModal(){this.showNoteModal=!1}updateTournamentStageButton(){if(!this.leagueData)return void(this.showTournamentStageButton=!1);const t=this.leagueData.typeOfLeague;if(t!==d.Ck.Groups&&"Groups"!==t&&2!==t)return void(this.showTournamentStageButton=!1);if(this.totalPlayers>0&&0===this.currentMatches.length)return this.showTournamentStageButton=!0,this.tournamentStageButtonText="\u0627\u0628\u062f\u0623 \u062f\u0648\u0631 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0627\u062a",void(this.tournamentStageButtonAction=()=>this.startGroupStage());const r=this.currentMatches.filter(h=>h.stage===d.gD.GroupStage||"GroupStage"===h.tournamentStage),a=this.currentMatches.filter(h=>h.stage===d.gD.QuarterFinals||"QuarterFinals"===h.tournamentStage),o=this.currentMatches.filter(h=>h.stage===d.gD.SemiFinals||"SemiFinals"===h.tournamentStage),c=this.currentMatches.filter(h=>h.stage===d.gD.Final||"Final"===h.tournamentStage),g=r.length>0&&r.every(h=>h.isCompleted),_r=a.length>0&&a.every(h=>h.isCompleted),fr=o.length>0&&o.every(h=>h.isCompleted);return r.length>0&&g&&0===a.length?(this.showTournamentStageButton=!0,this.tournamentStageButtonText="\u0627\u0628\u062f\u0623 \u062f\u0648\u0631 \u0631\u0628\u0639 \u0627\u0644\u0646\u0647\u0627\u0626\u064a",void(this.tournamentStageButtonAction=()=>this.startQuarterStage())):a.length>0&&_r&&0===o.length?(this.showTournamentStageButton=!0,this.tournamentStageButtonText="\u0627\u0628\u062f\u0623 \u062f\u0648\u0631 \u0646\u0635\u0641 \u0627\u0644\u0646\u0647\u0627\u0626\u064a",void(this.tournamentStageButtonAction=()=>this.startSemiFinalStage())):o.length>0&&fr&&0===c.length?(this.showTournamentStageButton=!0,this.tournamentStageButtonText="\u0627\u0628\u062f\u0623 \u0627\u0644\u0646\u0647\u0627\u0626\u064a",void(this.tournamentStageButtonAction=()=>this.startFinalStage())):void(this.showTournamentStageButton=!1)}startGroupStage(){this.leagueData&&this.leagueService.createGroupsAndMatches(this.leagueData.id).subscribe({next:t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()):this.toastr.error(t.message)},error:t=>{this.toastr.error(t.error.message)}})}startQuarterStage(){this.leagueData&&this.leagueService.startKnockoutStage(this.leagueData.id).subscribe({next:t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()):this.toastr.error(t.message)},error:t=>{this.toastr.error(t.error.message)}})}startSemiFinalStage(){this.leagueData&&this.leagueService.startSemiFinals(this.leagueData.id).subscribe({next:t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()):this.toastr.error(t.message)},error:t=>{this.toastr.error(t.error.message)}})}startFinalStage(){this.leagueData&&this.leagueService.startFinal(this.leagueData.id).subscribe({next:t=>{t.success?(this.toastr.success(t.message),this.adminDashboardService.invalidateCache("essential"),this.loadEssentialData()):this.toastr.error(t.message)},error:t=>{this.toastr.error(t.error.message)}})}onTournamentStageButtonClick(){this.tournamentStageButtonAction&&this.tournamentStageButtonAction()}coerceLeagueType(t){if("number"==typeof t&&(t===d.Ck.Single||t===d.Ck.Multi||t===d.Ck.Groups))return t;if("string"==typeof t){const s=t.toLowerCase();if("single"===s||"0"===s)return d.Ck.Single;if("multi"===s||"1"===s)return d.Ck.Multi;if("groups"===s||"2"===s)return d.Ck.Groups}}coerceSystemType(t){if("number"==typeof t&&(t===d.KE.Points||t===d.KE.Classic))return t;if("string"==typeof t){const s=t.toLowerCase();if("points"===s||"0"===s)return d.KE.Points;if("classic"===s||"1"===s)return d.KE.Classic}}getLeagueTypeText(t){switch(this.coerceLeagueType(t)){case d.Ck.Single:return"\u0628\u0637\u0648\u0644\u0629 \u0641\u0631\u062f\u064a\u0629";case d.Ck.Multi:return"\u0628\u0637\u0648\u0644\u0629 \u0645\u062a\u0639\u062f\u062f\u0629";case d.Ck.Groups:return"\u0628\u0637\u0648\u0644\u0629 \u0645\u062c\u0645\u0648\u0639\u0627\u062a";default:return"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}}getLeagueTypeIcon(t){const s=this.coerceLeagueType(t);return s===d.Ck.Single?"\u{1f464}":s===d.Ck.Multi?"\u{1f465}":s===d.Ck.Groups?"\u{1f3c6}":""}getSystemTypeText(t){switch(this.coerceSystemType(t)){case d.KE.Points:return"\u0646\u0638\u0627\u0645 \u0627\u0644\u0646\u0642\u0627\u0637";case d.KE.Classic:return"\u0627\u0644\u0646\u0638\u0627\u0645 \u0627\u0644\u0643\u0644\u0627\u0633\u064a\u0643\u064a";default:return"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}}getSystemTypeIcon(t){const s=this.coerceSystemType(t);return s===d.KE.Points?"\u{1f4ca}":s===d.KE.Classic?"\u2694\ufe0f":""}getLeagueTypeTextForTable(t){return 0===t||"Single"===t?"\u0628\u0637\u0648\u0644\u0629 \u0641\u0631\u062f\u064a\u0629":1===t||"Multi"===t?"\u0628\u0637\u0648\u0644\u0629 \u0645\u062a\u0639\u062f\u062f\u0629":2===t||"Groups"===t?"\u0628\u0637\u0648\u0644\u0629 \u0645\u062c\u0645\u0648\u0639\u0627\u062a":"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}getSystemTypeTextForTable(t){return 0===t||"Points"===t?"\u0646\u0638\u0627\u0645 \u0627\u0644\u0646\u0642\u0627\u0637":1===t||"Classic"===t?"\u0627\u0644\u0646\u0638\u0627\u0645 \u0627\u0644\u0643\u0644\u0627\u0633\u064a\u0643\u064a":"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}getWinnerForLeague(t){if(2===t.leagueType||t.leagueType===d.Ck.Groups||"Groups"===String(t.leagueType)){if(t.knockoutMatches&&t.knockoutMatches.length>0){const s=t.knockoutMatches.find(r=>"Final"===(r.stage||r.tournamentStage));if(s&&s.isCompleted&&s.winnerId){if(s.winnerId===s.player1Id)return s.player1Name;if(s.winnerId===s.player2Id)return s.player2Name}}if(t.matches&&t.matches.length>0){const s=t.matches.find(r=>"Final"===(r.stage||r.tournamentStage));if(s&&s.isCompleted&&s.winnerId){if(s.winnerId===s.player1Id)return s.player1Name;if(s.winnerId===s.player2Id)return s.player2Name}}return t.players&&t.players.length>0?t.players[0].fullName:"No Winner Yet"}return t.players&&t.players.length>0?t.players[0].fullName:"No Winner Yet"}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(M.x),e.rXU(j.T),e.rXU(f.tw),e.rXU(P.N),e.rXU(I.i),e.rXU(v.p))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-players"]],decls:69,vars:22,consts:[[1,"block","sm:flex","transition-all","duration-600"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","text-white","transition-all","duration-600",3,"ngClass"],[1,"text-lg","font-bold","mb-4","flex","justify-between","overflow-hidden","text-white"],[1,"text-gray-300","text-3xl",3,"click"],[4,"ngIf"],["class","mt-4 w-full bg-green-600 p-2 rounded text-white hover:bg-green-700 transition",3,"click",4,"ngIf"],[1,"sm:flex-1","sm:p-2","transition-all","duration-600","sm:container","sm:mx-auto"],["class","sm:w-4/6 mx-auto",4,"ngIf"],[1,"my-3","border-gray-600"],[1,"grid","grid-cols-2","lg:grid-cols-4","gap-4","pt-5"],[1,"bg-blue-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-blue-700","transition",3,"click"],["routerLink","/admin/inbox",1,"bg-orange-600","hover:bg-orange-700","text-white","mb-4","px-3","py-2","rounded","transition-all","relative"],["class","absolute -top-2 -right-2 w-[30px] h-[30px] rounded-full bg-green-600 flex justify-center items-center",4,"ngIf"],["class","bg-green-600 text-white px-3 py-2 rounded mb-4 hover:bg-green-700 transition",3,"click",4,"ngIf"],["class","bg-red-600 text-white px-3 py-2 rounded mb-4 hover:bg-red-700 transition","s","",3,"click",4,"ngIf"],["class","bg-purple-600 text-white px-3 py-2 rounded mb-4 hover:bg-purple-700 transition font-bold",3,"click",4,"ngIf"],[1,"bg-indigo-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-indigo-700","transition",3,"click"],["class","grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-8","container","mx-auto"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","shadow-md","rounded","p-6","text-center"],[1,"text-lg","font-semibold","mb-2","text-white"],[1,"text-3xl","font-bold","text-red-500"],[1,"text-3xl","font-bold","text-green-500"],[1,"text-3xl","font-bold","text-blue-500"],[1,"text-center"],[1,"mb-4","text-4xl","font-extrabold","leading-none","tracking-tight","md:text-4xl","lg:text-4xl","text-white"],[1,"max-h-[350px]","overflow-x-auto"],[1,"min-w-full","divide-y-2","divide-gray-600"],[1,"sticky","top-0","bg-black","bg-opacity-50","backdrop-blur-sm"],[1,"*:font-medium","*:text-white"],[1,"px-3","py-2","whitespace-nowrap"],[1,"divide-y","divide-gray-600"],["class","*:font-bold *:first:font-medium",3,"ngClass",4,"ngFor","ngForOf"],["class","fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50",4,"ngIf"],["class","flex items-center justify-between p-2 cursor-pointer rounded-md hover:bg-gray-700",3,"bg-blue-600","click",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-2","cursor-pointer","rounded-md","hover:bg-gray-700",3,"click"],[1,"text-white"],[1,"bg-red-600","px-2","py-1","text-sm","rounded","text-white","hover:bg-red-700","transition",3,"click"],[1,"mt-4","w-full","bg-green-600","p-2","rounded","text-white","hover:bg-green-700","transition",3,"click"],[1,"sm:w-4/6","mx-auto"],[1,"text-2xl","font-bold","mb-4","text-center","text-white"],[1,"w-full","border-collapse","border","border-gray-600","text-center"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","text-white"],[1,"border","border-gray-600","p-2"],["class","border border-gray-600",3,"ngClass",4,"ngFor","ngForOf"],[1,"border","border-gray-600",3,"ngClass"],[1,"p-2","font-bold","text-white"],[1,"p-2"],[1,"bg-blue-600","px-2","py-1","rounded","text-white","hover:bg-blue-700","transition-all",3,"disabled","ngClass","click"],[1,"bg-blue-600","px-2","py-1","rounded","text-white","mx-1","hover:bg-blue-700","transition-all",3,"disabled","ngClass","click"],[1,"bg-yellow-600","px-2","py-1","rounded","text-white","hover:bg-yellow-700","transition-all",3,"disabled","ngClass","click"],[1,"bg-gray-600","px-2","py-1","rounded","text-white","ml-2","hover:bg-gray-700","transition-all",3,"click"],[1,"absolute","-top-2","-right-2","w-[30px]","h-[30px]","rounded-full","bg-green-600","flex","justify-center","items-center"],[1,"text-white","font-bold"],[1,"bg-green-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-green-700","transition",3,"click"],["s","",1,"bg-red-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-red-700","transition",3,"click"],[1,"bg-purple-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-purple-700","transition","font-bold",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-8"],[1,"font-bold","text-gray-300"],[1,"*:font-bold","*:first:font-medium",3,"ngClass"],[1,"px-3","py-2","whitespace-nowrap","text-white"],[1,"bg-red-600","text-white","px-3","py-2","rounded","hover:bg-red-700","transition",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-75","flex","items-center","justify-center","z-50"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-6","rounded-lg","shadow-lg","w-96"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"text-gray-300","mb-6"],[1,"flex","justify-end","space-x-4"],[1,"bg-gray-600","text-white","px-4","py-2","rounded","hover:bg-gray-700","transition",3,"click"],[1,"bg-red-600","text-white","px-4","py-2","rounded","hover:bg-red-700","transition",3,"click"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-75","z-50"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-6","rounded-lg"],[1,"text-lg","font-bold","mb-4","text-white"],[1,"text-gray-300"],[1,"mt-4","flex","justify-end"],[1,"bg-gray-600","px-4","py-2","text-white","rounded","mr-2","hover:bg-gray-700","transition",3,"click"],[1,"bg-red-600","px-4","py-2","text-white","rounded","hover:bg-red-700","transition",3,"click"],["type","text","placeholder","Enter player name",1,"border","border-gray-600","p-2","w-full","bg-gray-800","text-white","rounded","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"bg-red-600","px-4","py-2","text-white","rounded","mr-2","hover:bg-red-700","transition",3,"click"],[1,"bg-green-600","px-4","py-2","text-white","rounded","hover:bg-green-700","transition",3,"click"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-6","rounded-lg","w-96"],[1,"mb-4"],[1,"block","text-sm","font-medium","mb-1","text-gray-300"],["type","text","placeholder","Enter league name",1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","ngModelChange"],["placeholder","Enter league description","rows","3",1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white",3,"ngModel","ngModelChange"],[3,"ngValue"],["class","mb-4",4,"ngIf"],["type","number","min","1","max","10","placeholder","Enter number of rounds per match (e.g., 3)",1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"text-gray-400","text-xs","mt-1","block"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-4","rounded-lg"],[1,"font-bold","text-white","text-center"],["for","Notes"],[1,"text-sm","font-medium","text-gray-300"],[1,"relative","m-2","overflow-hidden","rounded","border-gray-600"],["id","Notes","rows","4",1,"w-full","resize-none","p-3","border","border-gray-600","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"flex","items-center","justify-end","gap-2","p-1.5"],["type","button",1,"rounded","p-2","font-bold","text-white","bg-green-600","hover:bg-green-700","transition",3,"click"],[1,"p-6"],[4,"ngFor","ngForOf"],[1,"bg-gray-600","px-4","py-2","text-white","rounded","hover:bg-gray-700","transition",3,"click"],["class","mt-4 flex items-center justify-end",4,"ngIf"],[1,"mt-4","flex","items-center","justify-end"],[1,"font-bold","px-3","text-white"],["class","bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition",3,"click",4,"ngIf"],["class","bg-purple-600 px-4 py-2 text-white rounded hover:bg-purple-700 transition",3,"click",4,"ngIf"],[1,"bg-purple-600","px-4","py-2","text-white","rounded","hover:bg-purple-700","transition",3,"click"]],template:function(s,r){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3," Players "),e.j41(4,"button",3),e.bIt("click",function(){return r.toggleSidebar()}),e.EFF(5," \xd7 "),e.k0s()(),e.DNE(6,N,2,1,"ul",4),e.DNE(7,S,2,0,"button",5),e.k0s(),e.j41(8,"div",6),e.DNE(9,D,16,2,"div",7),e.nrm(10,"hr",8),e.j41(11,"div")(12,"div",9)(13,"button",10),e.bIt("click",function(){return r.toggleSidebar()}),e.EFF(14," \u2630 Players "),e.k0s(),e.j41(15,"button",11),e.EFF(16," Inbox "),e.DNE(17,E,3,1,"div",12),e.k0s(),e.DNE(18,G,2,0,"button",13),e.DNE(19,$,2,0,"button",14),e.DNE(20,V,2,1,"button",15),e.j41(21,"button",16),e.bIt("click",function(){return r.openNoteModal()}),e.EFF(22," Notes "),e.k0s()(),e.DNE(23,X,31,10,"div",17),e.j41(24,"div",18)(25,"div",19)(26,"h3",20),e.EFF(27," Remaining Matches "),e.k0s(),e.j41(28,"p",21),e.EFF(29),e.k0s()(),e.j41(30,"div",19)(31,"h3",20),e.EFF(32,"Total Matches"),e.k0s(),e.j41(33,"p",22),e.EFF(34),e.k0s()(),e.j41(35,"div",19)(36,"h3",20),e.EFF(37,"Total Players"),e.k0s(),e.j41(38,"p",23),e.EFF(39),e.k0s()()()(),e.j41(40,"div",24)(41,"h2",25),e.EFF(42," All Leagues "),e.k0s(),e.j41(43,"div",26)(44,"table",27)(45,"thead",28)(46,"tr",29)(47,"th",30),e.EFF(48,"League Name"),e.k0s(),e.j41(49,"th",30),e.EFF(50,"League Status"),e.k0s(),e.j41(51,"th",30),e.EFF(52,"League Type"),e.k0s(),e.j41(53,"th",30),e.EFF(54,"League System"),e.k0s(),e.j41(55,"th",30),e.EFF(56,"League Date"),e.k0s(),e.j41(57,"th",30),e.EFF(58,"Winner"),e.k0s(),e.j41(59,"th",30),e.EFF(60,"Delete"),e.k0s()()(),e.j41(61,"tbody",31),e.DNE(62,A,17,17,"tr",32),e.k0s()()()()(),e.DNE(63,Y,11,1,"div",33),e.DNE(64,L,14,1,"div",34),e.DNE(65,O,10,1,"div",34),e.DNE(66,z,36,10,"div",34),e.DNE(67,J,11,0,"div",34),e.DNE(68,Z,18,2,"div",34),e.k0s()),2&s&&(e.R7$(1),e.Y8G("ngClass",e.l_i(19,K,r.isSidebarOpen,!r.isSidebarOpen)),e.R7$(5),e.Y8G("ngIf",r.isSidebarOpen),e.R7$(1),e.Y8G("ngIf",r.isSidebarOpen),e.R7$(2),e.Y8G("ngIf",r.selectedPlayer),e.R7$(8),e.Y8G("ngIf",r.totalMessagesLeft>0),e.R7$(1),e.Y8G("ngIf",null==r.leagueData),e.R7$(1),e.Y8G("ngIf",null!=r.leagueData),e.R7$(1),e.Y8G("ngIf",r.showTournamentStageButton&&null!=r.leagueData),e.R7$(3),e.Y8G("ngIf",r.leagueData),e.R7$(6),e.JRh(r.totalMatchesLeft),e.R7$(5),e.JRh(r.totalMatches),e.R7$(5),e.JRh(r.totalPlayers),e.R7$(23),e.Y8G("ngForOf",r.leagues),e.R7$(1),e.Y8G("ngIf",r.showDeleteLeagueModal),e.R7$(1),e.Y8G("ngIf",r.showDeleteModal),e.R7$(1),e.Y8G("ngIf",r.showModal),e.R7$(1),e.Y8G("ngIf",r.showStartLeagueModal),e.R7$(1),e.Y8G("ngIf",r.showEndLeagueModal),e.R7$(1),e.Y8G("ngIf",r.showNoteModal))},dependencies:[m.YU,m.Sq,m.bT,_.Wk,l.xH,l.y7,l.me,l.Q0,l.wz,l.BC,l.VZ,l.zX,l.vS,m.vh]})}}return n})();var ee=u(6375);const te=["messagesContainer"];function re(n,i){1&n&&(e.j41(0,"div",9),e.EFF(1," No messages here \u{1f4ed} "),e.k0s())}function se(n,i){if(1&n&&(e.j41(0,"span",16),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" ",t.unreadCount," ")}}function ne(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",12),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.openChat(a.senderId))}),e.j41(1,"div")(2,"p",13),e.EFF(3),e.k0s(),e.j41(4,"p",14),e.EFF(5),e.k0s()(),e.DNE(6,se,2,1,"span",15),e.k0s()}if(2&n){const t=i.$implicit;e.R7$(3),e.JRh(t.senderFullName),e.R7$(2),e.JRh(t.lastMessage),e.R7$(1),e.Y8G("ngIf",t.unreadCount>0)}}function ae(n,i){if(1&n&&(e.j41(0,"div",10),e.DNE(1,ne,7,3,"div",11),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.playerChats)("ngForTrackBy",t.trackByPlayerId)}}const ie=function(n,i){return{"text-right":n,"text-left":i}},oe=function(n,i){return{"bg-green-700":n,"bg-gray-700 ":i}};function le(n,i){if(1&n&&(e.j41(0,"div",31)(1,"div",32)(2,"p",33),e.EFF(3),e.k0s(),e.j41(4,"p",34),e.EFF(5),e.nI1(6,"date"),e.k0s()()()),2&n){const t=i.$implicit;e.Y8G("ngClass",e.l_i(7,ie,!t.isFromAdmin,t.isFromAdmin)),e.R7$(1),e.Y8G("ngClass",e.l_i(10,oe,!t.isFromAdmin,t.isFromAdmin)),e.R7$(2),e.JRh(t.content),e.R7$(2),e.SpI(" ",e.i5U(6,4,t.sentAt,"MMM d, y, hh:mm a")," ")}}const F=function(n){return{"sm:left-1/3":n}},ce=function(){return{standalone:!0}};function de(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"div",19)(3,"button",20),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeChat())}),e.nrm(4,"i",21),e.k0s(),e.j41(5,"div")(6,"p",22),e.EFF(7),e.k0s(),e.j41(8,"p",23),e.EFF(9),e.k0s()()()(),e.j41(10,"div",24,25),e.DNE(12,le,7,13,"div",26),e.k0s(),e.j41(13,"div",27)(14,"form",28),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.sendReply())}),e.j41(15,"input",29),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.replyMessages[a.selectedChat.messages[0].id]=r)})("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.replyMessages[a.selectedChat.messages[0].id]=r)}),e.k0s(),e.j41(16,"button",30),e.EFF(17," Reply "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(1),e.xc7("top",t.navbarHeight,"px"),e.Y8G("ngClass",e.eq3(13,F,t.selectedChat)),e.R7$(6),e.SpI(" ",t.selectedChat.senderFullName," "),e.R7$(2),e.SpI(" ",t.selectedChat.senderPhoneNumber," "),e.R7$(1),e.xc7("margin-top",t.navbarHeight+80,"px"),e.R7$(2),e.Y8G("ngForOf",t.selectedChat.messages)("ngForTrackBy",t.trackByMessageId),e.R7$(1),e.Y8G("ngClass",e.eq3(15,F,t.selectedChat)),e.R7$(2),e.Y8G("ngModel",t.replyMessages[t.selectedChat.messages[0].id])("ngModelOptions",e.lJ4(17,ce)),e.R7$(1),e.Y8G("disabled",!t.replyMessages[t.selectedChat.messages[0].id])}}function ue(n,i){1&n&&(e.j41(0,"div",35),e.EFF(1," Select a chat to view messages \u{1f4e9} "),e.k0s())}const me=function(n){return{hidden:n}},he=function(n,i){return{block:n,"hidden sm:flex":i}};let pe=(()=>{class n{constructor(t,s,r,a){this.messageService=t,this.toastr=s,this.cdr=r,this.adminDashboardService=a,this.playerChats=[],this.selectedPlayerId=null,this.selectedChat=null,this.replyMessages={},this.navbarHeight=60}ngOnInit(){this.loadAdminMessages()}ngOnDestroy(){this.updateStatusSubscription&&this.updateStatusSubscription.unsubscribe(),this.refreshSubscription&&this.refreshSubscription.unsubscribe()}loadAdminMessages(){this.loadFromServer()}loadFromCache(){this.loadFromServer()}loadFromServer(){this.adminDashboardService.getSecondaryData("messages").subscribe({next:t=>{if(t&&t.length>0){const s=this.groupMessagesBySender(t);this.playerChats=s.sort((r,a)=>new Date(a.lastMessageDate).getTime()-new Date(r.lastMessageDate).getTime())}else this.toastr.error("\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644")},error:t=>{this.toastr.error(t.message)}})}refreshMessages(){this.messageService.getAdminMessages().subscribe({next:t=>{if(t&&t.messages){const s=this.groupMessagesBySender(t.messages);this.playerChats=s.sort((r,a)=>new Date(a.lastMessageDate).getTime()-new Date(r.lastMessageDate).getTime())}else this.toastr.error("\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644")},error:t=>{this.toastr.error(t.message)}})}ngAfterViewChecked(){this.selectedChat&&this.messagesContainer&&this.scrollToBottom()}loadMessages(){this.messageService.getMessages().subscribe({next:t=>{t&&t.messages?this.processMessages(t.messages):this.toastr.error("\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644 \u0627\u0644\u0622\u0646")},error:t=>{this.toastr.error("\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062c\u0644\u0628 \u0627\u0644\u0631\u0633\u0627\u0626\u0644")}})}processMessages(t){const s=this.groupMessagesBySender(t);this.playerChats=s.sort((r,a)=>new Date(a.lastMessageDate).getTime()-new Date(r.lastMessageDate).getTime()),this.cdr.detectChanges()}groupMessagesBySender(t){const s={};return t.filter(r=>!r.isDeleted).forEach(r=>{const a=r.senderId;s[a]||(s[a]={senderId:a,senderFullName:r.senderFullName,senderPhoneNumber:r.senderPhoneNumber,lastMessage:"",lastMessageDate:"",unreadCount:0,messages:[]}),s[a].messages.push(r),!r.isFromAdmin&&!r.isRead&&s[a].unreadCount++}),Object.values(s).map(r=>{r.messages=r.messages.sort((o,c)=>new Date(o.sentAt).getTime()-new Date(c.sentAt).getTime());const a=r.messages[r.messages.length-1];return r.lastMessage=a?.content??"",r.lastMessageDate=a?.sentAt??"",r})}openChat(t){this.selectedPlayerId=t,this.selectedChat=this.playerChats.find(s=>s.senderId===t)||null,this.selectedChat&&(this.selectedChat.messages.filter(s=>!s.isRead&&!s.isFromAdmin).forEach(s=>{this.messageService.toggleMarkMessage(s.id,!0).subscribe({next:r=>{r.success&&(s.isRead=!0,this.selectedChat.unreadCount=this.selectedChat.messages.filter(a=>!a.isRead&&!a.isFromAdmin).length,this.cdr.detectChanges())},error:r=>{this.toastr.error("\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u062f\u064a\u062b \u062d\u0627\u0644\u0629 \u0627\u0644\u0631\u0633\u0627\u0644\u0629")}})}),this.cdr.detectChanges())}closeChat(){this.selectedPlayerId=null,this.selectedChat=null,this.replyMessages={},this.cdr.detectChanges()}sendReply(){if(!this.selectedChat)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0645\u062d\u0627\u062f\u062b\u0629");const t=this.replyMessages[this.selectedChat.messages[0].id]?.trim();t?this.messageService.sendAdminReply(this.selectedChat.senderId,t).subscribe({next:s=>{if(s.success){this.toastr.success("\u062a\u0645 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f"),this.replyMessages[this.selectedChat.messages[0].id]="";const r={id:Math.random(),senderId:this.selectedChat.senderId,senderFullName:"Admin",senderPhoneNumber:"",content:t,isRead:!0,isDeleted:!1,sentAt:(new Date).toISOString(),isFromAdmin:!0};this.selectedChat.messages.push(r),this.selectedChat.messages.sort((a,o)=>new Date(a.sentAt).getTime()-new Date(o.sentAt).getTime()),this.selectedChat.lastMessage=t,this.selectedChat.lastMessageDate=r.sentAt,this.playerChats.sort((a,o)=>new Date(o.lastMessageDate).getTime()-new Date(a.lastMessageDate).getTime()),this.selectedChat=this.playerChats.find(a=>a.senderId===this.selectedPlayerId)||null,this.cdr.detectChanges()}else this.toastr.error(s.message||"\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f")},error:s=>{this.toastr.error("\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f")}}):this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0643\u062a\u0627\u0628\u0629 \u0631\u062f")}scrollToBottom(){if(this.messagesContainer){const t=this.messagesContainer.nativeElement;t.scrollTop=t.scrollHeight}}trackByPlayerId(t,s){return s.senderId}trackByMessageId(t,s){return s.id}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(ee.b),e.rXU(f.tw),e.rXU(e.gRc),e.rXU(v.p))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-inbox"]],viewQuery:function(s,r){if(1&s&&e.GBs(te,5),2&s){let a;e.mGM(a=e.lsd())&&(r.messagesContainer=a.first)}},decls:11,vars:11,consts:[[1,"container","mx-auto","p-4","flex","flex-col","sm:flex-row","overflow-hidden","h-screen"],[1,"w-full","sm:w-1/3","border-r","border-gray-600","sm:block",3,"ngClass"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-white"],["class","text-center text-gray-300",4,"ngIf"],["class","space-y-2 overflow-y-auto max-h-[calc(100vh-120px)]",4,"ngIf"],[1,"w-full","sm:w-2/3","flex","flex-col","h-full","relative",3,"ngClass"],["class","flex flex-col h-full",4,"ngIf","ngIfElse"],["noChatSelected",""],[1,"text-center","text-gray-300"],[1,"space-y-2","overflow-y-auto","max-h-[calc(100vh-120px)]"],["class","p-4 backdrop-blur-sm border border-gray-600 rounded-lg hover:bg-gray-700 cursor-pointer flex items-center justify-between",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-4","backdrop-blur-sm","border","border-gray-600","rounded-lg","hover:bg-gray-700","cursor-pointer","flex","items-center","justify-between",3,"click"],[1,"font-bold","text-white"],[1,"text-sm","text-gray-300","truncate"],["class","bg-green-600 text-white text-xs font-bold rounded-full px-2 py-1",4,"ngIf"],[1,"bg-green-600","text-white","text-xs","font-bold","rounded-full","px-2","py-1"],[1,"flex","flex-col","h-full"],[1,"fixed","left-0","right-0","z-40","p-2","backdrop-blur-sm","border-b","border-gray-600","flex","items-center","justify-between","bg-black","bg-opacity-90",3,"ngClass"],[1,"flex","items-center"],[1,"mr-4","text-gray-300","hover:text-white","transition",3,"click"],[1,"fa-solid","fa-arrow-left",2,"color","#ffffff"],[1,"font-bold","text-white","text-sm","p-0"],[1,"text-xs","text-gray-400","p-0"],[1,"flex-1","p-4","overflow-y-auto","backdrop-blur-sm",2,"margin-bottom","80px"],["messagesContainer",""],["class","mb-4",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"fixed","bottom-0","left-0","right-0","z-50","p-4","bg-black","bg-opacity-90","backdrop-blur-sm","border-t","border-gray-600",3,"ngClass"],[1,"flex","items-center","gap-2",3,"ngSubmit"],["type","text","placeholder","Write your reply...",1,"flex-1","p-2","border","border-gray-600","rounded-lg","bg-gray-800","text-white","focus:outline-none","focus:ring-2","focus:ring-blue-600","placeholder-gray-400",3,"ngModel","ngModelOptions","ngModelChange"],["type","submit",1,"bg-blue-600","text-white","p-2","rounded-lg","hover:bg-blue-700","transition","disabled:bg-gray-600",3,"disabled"],[1,"mb-4",3,"ngClass"],[1,"inline-block","p-3","rounded-lg","max-w-xs",3,"ngClass"],[1,"text-white"],[1,"text-xs","mt-1","text-gray-300"],[1,"w-full","flex","items-center","justify-center","text-gray-300"]],template:function(s,r){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"\u{1f4e5} Inbox"),e.k0s()(),e.DNE(5,re,2,0,"div",4),e.DNE(6,ae,2,2,"div",5),e.k0s(),e.j41(7,"div",6),e.DNE(8,de,18,18,"div",7),e.DNE(9,ue,2,0,"ng-template",null,8,e.C5r),e.k0s()()),2&s){const a=e.sdS(10);e.R7$(1),e.Y8G("ngClass",e.eq3(6,me,r.selectedChat)),e.R7$(4),e.Y8G("ngIf",0===r.playerChats.length),e.R7$(1),e.Y8G("ngIf",r.playerChats.length>0),e.R7$(1),e.Y8G("ngClass",e.l_i(8,he,r.selectedChat,!r.selectedChat)),e.R7$(1),e.Y8G("ngIf",r.selectedChat)("ngIfElse",a)}},dependencies:[m.YU,m.Sq,m.bT,l.qT,l.me,l.BC,l.cb,l.vS,l.cV,m.vh]})}}return n})();var p=u(8416),ge=u(7325),_e=u(7791),C=u(8705);function fe(n,i){if(1&n){const t=e.RV6();e.j41(0,"li",9),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectPlayer(a))}),e.j41(1,"span",10),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.openRecordMatchModal())}),e.EFF(2),e.k0s(),e.j41(3,"button",11),e.bIt("click",function(r){const o=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.confirmDelete(o,r))}),e.EFF(4," X "),e.k0s()()}if(2&n){const t=i.$implicit,s=e.XpG(2);e.AVh("bg-blue-600",(null==s.selectedPlayer?null:s.selectedPlayer.playerId)===t.playerId),e.R7$(2),e.JRh(t.fullName)}}function ye(n,i){if(1&n&&(e.j41(0,"ul"),e.DNE(1,fe,5,3,"li",8),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.players)}}function be(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openModal())}),e.EFF(1," Add Player "),e.k0s()}}function ve(n,i){if(1&n&&(e.j41(0,"div",45)(1,"h2",46),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Friendly Matches for ",t.selectedPlayer.fullName," ")}}function xe(n,i){if(1&n&&(e.j41(0,"div",47)(1,"h4",48),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" ",t.totalUnreadFriendlyMessages," ")}}function Fe(n,i){if(1&n&&(e.j41(0,"option",33),e.EFF(1),e.k0s()),2&n){const t=i.$implicit;e.Y8G("ngValue",t.playerId),e.R7$(1),e.SpI(" ",t.fullName," ")}}function Ce(n,i){if(1&n){const t=e.RV6();e.j41(0,"tr",49)(1,"td",41),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"td",41),e.EFF(5),e.k0s(),e.j41(6,"td",50)(7,"span",51),e.EFF(8),e.k0s()(),e.j41(9,"td",41),e.EFF(10),e.k0s(),e.j41(11,"td",50)(12,"div",52)(13,"button",53),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.editMatch(a))}),e.EFF(14," Edit "),e.k0s(),e.j41(15,"button",54),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.deleteMatchFromList(a.matchId))}),e.EFF(16," Delete "),e.k0s()()()()}if(2&n){const t=i.$implicit,s=e.XpG(2);e.R7$(2),e.SpI(" ",e.i5U(3,5,t.playedOn,"shortDate")," "),e.R7$(3),e.SpI(" ",t.player1Name||s.getPlayerName(t.player1Id)," "),e.R7$(3),e.Lme(" ",t.player1Score," - ",t.player2Score," "),e.R7$(2),e.SpI(" ",t.player2Name||s.getPlayerName(t.player2Id)," ")}}function ke(n,i){if(1&n){const t=e.RV6();e.j41(0,"span",59)(1,"button",60),e.bIt("click",function(){const a=e.eBV(t).index,o=e.XpG(3);return e.Njj(o.changePage(a+1))}),e.EFF(2),e.k0s()()}if(2&n){const t=i.index,s=e.XpG(3);e.R7$(1),e.AVh("bg-blue-600",s.currentPage===t+1)("bg-gray-600",s.currentPage!==t+1)("hover:bg-blue-700",s.currentPage===t+1)("hover:bg-gray-700",s.currentPage!==t+1),e.R7$(1),e.SpI(" ",t+1," ")}}const Te=function(){return[]};function Me(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",55)(1,"div",56)(2,"button",57),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changePage(r.currentPage-1))}),e.EFF(3," Previous "),e.k0s(),e.DNE(4,ke,3,9,"span",58),e.j41(5,"button",57),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changePage(r.currentPage+1))}),e.EFF(6," Next "),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("disabled",1===t.currentPage),e.R7$(2),e.Y8G("ngForOf",e.lJ4(3,Te).constructor(t.totalPages)),e.R7$(1),e.Y8G("disabled",t.currentPage===t.totalPages)}}function je(n,i){if(1&n){const t=e.RV6();e.j41(0,"div"),e.DNE(1,ve,3,1,"div",13),e.nrm(2,"hr",14),e.j41(3,"div")(4,"div",15)(5,"button",16),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.toggleSidebar())}),e.EFF(6," \u2630 Players "),e.k0s(),e.j41(7,"button",17),e.EFF(8," \u{1f4ec} Friendly Inbox "),e.DNE(9,xe,3,1,"div",18),e.k0s()(),e.j41(10,"div",19)(11,"h2",20),e.EFF(12," Quick Actions "),e.k0s(),e.j41(13,"div",21)(14,"button",22),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openRecordMatchModal())}),e.j41(15,"h3",23),e.EFF(16,"Record Match"),e.k0s(),e.j41(17,"p",24),e.EFF(18,"Record a new friendly match"),e.k0s()(),e.j41(19,"button",25),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openModal())}),e.j41(20,"h3",23),e.EFF(21,"Add New Player"),e.k0s(),e.j41(22,"p",24),e.EFF(23,"Register a new friendly player"),e.k0s()()()()(),e.j41(24,"div",26)(25,"div",27)(26,"div",28)(27,"h4",29),e.EFF(28,"Filter Matches"),e.k0s()(),e.j41(29,"div",30)(30,"div")(31,"label",31),e.EFF(32,"Date Range"),e.k0s(),e.j41(33,"select",32),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.filterForm.dateFilter=r)})("ngModelChange",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onFilterChange())}),e.j41(34,"option",33),e.EFF(35,"All Time"),e.k0s(),e.j41(36,"option",33),e.EFF(37,"Today"),e.k0s(),e.j41(38,"option",33),e.EFF(39,"Last 3 Days"),e.k0s(),e.j41(40,"option",33),e.EFF(41,"Last Week"),e.k0s(),e.j41(42,"option",33),e.EFF(43,"Last Month"),e.k0s()()(),e.j41(44,"div")(45,"label",31),e.EFF(46,"Player"),e.k0s(),e.j41(47,"select",32),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.filterForm.playerId=r)})("ngModelChange",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onFilterChange())}),e.j41(48,"option",33),e.EFF(49,"All Players"),e.k0s(),e.DNE(50,Fe,2,2,"option",34),e.k0s()()(),e.j41(51,"div",35)(52,"button",36),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.clearFilters())}),e.EFF(53," Clear Filters "),e.k0s()()(),e.j41(54,"div",37)(55,"table",38)(56,"thead",39)(57,"tr",40)(58,"th",41),e.EFF(59,"Date"),e.k0s(),e.j41(60,"th",41),e.EFF(61,"Player 1"),e.k0s(),e.j41(62,"th",41),e.EFF(63,"Score"),e.k0s(),e.j41(64,"th",41),e.EFF(65,"Player 2"),e.k0s(),e.j41(66,"th",41),e.EFF(67,"Actions"),e.k0s()()(),e.j41(68,"tbody"),e.DNE(69,Ce,17,8,"tr",42),e.k0s()()(),e.DNE(70,Me,7,4,"div",43),e.j41(71,"div",44),e.EFF(72),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.selectedPlayer),e.R7$(8),e.Y8G("ngIf",t.totalUnreadFriendlyMessages>0),e.R7$(5),e.Y8G("disabled",0===t.players.length),e.R7$(19),e.Y8G("ngModel",t.filterForm.dateFilter),e.R7$(1),e.Y8G("ngValue",t.DateFilter.AllTime),e.R7$(2),e.Y8G("ngValue",t.DateFilter.Today),e.R7$(2),e.Y8G("ngValue",t.DateFilter.Last3Days),e.R7$(2),e.Y8G("ngValue",t.DateFilter.LastWeek),e.R7$(2),e.Y8G("ngValue",t.DateFilter.LastMonth),e.R7$(5),e.Y8G("ngModel",t.filterForm.playerId),e.R7$(1),e.Y8G("ngValue",0),e.R7$(2),e.Y8G("ngForOf",t.getAllActivePlayers()),e.R7$(19),e.Y8G("ngForOf",t.getPaginatedMatches()),e.R7$(1),e.Y8G("ngIf",t.totalPages>1),e.R7$(2),e.E5c(" Showing ",(t.currentPage-1)*t.itemsPerPage+1," - ",t.Math.min(t.currentPage*t.itemsPerPage,t.allMatches.length)," of ",t.allMatches.length," matches ")}}function Pe(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",61)(1,"div",62)(2,"h2",63),e.EFF(3,"Confirm Delete"),e.k0s(),e.j41(4,"p",64),e.EFF(5," Are you sure you want to delete "),e.j41(6,"strong"),e.EFF(7),e.k0s(),e.EFF(8,"? "),e.k0s(),e.j41(9,"div",65)(10,"button",66),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showDeleteModal=!1)}),e.EFF(11," Cancel "),e.k0s(),e.j41(12,"button",67),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.deleteConfirmedPlayer())}),e.EFF(13," Delete "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(7),e.JRh(null==t.selectedPlayerToDelete?null:t.selectedPlayerToDelete.fullName)}}function Ie(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",61)(1,"div",62)(2,"h2",63),e.EFF(3," Add New Friendly Player "),e.k0s(),e.j41(4,"input",68),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.friendlyPlayerName=r)}),e.k0s(),e.j41(5,"div",65)(6,"button",69),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeModal())}),e.EFF(7," Cancel "),e.k0s(),e.j41(8,"button",70),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.addPlayer())}),e.EFF(9," Add "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngModel",t.friendlyPlayerName)}}function we(n,i){if(1&n&&(e.j41(0,"option",86),e.EFF(1),e.k0s()),2&n){const t=i.$implicit,s=e.XpG(4);e.Y8G("value",t.playerId)("selected",s.matchForm.player1Id===t.playerId),e.R7$(1),e.SpI(" ",t.fullName," ")}}function Ne(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",82)(1,"select",83),e.bIt("change",function(r){e.eBV(t);const a=e.XpG(3);return e.Njj(a.selectPlayer1FromSelect(r))})("blur",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.showPlayer1Select=!1)}),e.j41(2,"option",84),e.EFF(3," -- \u0627\u062e\u062a\u0631 \u0627\u0644\u0644\u0627\u0639\u0628 \u0627\u0644\u0623\u0648\u0644 -- "),e.k0s(),e.DNE(4,we,2,3,"option",85),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("ngForOf",t.getAllActivePlayers())}}function Se(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",89),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.selectPlayer1(a))}),e.EFF(1),e.k0s()}if(2&n){const t=i.$implicit;e.R7$(1),e.SpI(" ",t.fullName," ")}}function Re(n,i){if(1&n&&(e.j41(0,"div",87),e.DNE(1,Se,2,1,"div",88),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",t.filteredPlayer1Suggestions)}}function De(n,i){1&n&&(e.j41(0,"div",90),e.EFF(1," Player not found. Please select from the list. "),e.k0s())}function Ee(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",28)(1,"label",31),e.EFF(2,"Player 1"),e.k0s(),e.j41(3,"div",77)(4,"input",78),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG(2);return e.Njj(a.matchForm.player1Name=r)})("input",function(r){e.eBV(t);const a=e.XpG(2);return e.Njj(a.searchPlayer1(r))})("focus",function(){e.eBV(t);const r=e.XpG(2);return r.showPlayer1Suggestions=!0,e.Njj(r.showPlayer1Select=!0)})("blur",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.hidePlayer1Suggestions())}),e.k0s(),e.DNE(5,Ne,5,1,"div",79),e.DNE(6,Re,2,1,"div",80),e.k0s(),e.DNE(7,De,2,0,"div",81),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Y8G("ngModel",t.matchForm.player1Name)("placeholder","Type to search for Player 1..."),e.R7$(1),e.Y8G("ngIf",t.showPlayer1Select),e.R7$(1),e.Y8G("ngIf",t.showPlayer1Suggestions&&t.filteredPlayer1Suggestions.length>0),e.R7$(1),e.Y8G("ngIf",t.matchForm.player1Name&&!t.getPlayerByName(t.matchForm.player1Name))}}function Ge(n,i){if(1&n&&(e.j41(0,"option",86),e.EFF(1),e.k0s()),2&n){const t=i.$implicit,s=e.XpG(4);e.Y8G("value",t.playerId)("selected",s.matchForm.player2Id===t.playerId),e.R7$(1),e.SpI(" ",t.fullName," ")}}function $e(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",82)(1,"select",91),e.bIt("change",function(r){e.eBV(t);const a=e.XpG(3);return e.Njj(a.selectPlayer2FromSelect(r))})("blur",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.showPlayer2Select=!1)}),e.j41(2,"option",84),e.EFF(3," -- \u0627\u062e\u062a\u0631 \u0627\u0644\u0644\u0627\u0639\u0628 \u0627\u0644\u062b\u0627\u0646\u064a -- "),e.k0s(),e.DNE(4,Ge,2,3,"option",85),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("ngForOf",t.getOpponentsForPlayerByName(t.matchForm.player1Name))}}function Ve(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",89),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.selectPlayer2(a))}),e.EFF(1),e.k0s()}if(2&n){const t=i.$implicit;e.R7$(1),e.SpI(" ",t.fullName," ")}}function Xe(n,i){if(1&n&&(e.j41(0,"div",87),e.DNE(1,Ve,2,1,"div",88),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",t.filteredPlayer2Suggestions)}}function Be(n,i){1&n&&(e.j41(0,"div",90),e.EFF(1," Player not found. Please select from the list. "),e.k0s())}function Ae(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",28)(1,"label",31),e.EFF(2,"Player 2"),e.k0s(),e.j41(3,"div",77)(4,"input",78),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG(2);return e.Njj(a.matchForm.player2Name=r)})("input",function(r){e.eBV(t);const a=e.XpG(2);return e.Njj(a.searchPlayer2(r))})("focus",function(){e.eBV(t);const r=e.XpG(2);return r.showPlayer2Suggestions=!0,e.Njj(r.showPlayer2Select=!0)})("blur",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.hidePlayer2Suggestions())}),e.k0s(),e.DNE(5,$e,5,1,"div",79),e.DNE(6,Xe,2,1,"div",80),e.k0s(),e.DNE(7,Be,2,0,"div",81),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Y8G("ngModel",t.matchForm.player2Name)("placeholder","Type to search for Player 2..."),e.R7$(1),e.Y8G("ngIf",t.showPlayer2Select),e.R7$(1),e.Y8G("ngIf",t.showPlayer2Suggestions&&t.filteredPlayer2Suggestions.length>0),e.R7$(1),e.Y8G("ngIf",t.matchForm.player2Name&&!t.getPlayerByName(t.matchForm.player2Name))}}function Ye(n,i){if(1&n&&(e.j41(0,"div",28)(1,"label",31),e.EFF(2,"Player 1"),e.k0s(),e.j41(3,"div",92),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI(" ",t.selectedPlayerForMatch.player1Name||t.getPlayerName(t.matchForm.player1Id)," ")}}function Le(n,i){if(1&n&&(e.j41(0,"div",28)(1,"label",31),e.EFF(2,"Player 2"),e.k0s(),e.j41(3,"div",92),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI(" ",t.selectedPlayerForMatch.player2Name||t.getPlayerName(t.matchForm.player2Id)," ")}}function Oe(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",61)(1,"div",71)(2,"h2",63),e.EFF(3),e.k0s(),e.DNE(4,Ee,8,5,"div",72),e.DNE(5,Ae,8,5,"div",72),e.DNE(6,Ye,5,1,"div",72),e.DNE(7,Le,5,1,"div",72),e.j41(8,"div",73)(9,"div")(10,"label",31),e.EFF(11,"Player 1 Score"),e.k0s(),e.j41(12,"input",74),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.matchForm.player1Score=r)})("input",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.validateScore("player1"))}),e.k0s()(),e.j41(13,"div")(14,"label",31),e.EFF(15,"Player 2 Score"),e.k0s(),e.j41(16,"input",74),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.matchForm.player2Score=r)})("input",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.validateScore("player2"))}),e.k0s()()(),e.j41(17,"div",75)(18,"button",36),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeRecordMatchModal())}),e.EFF(19," Cancel "),e.k0s(),e.j41(20,"button",76),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.selectedPlayerForMatch?r.updateMatch():r.recordNewMatch())}),e.EFF(21),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",t.selectedPlayerForMatch?"Edit Match":"Record New Match"," "),e.R7$(1),e.Y8G("ngIf",!t.selectedPlayerForMatch),e.R7$(1),e.Y8G("ngIf",!t.selectedPlayerForMatch),e.R7$(1),e.Y8G("ngIf",t.selectedPlayerForMatch),e.R7$(1),e.Y8G("ngIf",t.selectedPlayerForMatch),e.R7$(5),e.Y8G("ngModel",t.matchForm.player1Score),e.R7$(4),e.Y8G("ngModel",t.matchForm.player2Score),e.R7$(4),e.Y8G("disabled",!t.matchForm.player1Name||!t.matchForm.player2Name||!t.selectedPlayerForMatch&&t.matchForm.player1Name===t.matchForm.player2Name||0===t.matchForm.player1Score&&0===t.matchForm.player2Score||t.isRecordingMatch||!t.getPlayerByName(t.matchForm.player1Name)||!t.getPlayerByName(t.matchForm.player2Name)),e.R7$(1),e.SpI(" ",t.isRecordingMatch?"Processing...":t.selectedPlayerForMatch?"Update Match":"Record Match"," ")}}const Ue=function(n,i){return{"w-64 p-4 sm:min-h-screen":n,"w-0 p-0":i}};let ze=(()=>{class n{constructor(t,s,r){this.friendlyMatchService=t,this.friendlyMessageService=s,this.toastr=r,this.activeTab="friendlies",this.isSidebarOpen=!1,this.players=[],this.selectedPlayer=null,this.displayMatches=[],this.showModal=!1,this.showDeleteModal=!1,this.showRecordMatchModal=!1,this.selectedPlayerToDelete=null,this.selectedPlayerForMatch=null,this.friendlyPlayerName="",this.matchForm={player1Id:0,player2Id:0,player1Name:"",player2Name:"",player1Score:null,player2Score:null,playedOn:new Date},this.isRecordingMatch=!1,this.showPlayer1Suggestions=!1,this.showPlayer2Suggestions=!1,this.showPlayer1Select=!1,this.showPlayer2Select=!1,this.filteredPlayer1Suggestions=[],this.filteredPlayer2Suggestions=[],this.totalPlayers=0,this.totalMatches=0,this.totalUnreadFriendlyMessages=0,this.allMatches=[],this.currentPage=1,this.itemsPerPage=10,this.totalPages=0,this.Math=Math,this.filterForm={playerId:0,opponentIds:[],dateFilter:p.Zv.AllTime},this.DateFilter=p.Zv}ngOnInit(){this.loadPlayers(),this.loadAllMatches(),this.loadUnreadFriendlyMessagesCount()}loadUnreadFriendlyMessagesCount(){this.friendlyMessageService.getAllMessages().subscribe({next:t=>{this.totalUnreadFriendlyMessages=t.success&&t.messages?(0,ge.lH)(t.messages):0},error:t=>{console.error("Error loading unread friendly messages count:",t),this.totalUnreadFriendlyMessages=0}})}toggleSidebar(){this.isSidebarOpen=!this.isSidebarOpen}loadPlayers(){this.friendlyMatchService.getAllFriendlyPlayers().subscribe({next:t=>{this.players=t,this.totalPlayers=t.length,this.calculateStatistics()},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}selectPlayer(t){this.selectedPlayer=t,this.loadPlayerMatches(t.playerId)}loadPlayerMatches(t){this.friendlyMatchService.getAllFriendlyMatches().subscribe({next:s=>{const a=this.players.find(o=>o.playerId===t)?.fullName;this.displayMatches=s.filter(o=>o.player1Name===a||o.player2Name===a)},error:s=>{this.toastr.error(s.error?.message||s.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0645\u0628\u0627\u0631\u064a\u0627\u062a \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}calculateStatistics(){this.friendlyMatchService.getAllFriendlyMatches().subscribe({next:t=>{this.totalMatches=t.length},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0625\u062d\u0635\u0627\u0626\u064a\u0627\u062a","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}openModal(){this.showModal=!0,this.friendlyPlayerName=""}closeModal(){this.showModal=!1,this.friendlyPlayerName=""}addPlayer(){this.friendlyPlayerName.trim()?this.friendlyMatchService.addFriendlyPlayerAsync(this.friendlyPlayerName).subscribe({next:t=>{t.success?(this.toastr.success(`\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628 ${this.friendlyPlayerName} \u0628\u0646\u062c\u0627\u062d`,"\u062a\u0645 \u0627\u0644\u0625\u0636\u0627\u0641\u0629"),this.friendlyMatchService.refreshFriendlyPlayers(),this.loadPlayers(),this.closeModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u0636\u0627\u0641\u0629")},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u0636\u0627\u0641\u0629")}}):this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0644\u0627\u0639\u0628","\u062a\u062d\u0630\u064a\u0631")}confirmDelete(t,s){s.stopPropagation(),this.selectedPlayerToDelete=t,this.showDeleteModal=!0}deleteConfirmedPlayer(){this.selectedPlayerToDelete&&(this.friendlyMatchService.deleteFriendlyPlayerAsync(this.selectedPlayerToDelete.playerId).subscribe({next:t=>{t.success?(this.toastr.success(`\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0644\u0627\u0639\u0628 ${this.selectedPlayerToDelete.fullName} \u0628\u0646\u062c\u0627\u062d`,"\u062a\u0645 \u0627\u0644\u062d\u0630\u0641"),this.friendlyMatchService.refreshFriendlyPlayers(),this.loadPlayers(),this.selectedPlayer?.playerId===this.selectedPlayerToDelete.playerId&&(this.selectedPlayer=null,this.displayMatches=[])):this.toastr.error(t.message||"\u0641\u0634\u0644 \u062d\u0630\u0641 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641")},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641")}}),this.showDeleteModal=!1,this.selectedPlayerToDelete=null)}getActivePlayersCount(){return this.players.filter(t=>t.isActive).length}getRecentMatches(){return this.displayMatches.slice(0,10)}openRecordMatchModal(t){this.selectedPlayerForMatch=t||null,t?(this.matchForm.player1Id=t.playerId,this.matchForm.player1Name=t.fullName):(this.matchForm.player1Id=0,this.matchForm.player1Name=""),this.matchForm.player2Id=0,this.matchForm.player2Name="",this.matchForm.player1Score=null,this.matchForm.player2Score=null,this.matchForm.playedOn=new Date,this.showRecordMatchModal=!0}closeRecordMatchModal(){this.showRecordMatchModal=!1,this.selectedPlayerForMatch=null,this.matchForm={player1Id:0,player2Id:0,player1Name:"",player2Name:"",player1Score:0,player2Score:0,playedOn:new Date}}recordNewMatch(){if(!this.matchForm.player1Name||!this.matchForm.player2Name)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0643\u0644\u0627 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631");const t=this.getPlayerByName(this.matchForm.player1Name),s=this.getPlayerByName(this.matchForm.player2Name);if(!t||!s)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0635\u062d\u0629 \u0623\u0633\u0645\u0627\u0621 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631");if(!this.selectedPlayerForMatch&&t.playerId===s.playerId)return void this.toastr.warning("\u0644\u0627 \u064a\u0645\u0643\u0646 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0644\u0627\u0639\u0628 \u0627\u0644\u0623\u0648\u0644 \u0648\u0627\u0644\u062b\u0627\u0646\u064a \u0646\u0641\u0633 \u0627\u0644\u0634\u062e\u0635","\u062a\u062d\u0630\u064a\u0631");if(null===this.matchForm.player1Score||null===this.matchForm.player2Score)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0627\u0644\u0646\u0642\u0627\u0637 \u0644\u0643\u0644\u0627 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631");if(this.matchForm.player1Score<0||this.matchForm.player2Score<0)return void this.toastr.warning("\u0644\u0627 \u064a\u0645\u0643\u0646 \u0623\u0646 \u062a\u0643\u0648\u0646 \u0627\u0644\u0646\u0642\u0627\u0637 \u0633\u0627\u0644\u0628\u0629","\u062a\u062d\u0630\u064a\u0631");if(0===this.matchForm.player1Score&&0===this.matchForm.player2Score)return void this.toastr.warning("\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0644\u062f\u0649 \u0644\u0627\u0639\u0628 \u0648\u0627\u062d\u062f \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0646\u0642\u0627\u0637 \u0625\u064a\u062c\u0627\u0628\u064a\u0629 (0-0 \u063a\u064a\u0631 \u0645\u0633\u0645\u0648\u062d)","\u062a\u062d\u0630\u064a\u0631");const r={player1Id:t.playerId,player2Id:s.playerId,player1Score:this.matchForm.player1Score,player2Score:this.matchForm.player2Score,playedOn:this.matchForm.playedOn};this.isRecordingMatch=!0,this.friendlyMatchService.recordFriendlyMatchAsync(r).subscribe({next:a=>{a.success?(this.toastr.success(`\u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0628\u0646\u062c\u0627\u062d: ${t.fullName} (${this.matchForm.player1Score}) - ${s.fullName} (${this.matchForm.player2Score})`,"\u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629"),this.friendlyMatchService.refreshFriendlyMatches(),this.friendlyMatchService.refreshFriendlyPlayers(),this.loadPlayers(),this.calculateStatistics(),this.selectedPlayer&&this.loadPlayerMatches(this.selectedPlayer.playerId),this.loadAllMatches(),this.closeRecordMatchModal()):this.toastr.error(a.message||"\u0641\u0634\u0644 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u0633\u062c\u064a\u0644"),this.isRecordingMatch=!1},error:a=>{this.toastr.error(a.error?.message||a.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u0633\u062c\u064a\u0644"),this.isRecordingMatch=!1}})}getOpponentsForPlayer(t){return this.players.filter(s=>s.playerId!==t&&!1!==s.isActive)}getOpponentsForPlayerByName(t){const s=this.getPlayerByName(t);return s?this.players.filter(r=>r.playerId!==s.playerId&&!1!==r.isActive):this.getAllActivePlayers()}getAllActivePlayers(){return this.players.filter(t=>!1!==t.isActive)}validateScore(t){"player1"===t?null!==this.matchForm.player1Score&&this.matchForm.player1Score<0&&(this.matchForm.player1Score=0):null!==this.matchForm.player2Score&&this.matchForm.player2Score<0&&(this.matchForm.player2Score=0)}loadAllMatches(){this.friendlyMatchService.getAllFriendlyMatches().subscribe({next:t=>{this.allMatches=t.sort((s,r)=>new Date(r.playedOn).getTime()-new Date(s.playedOn).getTime()),this.totalMatches=t.length,this.totalPages=Math.ceil(this.allMatches.length/this.itemsPerPage)},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u064a\u0627\u062a","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}loadFilteredMatchesFromCache(){this.friendlyMatchService.getAllFriendlyMatches().subscribe({next:t=>{let s=[...t];if(this.filterForm.dateFilter!==p.Zv.AllTime){const r=new Date;let a;switch(this.filterForm.dateFilter){case p.Zv.Today:a=new Date(r.getFullYear(),r.getMonth(),r.getDate());break;case p.Zv.Last3Days:a=new Date(r.getTime()-2592e5);break;case p.Zv.LastWeek:a=new Date(r.getTime()-6048e5);break;case p.Zv.LastMonth:a=new Date(r.getTime()-2592e6);break;default:a=new Date(0)}s=s.filter(o=>new Date(o.playedOn)>=a)}if(this.filterForm.playerId){const a=this.players.find(o=>o.playerId===this.filterForm.playerId)?.fullName;s=s.filter(o=>o.player1Name===a||o.player2Name===a),s=this.reorderMatchesForSelectedPlayer(s,a)}if(this.filterForm.opponentIds&&this.filterForm.opponentIds.length>0){const r=this.filterForm.opponentIds.map(a=>this.players.find(c=>c.playerId===a)?.fullName).filter(a=>a);s=s.filter(a=>r.includes(a.player1Name)||r.includes(a.player2Name))}s.sort((r,a)=>new Date(a.playedOn).getTime()-new Date(r.playedOn).getTime()),this.allMatches=s,this.totalMatches=s.length,this.totalPages=Math.ceil(this.allMatches.length/this.itemsPerPage)},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u064a\u0627\u062a \u0627\u0644\u0645\u0641\u0644\u062a\u0631\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}reorderMatchesForSelectedPlayer(t,s){return t.map(r=>r.player1Name===s?r:r.player2Name===s?{...r,player1Name:r.player2Name,player2Name:r.player1Name,player1Score:r.player2Score,player2Score:r.player1Score,player1Id:r.player2Id,player2Id:r.player1Id}:r)}loadFilteredMatches(){const t={page:this.currentPage,pageSize:this.itemsPerPage,dateFilter:this.filterForm.dateFilter};this.filterForm.playerId&&(t.playerId=this.filterForm.playerId),this.filterForm.opponentIds&&this.filterForm.opponentIds.length>0&&(t.opponentIds=this.filterForm.opponentIds),this.friendlyMatchService.getFilteredMatches(t).subscribe({next:s=>{this.allMatches=s.matches,this.totalMatches=s.totalCount,this.totalPages=s.totalPages},error:s=>{this.toastr.error(s.error?.message||s.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u064a\u0627\u062a \u0627\u0644\u0645\u0641\u0644\u062a\u0631\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644")}})}onFilterChange(){this.currentPage=1,this.loadFilteredMatchesFromCache()}clearFilters(){this.filterForm={playerId:0,opponentIds:[],dateFilter:p.Zv.AllTime},this.currentPage=1,this.loadAllMatches()}getPaginatedMatches(){const t=(this.currentPage-1)*this.itemsPerPage;return this.allMatches.slice(t,t+this.itemsPerPage)}changePage(t){t>=1&&t<=this.totalPages&&(this.currentPage=t)}getPlayerName(t){const s=this.players.find(r=>r.playerId===t);return s?s.fullName:"Unknown Player"}searchPlayer1(t){const s=t.target.value;this.matchForm.player1Name=s,s.trim()?(this.filteredPlayer1Suggestions=this.getAllActivePlayers().filter(a=>a.fullName.toLowerCase().includes(s.toLowerCase())),this.showPlayer1Suggestions=!0,this.showPlayer1Select=!1):(this.filteredPlayer1Suggestions=[],this.showPlayer1Suggestions=!1,this.showPlayer1Select=!0);const r=this.getPlayerByName(s);r?(this.matchForm.player1Id=r.playerId,this.matchForm.player2Name="",this.matchForm.player2Id=0,this.filteredPlayer2Suggestions=[],this.showPlayer2Suggestions=!1):this.matchForm.player1Id=0}searchPlayer2(t){const s=t.target.value;this.matchForm.player2Name=s,s.trim()?(this.filteredPlayer2Suggestions=this.getOpponentsForPlayerByName(this.matchForm.player1Name).filter(a=>a.fullName.toLowerCase().includes(s.toLowerCase())),this.showPlayer2Suggestions=!0,this.showPlayer2Select=!1):(this.filteredPlayer2Suggestions=[],this.showPlayer2Suggestions=!1,this.showPlayer2Select=!0);const r=this.getPlayerByName(s);this.matchForm.player2Id=r?r.playerId:0}selectPlayer1(t){this.matchForm.player1Name=t.fullName,this.matchForm.player1Id=t.playerId,this.showPlayer1Suggestions=!1,this.showPlayer1Select=!1,this.filteredPlayer1Suggestions=[],this.matchForm.player2Name="",this.matchForm.player2Id=0,this.filteredPlayer2Suggestions=[]}selectPlayer2(t){this.matchForm.player2Name=t.fullName,this.matchForm.player2Id=t.playerId,this.showPlayer2Suggestions=!1,this.showPlayer2Select=!1,this.filteredPlayer2Suggestions=[]}selectPlayer1FromSelect(t){const s=parseInt(t.target.value);if(s){const r=this.players.find(a=>a.playerId===s);r&&(this.matchForm.player1Name=r.fullName,this.matchForm.player1Id=r.playerId,this.matchForm.player2Name="",this.matchForm.player2Id=0,this.filteredPlayer2Suggestions=[])}else this.matchForm.player1Name="",this.matchForm.player1Id=0;this.showPlayer1Select=!1}selectPlayer2FromSelect(t){const s=parseInt(t.target.value);if(s){const r=this.players.find(a=>a.playerId===s);r&&(this.matchForm.player2Name=r.fullName,this.matchForm.player2Id=r.playerId)}else this.matchForm.player2Name="",this.matchForm.player2Id=0;this.showPlayer2Select=!1}hidePlayer1Suggestions(){setTimeout(()=>{this.showPlayer1Suggestions=!1,this.showPlayer1Select=!1},200)}hidePlayer2Suggestions(){setTimeout(()=>{this.showPlayer2Suggestions=!1,this.showPlayer2Select=!1},200)}getPlayerByName(t){return this.players.find(s=>s.fullName===t)}editMatch(t){const s=this.players.find(a=>a.fullName===t.player1Name),r=this.players.find(a=>a.fullName===t.player2Name);this.matchForm={player1Id:s?.playerId||0,player2Id:r?.playerId||0,player1Name:t.player1Name,player2Name:t.player2Name,player1Score:t.player1Score,player2Score:t.player2Score,playedOn:new Date(t.playedOn)},this.selectedPlayerForMatch=t,this.showRecordMatchModal=!0}updateMatch(){if(!this.selectedPlayerForMatch)return;if(!this.matchForm.player1Name||!this.matchForm.player2Name)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0623\u0633\u0645\u0627\u0621 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631");const t=this.getPlayerByName(this.matchForm.player1Name),s=this.getPlayerByName(this.matchForm.player2Name);t&&s?null!==this.matchForm.player1Score&&null!==this.matchForm.player2Score?this.matchForm.player1Score<0||this.matchForm.player2Score<0?this.toastr.warning("\u0644\u0627 \u064a\u0645\u0643\u0646 \u0623\u0646 \u062a\u0643\u0648\u0646 \u0627\u0644\u0646\u0642\u0627\u0637 \u0633\u0627\u0644\u0628\u0629","\u062a\u062d\u0630\u064a\u0631"):0!==this.matchForm.player1Score||0!==this.matchForm.player2Score?(this.isRecordingMatch=!0,this.friendlyMatchService.updateFriendlyMatchAsync(this.selectedPlayerForMatch.matchId,{player1Id:t.playerId,player2Id:s.playerId,player1Score:this.matchForm.player1Score,player2Score:this.matchForm.player2Score}).subscribe({next:r=>{r.success?(this.toastr.success(`\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0628\u0646\u062c\u0627\u062d: ${t.fullName} (${this.matchForm.player1Score}) - ${s.fullName} (${this.matchForm.player2Score})`,"\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629"),this.friendlyMatchService.refreshFriendlyMatches(),this.loadAllMatches(),this.calculateStatistics(),this.selectedPlayer&&this.loadPlayerMatches(this.selectedPlayer.playerId),this.closeRecordMatchModal()):this.toastr.error(r.message||"\u0641\u0634\u0644 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u062f\u064a\u062b"),this.isRecordingMatch=!1},error:r=>{this.toastr.error(r.error?.message||r.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u062f\u064a\u062b"),this.isRecordingMatch=!1}})):this.toastr.warning("\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0644\u062f\u0649 \u0644\u0627\u0639\u0628 \u0648\u0627\u062d\u062f \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0646\u0642\u0627\u0637 \u0625\u064a\u062c\u0627\u0628\u064a\u0629 (0-0 \u063a\u064a\u0631 \u0645\u0633\u0645\u0648\u062d)","\u062a\u062d\u0630\u064a\u0631"):this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0627\u0644\u0646\u0642\u0627\u0637 \u0644\u0643\u0644\u0627 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631"):this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0635\u062d\u0629 \u0623\u0633\u0645\u0627\u0621 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631")}deleteMatchFromList(t){confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629\u061f")&&this.friendlyMatchService.deleteFriendlyMatchAsync(t).subscribe({next:s=>{s.success?(this.toastr.success("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0628\u0646\u062c\u0627\u062d","\u062a\u0645 \u0627\u0644\u062d\u0630\u0641"),this.friendlyMatchService.refreshFriendlyMatches(),this.loadAllMatches(),this.calculateStatistics(),this.selectedPlayer&&this.loadPlayerMatches(this.selectedPlayer.playerId)):this.toastr.error(s.message||"\u0641\u0634\u0644 \u062d\u0630\u0641 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641")},error:s=>{this.toastr.error(s.error?.message||s.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641")}})}onPlayer1Focus(){this.matchForm.player1Name.trim()&&this.filteredPlayer1Suggestions.length>0?(this.showPlayer1Suggestions=!0,this.showPlayer1Select=!1):this.showPlayer1Select=!0}onPlayer2Focus(){this.matchForm.player2Name.trim()&&this.filteredPlayer2Suggestions.length>0?(this.showPlayer2Suggestions=!0,this.showPlayer2Select=!1):this.showPlayer2Select=!0}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(_e.w),e.rXU(C.G),e.rXU(f.tw))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-friendlies"]],decls:13,vars:10,consts:[[1,"block","sm:flex","transition-all","duration-600"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","text-white","transition-all","duration-600",3,"ngClass"],[1,"text-lg","font-bold","mb-4","flex","justify-between","overflow-hidden","text-white"],[1,"text-gray-300","text-3xl",3,"click"],[4,"ngIf"],["class","mt-4 w-full bg-green-600 p-2 rounded text-white hover:bg-green-700 transition",3,"click",4,"ngIf"],[1,"sm:flex-1","sm:p-2","transition-all","duration-600","sm:container","sm:mx-auto"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50",4,"ngIf"],["class","flex items-center justify-between p-2 cursor-pointer rounded-md hover:bg-gray-700",3,"bg-blue-600","click",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-2","cursor-pointer","rounded-md","hover:bg-gray-700",3,"click"],[1,"text-white","cursor-pointer","hover:text-blue-300",3,"click"],[1,"bg-red-600","px-2","py-1","text-sm","rounded","text-white","hover:bg-red-700","transition",3,"click"],[1,"mt-4","w-full","bg-green-600","p-2","rounded","text-white","hover:bg-green-700","transition",3,"click"],["class","sm:w-4/6 mx-auto",4,"ngIf"],[1,"my-3","border-gray-600"],[1,"flex","justify-evenly","pt-5"],[1,"bg-blue-600","text-white","px-3","py-2","rounded","mb-4","hover:bg-blue-700","transition",3,"click"],["routerLink","/admin/friendly-inbox",1,"bg-purple-600","hover:bg-purple-700","text-white","mb-4","px-3","py-2","rounded","transition-all","relative"],["class","absolute -top-2 -right-2 w-[30px] h-[30px] rounded-full bg-green-600 flex justify-center items-center",4,"ngIf"],[1,"text-center","mb-8"],[1,"mb-4","text-4xl","font-extrabold","leading-none","tracking-tight","md:text-4xl","lg:text-4xl","text-white"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-2","gap-4"],[1,"bg-teal-600","text-white","p-4","rounded-lg","hover:bg-teal-700","transition-all",3,"disabled","click"],[1,"text-lg","font-bold"],[1,"text-sm"],[1,"bg-green-600","text-white","p-4","rounded-lg","hover:bg-green-700","transition-all",3,"click"],[1,"mt-8"],[1,"mb-6","p-2","bg-gray-800","rounded-lg"],[1,"mb-4"],[1,"text-lg","font-semibold","text-white"],[1,"grid","grid-cols-2","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","mb-1","text-gray-300"],[1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-4"],[1,"bg-gray-600","px-4","py-2","text-white","rounded","hover:bg-gray-700","transition",3,"click"],[1,"overflow-x-auto"],[1,"w-full","text-white"],[1,"text-center"],[1,"border-b","border-gray-600","text-center"],[1,"p-3"],["class","border-b border-gray-700 hover:bg-gray-800",4,"ngFor","ngForOf"],["class","flex justify-center mt-6",4,"ngIf"],[1,"text-center","mt-4","text-gray-300"],[1,"sm:w-4/6","mx-auto"],[1,"text-2xl","font-bold","mb-4","text-center","text-white"],[1,"absolute","-top-2","-right-2","w-[30px]","h-[30px]","rounded-full","bg-green-600","flex","justify-center","items-center"],[1,"text-white","font-bold"],[1,"border-b","border-gray-700","hover:bg-gray-800"],[1,"p-3","text-center"],[1,"font-bold","text-lg"],[1,"flex","justify-center","space-x-2"],[1,"bg-blue-600","px-3","py-1","text-white","rounded","hover:bg-blue-700","transition","text-sm",3,"click"],[1,"bg-red-600","px-3","py-1","text-white","rounded","hover:bg-red-700","transition","text-sm",3,"click"],[1,"flex","justify-center","mt-6"],[1,"flex","space-x-2"],[1,"bg-gray-600","px-3","py-2","text-white","rounded","hover:bg-gray-700","transition",3,"disabled","click"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],[1,"px-3","py-2","text-white","rounded","transition",3,"click"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-75","z-50"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-6","rounded-lg"],[1,"text-lg","font-bold","mb-4","text-white"],[1,"text-gray-300"],[1,"mt-4","flex","justify-end"],[1,"bg-gray-600","px-4","py-2","text-white","rounded","mr-2","hover:bg-gray-700","transition",3,"click"],[1,"bg-red-600","px-4","py-2","text-white","rounded","hover:bg-red-700","transition",3,"click"],["type","text","placeholder","Enter player name",1,"border","border-gray-600","p-2","w-full","bg-gray-800","text-white","rounded","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"bg-red-600","px-4","py-2","text-white","rounded","mr-2","hover:bg-red-700","transition",3,"click"],[1,"bg-green-600","px-4","py-2","text-white","rounded","hover:bg-green-700","transition",3,"click"],[1,"bg-black","bg-opacity-50","backdrop-blur-sm","p-6","rounded-lg","w-96","max-h-[90vh]","overflow-y-auto"],["class","mb-4",4,"ngIf"],[1,"grid","grid-cols-2","gap-4","mb-4"],["type","number","min","0","placeholder","Enter score",1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","ngModelChange","input"],[1,"flex","justify-end","space-x-4"],[1,"bg-green-600","px-4","py-2","text-white","rounded","hover:bg-green-700","transition",3,"disabled","click"],[1,"relative"],["type","text","autocomplete","off",1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-800","text-white","placeholder-gray-400",3,"ngModel","placeholder","ngModelChange","input","focus","blur"],["class","absolute z-[9999] w-full mt-1 top-full",4,"ngIf"],["class","absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto",4,"ngIf"],["class","text-red-400 text-sm mt-1",4,"ngIf"],[1,"absolute","z-[9999]","w-full","mt-1","top-full"],["size","8",1,"w-full","bg-gray-800","border","border-gray-600","rounded-md","text-white","shadow-2xl","min-h-[200px]",3,"change","blur"],["value","",1,"text-gray-400","bg-gray-800","py-3","px-4","border-b","border-gray-700","text-base"],["class","text-white bg-gray-800 py-3 px-4 border-b border-gray-700 hover:bg-gray-700 cursor-pointer text-base",3,"value","selected",4,"ngFor","ngForOf"],[1,"text-white","bg-gray-800","py-3","px-4","border-b","border-gray-700","hover:bg-gray-700","cursor-pointer","text-base",3,"value","selected"],[1,"absolute","z-50","w-full","mt-1","bg-gray-800","border","border-gray-600","rounded-md","shadow-lg","max-h-48","overflow-y-auto"],["class","p-2 hover:bg-gray-700 cursor-pointer text-white border-b border-gray-600 last:border-b-0",3,"click",4,"ngFor","ngForOf"],[1,"p-2","hover:bg-gray-700","cursor-pointer","text-white","border-b","border-gray-600","last:border-b-0",3,"click"],[1,"text-red-400","text-sm","mt-1"],["size","6",1,"w-full","bg-gray-800","border","border-gray-600","rounded-md","text-white","shadow-2xl","min-h-[200px]",3,"change","blur"],[1,"border","border-gray-600","p-2","w-full","rounded","bg-gray-700","text-white"]],template:function(s,r){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3," Friendly Players "),e.j41(4,"button",3),e.bIt("click",function(){return r.toggleSidebar()}),e.EFF(5," \xd7 "),e.k0s()(),e.DNE(6,ye,2,1,"ul",4),e.DNE(7,be,2,0,"button",5),e.k0s(),e.j41(8,"div",6),e.DNE(9,je,73,17,"div",4),e.DNE(10,Pe,14,1,"div",7),e.DNE(11,Ie,10,1,"div",7),e.DNE(12,Oe,22,9,"div",7),e.k0s()()),2&s&&(e.R7$(1),e.Y8G("ngClass",e.l_i(7,Ue,r.isSidebarOpen,!r.isSidebarOpen)),e.R7$(5),e.Y8G("ngIf",r.isSidebarOpen),e.R7$(1),e.Y8G("ngIf",r.isSidebarOpen),e.R7$(2),e.Y8G("ngIf","friendlies"===r.activeTab),e.R7$(1),e.Y8G("ngIf",r.showDeleteModal),e.R7$(1),e.Y8G("ngIf",r.showModal),e.R7$(1),e.Y8G("ngIf",r.showRecordMatchModal))},dependencies:[m.YU,m.Sq,m.bT,_.Wk,l.xH,l.y7,l.me,l.Q0,l.wz,l.BC,l.VZ,l.vS,m.vh],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}*[_ngcontent-%COMP%]{transition:all .3s ease}button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #0003}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#3b82f61a!important}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.loading[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{position:fixed;z-index:1000}}input[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.status-active[_ngcontent-%COMP%]{color:#10b981}.status-inactive[_ngcontent-%COMP%]{color:#ef4444}.score-winner[_ngcontent-%COMP%]{color:#10b981;font-weight:700}.score-loser[_ngcontent-%COMP%]{color:#ef4444}.score-draw[_ngcontent-%COMP%]{color:#f59e0b}\n\n/*# sourceMappingURL=friendlies.component.css.map*/"]})}}return n})();const Je=["messagesContainer"];function He(n,i){1&n&&(e.j41(0,"div",9),e.EFF(1," No friendly messages here \u{1f4ed} "),e.k0s())}function Qe(n,i){if(1&n&&(e.j41(0,"span",16),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" ",t.unreadCount," ")}}function qe(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",12),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.openChat(a.senderId))}),e.j41(1,"div")(2,"p",13),e.EFF(3),e.k0s(),e.j41(4,"p",14),e.EFF(5),e.k0s()(),e.DNE(6,Qe,2,1,"span",15),e.k0s()}if(2&n){const t=i.$implicit;e.R7$(3),e.JRh(t.senderFullName),e.R7$(2),e.JRh(t.lastMessage),e.R7$(1),e.Y8G("ngIf",t.unreadCount>0)}}function We(n,i){if(1&n&&(e.j41(0,"div",10),e.DNE(1,qe,7,3,"div",11),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.playerChats)("ngForTrackBy",t.trackByPlayerId)}}const Ze=function(n,i){return{"text-right":n,"text-left":i}},Ke=function(n,i){return{"bg-green-700":n,"bg-gray-700 ":i}};function et(n,i){if(1&n&&(e.j41(0,"div",31)(1,"div",32)(2,"p",33),e.EFF(3),e.k0s(),e.j41(4,"p",34),e.EFF(5),e.nI1(6,"date"),e.k0s()()()),2&n){const t=i.$implicit;e.Y8G("ngClass",e.l_i(7,Ze,!t.isFromAdmin,t.isFromAdmin)),e.R7$(1),e.Y8G("ngClass",e.l_i(10,Ke,!t.isFromAdmin,t.isFromAdmin)),e.R7$(2),e.JRh(t.content),e.R7$(2),e.SpI(" ",e.i5U(6,4,t.sentAt,"MMM d, y, hh:mm a")," ")}}const k=function(n){return{"sm:left-1/3":n}},tt=function(){return{standalone:!0}};function rt(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"div",19)(3,"button",20),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeChat())}),e.nrm(4,"i",21),e.k0s(),e.j41(5,"div")(6,"p",22),e.EFF(7),e.k0s(),e.j41(8,"p",23),e.EFF(9),e.k0s()()()(),e.j41(10,"div",24,25),e.DNE(12,et,7,13,"div",26),e.k0s(),e.j41(13,"div",27)(14,"form",28),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.sendReply())}),e.j41(15,"input",29),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.replyMessages[a.selectedChat.messages[0].id]=r)})("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.replyMessages[a.selectedChat.messages[0].id]=r)}),e.k0s(),e.j41(16,"button",30),e.EFF(17," Reply "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(1),e.xc7("top",t.navbarHeight,"px"),e.Y8G("ngClass",e.eq3(13,k,t.selectedChat)),e.R7$(6),e.SpI(" ",t.selectedChat.senderFullName," "),e.R7$(2),e.SpI(" ",t.selectedChat.senderPhoneNumber," "),e.R7$(1),e.xc7("margin-top",t.navbarHeight+80,"px"),e.R7$(2),e.Y8G("ngForOf",t.selectedChat.messages)("ngForTrackBy",t.trackByMessageId),e.R7$(1),e.Y8G("ngClass",e.eq3(15,k,t.selectedChat)),e.R7$(2),e.Y8G("ngModel",t.replyMessages[t.selectedChat.messages[0].id])("ngModelOptions",e.lJ4(17,tt)),e.R7$(1),e.Y8G("disabled",!t.replyMessages[t.selectedChat.messages[0].id])}}function st(n,i){1&n&&(e.j41(0,"div",35),e.EFF(1," Select a friendly chat to view messages \u{1f4e9} "),e.k0s())}const nt=function(n){return{hidden:n}},at=function(n,i){return{block:n,"hidden sm:flex":i}};let it=(()=>{class n{constructor(t,s,r){this.friendlyMessageService=t,this.toastr=s,this.cdr=r,this.playerChats=[],this.selectedPlayerId=null,this.selectedChat=null,this.replyMessages={},this.navbarHeight=60}ngOnInit(){this.loadFriendlyMessages()}ngOnDestroy(){this.updateStatusSubscription&&this.updateStatusSubscription.unsubscribe(),this.refreshSubscription&&this.refreshSubscription.unsubscribe()}loadFriendlyMessages(){this.friendlyMessageService.getAllMessages().subscribe({next:t=>{if(t.success&&t.messages){const s=this.groupMessagesBySender(t.messages);console.log(t.messages),this.playerChats=s.sort((o,c)=>new Date(c.lastMessageDate).getTime()-new Date(o.lastMessageDate).getTime()),t.messages.filter(o=>!o.isRead&&!o.isFromAdmin)}else this.toastr.error(t.message||"\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644 \u0648\u062f\u064a\u0629")},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062c\u0644\u0628 \u0627\u0644\u0631\u0633\u0627\u0626\u0644")}})}refreshMessages(){this.friendlyMessageService.getAllMessages().subscribe({next:t=>{if(t.success&&t.messages){const s=this.groupMessagesBySender(t.messages);this.playerChats=s.sort((o,c)=>new Date(c.lastMessageDate).getTime()-new Date(o.lastMessageDate).getTime());const r=t.messages.length,a=t.messages.filter(o=>!o.isRead&&!o.isFromAdmin).length;r>0?this.toastr.info(`\u062a\u0645 \u062a\u062d\u062f\u064a\u062b ${r} \u0631\u0633\u0627\u0644\u0629${a>0?` (${a} \u0631\u0633\u0627\u0644\u0629 \u063a\u064a\u0631 \u0645\u0642\u0631\u0648\u0621\u0629)`:""}`,"\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0631\u0633\u0627\u0626\u0644"):this.toastr.info("\u0644\u0627 \u062a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644 \u0648\u062f\u064a\u0629 \u062d\u0627\u0644\u064a\u0627\u064b","\u0645\u0639\u0644\u0648\u0645\u0627\u062a")}else this.toastr.error(t.message||"\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644 \u0648\u062f\u064a\u0629")},error:t=>{this.toastr.error(t.error?.message||t.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062c\u0644\u0628 \u0627\u0644\u0631\u0633\u0627\u0626\u0644")}})}ngAfterViewChecked(){this.selectedChat&&this.messagesContainer&&this.scrollToBottom()}groupMessagesBySender(t){const s={};return t.forEach(a=>{let o=a.senderId||a.playerId;if(("string"!=typeof o||!o.includes("-"))&&"string"==typeof o){const c=parseInt(o,10);!isNaN(c)&&c>0&&(o=c)}if(o){if(!s[o]){const c=a.isFromAdmin?`\u0627\u0644\u0644\u0627\u0639\u0628 ${o}`:a.senderFullName||a.playerFullName||`\u0627\u0644\u0644\u0627\u0639\u0628 ${o}`;s[o]={senderId:String(o),senderFullName:c,senderPhoneNumber:a.senderPhoneNumber||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631",lastMessage:"",lastMessageDate:"",unreadCount:0,messages:[]}}s[o].messages.push(a),!a.isFromAdmin&&!a.isRead&&s[o].unreadCount++}}),Object.values(s).map(a=>{a.messages=a.messages.sort((c,g)=>new Date(c.sentAt).getTime()-new Date(g.sentAt).getTime());const o=a.messages[a.messages.length-1];a.lastMessage=o?.content??"",a.lastMessageDate=o?.sentAt??"";for(let c=a.messages.length-1;c>=0;c--){const g=a.messages[c];if(!g.isFromAdmin){a.senderFullName=g.senderFullName||g.playerFullName||a.senderFullName,a.senderPhoneNumber=g.senderPhoneNumber||a.senderPhoneNumber;break}}return a})}openChat(t){this.selectedPlayerId=t,this.selectedChat=this.playerChats.find(s=>s.senderId===t)||null,this.selectedChat&&(this.selectedChat.senderFullName||(this.selectedChat.senderFullName=`\u0627\u0644\u0644\u0627\u0639\u0628 ${this.selectedChat.senderId}`),this.selectedChat.messages.filter(s=>!s.isRead&&!s.isFromAdmin).forEach(s=>{this.friendlyMessageService.markMessageAsRead(s.id).subscribe({next:r=>{r.success&&(s.isRead=!0,this.selectedChat.unreadCount=this.selectedChat.messages.filter(a=>!a.isRead&&!a.isFromAdmin).length,this.cdr.detectChanges())},error:r=>{this.toastr.error(r.error?.message||r.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u062f\u064a\u062b \u062d\u0627\u0644\u0629 \u0627\u0644\u0631\u0633\u0627\u0644\u0629","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u062f\u064a\u062b")}})}),this.cdr.detectChanges())}closeChat(){this.selectedPlayerId=null,this.selectedChat=null,this.replyMessages={},this.cdr.detectChanges()}sendReply(){if(!this.selectedChat)return void this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0645\u062d\u0627\u062f\u062b\u0629");if(!this.selectedChat.senderId)return void this.toastr.error("\u062e\u0637\u0623: \u0645\u0639\u0631\u0641 \u0627\u0644\u0644\u0627\u0639\u0628 \u063a\u064a\u0631 \u0635\u062d\u064a\u062d");if(!this.selectedChat.messages||0===this.selectedChat.messages.length)return void this.toastr.error("\u062e\u0637\u0623: \u0644\u0627 \u062a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644 \u0641\u064a \u0647\u0630\u0647 \u0627\u0644\u0645\u062d\u0627\u062f\u062b\u0629");const t=this.replyMessages[this.selectedChat.messages[0].id]?.trim();t?this.friendlyMessageService.sendAdminReply(this.selectedChat.senderId,t).subscribe({next:s=>{if(s.success){this.toastr.success(`\u062a\u0645 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f \u0628\u0646\u062c\u0627\u062d \u0625\u0644\u0649 ${this.selectedChat.senderFullName||`\u0627\u0644\u0644\u0627\u0639\u0628 ${this.selectedChat.senderId}`}`,"\u062a\u0645 \u0627\u0644\u0625\u0631\u0633\u0627\u0644"),this.replyMessages[this.selectedChat.messages[0].id]="";const a={id:Math.random(),senderId:this.selectedChat.senderId,senderFullName:this.selectedChat.senderFullName||`\u0627\u0644\u0644\u0627\u0639\u0628 ${this.selectedChat.senderId}`,senderPhoneNumber:this.selectedChat.senderPhoneNumber||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631",content:t,isRead:!0,sentAt:(new Date).toISOString(),isFromAdmin:!0,messageType:"admin_reply"};this.selectedChat.messages.push(a),this.selectedChat.messages.sort((o,c)=>new Date(o.sentAt).getTime()-new Date(c.sentAt).getTime()),this.selectedChat.lastMessage=t,this.selectedChat.lastMessageDate=a.sentAt,this.selectedChat.senderFullName||(this.selectedChat.senderFullName=`\u0627\u0644\u0644\u0627\u0639\u0628 ${this.selectedChat.senderId}`),this.playerChats.sort((o,c)=>new Date(c.lastMessageDate).getTime()-new Date(o.lastMessageDate).getTime()),this.selectedChat=this.playerChats.find(o=>o.senderId===this.selectedPlayerId)||null,this.cdr.detectChanges()}else this.toastr.error(s.message||"\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u0631\u0633\u0627\u0644")},error:s=>{this.toastr.error(s.error?.message||s.message||"\u062d\u0635\u0644 \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f","\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u0631\u0633\u0627\u0644")}}):this.toastr.warning("\u0627\u0644\u0631\u062c\u0627\u0621 \u0643\u062a\u0627\u0628\u0629 \u0631\u062f")}scrollToBottom(){if(this.messagesContainer){const t=this.messagesContainer.nativeElement;t.scrollTop=t.scrollHeight}}trackByPlayerId(t,s){return s.senderId}trackByMessageId(t,s){return s.id}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(C.G),e.rXU(f.tw),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-friendly-inbox"]],viewQuery:function(s,r){if(1&s&&e.GBs(Je,5),2&s){let a;e.mGM(a=e.lsd())&&(r.messagesContainer=a.first)}},decls:11,vars:11,consts:[[1,"container","mx-auto","p-4","flex","flex-col","sm:flex-row","overflow-hidden","h-screen"],[1,"w-full","sm:w-1/3","border-r","border-gray-600","sm:block",3,"ngClass"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-white"],["class","text-center text-gray-300",4,"ngIf"],["class","space-y-2 overflow-y-auto max-h-[calc(100vh-120px)]",4,"ngIf"],[1,"w-full","sm:w-2/3","flex","flex-col","h-full","relative",3,"ngClass"],["class","flex flex-col h-full",4,"ngIf","ngIfElse"],["noChatSelected",""],[1,"text-center","text-gray-300"],[1,"space-y-2","overflow-y-auto","max-h-[calc(100vh-120px)]"],["class","p-4 backdrop-blur-sm border border-gray-600 rounded-lg hover:bg-gray-700 cursor-pointer flex items-center justify-between",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-4","backdrop-blur-sm","border","border-gray-600","rounded-lg","hover:bg-gray-700","cursor-pointer","flex","items-center","justify-between",3,"click"],[1,"font-bold","text-white"],[1,"text-sm","text-gray-300","truncate"],["class","bg-green-600 text-white text-xs font-bold rounded-full px-2 py-1",4,"ngIf"],[1,"bg-green-600","text-white","text-xs","font-bold","rounded-full","px-2","py-1"],[1,"flex","flex-col","h-full"],[1,"fixed","left-0","right-0","z-40","p-2","backdrop-blur-sm","border-b","border-gray-600","flex","items-center","justify-between","bg-black","bg-opacity-90",3,"ngClass"],[1,"flex","items-center"],[1,"mr-4","text-gray-300","hover:text-white","transition",3,"click"],[1,"fa-solid","fa-arrow-left",2,"color","#ffffff"],[1,"font-bold","text-white","text-sm","p-0"],[1,"text-xs","text-gray-400","p-0"],[1,"flex-1","p-4","overflow-y-auto","backdrop-blur-sm",2,"margin-bottom","80px"],["messagesContainer",""],["class","mb-4",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"fixed","bottom-0","left-0","right-0","z-50","p-4","bg-black","bg-opacity-90","backdrop-blur-sm","border-t","border-gray-600",3,"ngClass"],[1,"flex","items-center","gap-2",3,"ngSubmit"],["type","text","placeholder","Write your reply...",1,"flex-1","p-2","border","border-gray-600","rounded-lg","bg-gray-800","text-white","focus:outline-none","focus:ring-2","focus:ring-blue-600","placeholder-gray-400",3,"ngModel","ngModelOptions","ngModelChange"],["type","submit",1,"bg-blue-600","text-white","p-2","rounded-lg","hover:bg-blue-700","transition","disabled:bg-gray-600",3,"disabled"],[1,"mb-4",3,"ngClass"],[1,"inline-block","p-3","rounded-lg","max-w-xs",3,"ngClass"],[1,"text-white"],[1,"text-xs","mt-1","text-gray-300"],[1,"w-full","flex","items-center","justify-center","text-gray-300"]],template:function(s,r){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"\u{1f4ec} Friendly Inbox"),e.k0s()(),e.DNE(5,He,2,0,"div",4),e.DNE(6,We,2,2,"div",5),e.k0s(),e.j41(7,"div",6),e.DNE(8,rt,18,18,"div",7),e.DNE(9,st,2,0,"ng-template",null,8,e.C5r),e.k0s()()),2&s){const a=e.sdS(10);e.R7$(1),e.Y8G("ngClass",e.eq3(6,nt,r.selectedChat)),e.R7$(4),e.Y8G("ngIf",0===r.playerChats.length),e.R7$(1),e.Y8G("ngIf",r.playerChats.length>0),e.R7$(1),e.Y8G("ngClass",e.l_i(8,at,r.selectedChat,!r.selectedChat)),e.R7$(1),e.Y8G("ngIf",r.selectedChat)("ngIfElse",a)}},dependencies:[m.YU,m.Sq,m.bT,l.qT,l.me,l.BC,l.cb,l.vS,l.cV,m.vh]})}}return n})();var ot=u(8171);function lt(n,i){if(1&n&&(e.j41(0,"p",11),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.activeTournament.name," ")}}function ct(n,i){1&n&&(e.j41(0,"p",11),e.EFF(1," No active tournament "),e.k0s())}function dt(n,i){1&n&&(e.j41(0,"div",29),e.nrm(1,"div",30),e.k0s())}function ut(n,i){1&n&&(e.j41(0,"div",34)(1,"p",35),e.EFF(2,"No tournaments created yet."),e.k0s()())}function mt(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(3);return e.Njj(a.openCreateTeamModal(r))}),e.EFF(1),e.k0s()}if(2&n){const t=e.XpG().$implicit,s=e.XpG(3);e.R7$(1),e.SpI(" Create Team (",s.getRemainingTeams(t)," remaining) ")}}function ht(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",55),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(3);return e.Njj(a.startTournament(r))}),e.EFF(1," Start Tournament "),e.k0s()}}function pt(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(3);return e.Njj(a.finishTournament(r))}),e.EFF(1," Finish Tournament "),e.k0s()}}function gt(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",57),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(3);return e.Njj(a.deleteTournament(r))}),e.EFF(1," Delete Tournament "),e.k0s()}}function _t(n,i){if(1&n&&(e.j41(0,"span",67),e.EFF(1),e.k0s()),2&n){const t=i.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function ft(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(5);return e.Njj(a.openReplacePlayerModal(r))}),e.EFF(1," \u{1f504} Replace Player "),e.k0s()}}function yt(n,i){if(1&n&&(e.j41(0,"div",61)(1,"div",62),e.EFF(2),e.k0s(),e.j41(3,"div",63),e.DNE(4,_t,2,1,"span",64),e.k0s(),e.j41(5,"div",65),e.DNE(6,ft,2,0,"button",66),e.k0s()()),2&n){const t=i.$implicit,s=e.XpG(2).$implicit,r=e.XpG(3);e.R7$(2),e.SpI(" ",t.teamName," "),e.R7$(2),e.Y8G("ngForOf",r.getTeamPlayersNames(t)),e.R7$(2),e.Y8G("ngIf","Started"===s.status)}}function bt(n,i){if(1&n&&(e.j41(0,"div",18)(1,"h5",58),e.EFF(2,"Teams"),e.k0s(),e.j41(3,"div",59),e.DNE(4,yt,7,3,"div",60),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.Y8G("ngForOf",t.teams)}}function vt(n,i){1&n&&(e.j41(0,"div",69)(1,"p",35),e.EFF(2,"No teams created yet."),e.k0s(),e.j41(3,"p",70),e.EFF(4," Create teams to start the tournament "),e.k0s()())}function xt(n,i){if(1&n&&(e.j41(0,"div",38)(1,"div",39)(2,"div")(3,"h4",40),e.EFF(4),e.k0s(),e.j41(5,"div",41)(6,"span",42),e.EFF(7,"Status: "),e.j41(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"span",42),e.EFF(11),e.k0s(),e.j41(12,"span",42),e.EFF(13),e.k0s(),e.j41(14,"span",11),e.EFF(15),e.k0s()()()(),e.j41(16,"div",43),e.DNE(17,mt,2,1,"button",44),e.DNE(18,ht,2,0,"button",45),e.DNE(19,pt,2,0,"button",46),e.DNE(20,gt,2,0,"button",47),e.k0s(),e.DNE(21,bt,5,1,"div",48),e.DNE(22,vt,5,0,"div",49),e.j41(23,"div",50)(24,"div",51)(25,"span"),e.EFF(26,"Progress"),e.k0s(),e.j41(27,"span"),e.EFF(28),e.nI1(29,"number"),e.k0s()(),e.j41(30,"div",52),e.nrm(31,"div",53),e.k0s()()()),2&n){const t=i.$implicit,s=e.XpG(3);e.R7$(4),e.SpI(" ",t.name," "),e.R7$(4),e.HbH(s.getStatusColor(t.status)),e.R7$(1),e.JRh(t.status),e.R7$(2),e.Lme("Teams: ",t.teams.length,"/",t.teamCount,""),e.R7$(2),e.SpI("Players per team: ",t.playersPerTeam,""),e.R7$(2),e.SpI("Scoring System: ",t.systemOfScoring,""),e.R7$(2),e.Y8G("ngIf","Created"===t.status&&s.getRemainingTeams(t)>0),e.R7$(1),e.Y8G("ngIf",s.canStartTournament(t)),e.R7$(1),e.Y8G("ngIf",s.canFinishTournament(t)),e.R7$(1),e.Y8G("ngIf",s.canDeleteTournament(t)),e.R7$(1),e.Y8G("ngIf",t.teams.length>0),e.R7$(1),e.Y8G("ngIf",0===t.teams.length),e.R7$(6),e.SpI("",e.i5U(29,17,t.teams.length/t.teamCount*100,"1.0-0"),"%"),e.R7$(3),e.xc7("width",t.teams.length/t.teamCount*100,"%")}}function Ft(n,i){if(1&n&&(e.j41(0,"div",36),e.DNE(1,xt,32,20,"div",37),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.tournaments)}}function Ct(n,i){if(1&n&&(e.j41(0,"div",31)(1,"h3",32),e.EFF(2,"All Tournaments"),e.k0s(),e.DNE(3,ut,3,0,"div",25),e.DNE(4,Ft,2,1,"div",33),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",0===t.tournaments.length),e.R7$(1),e.Y8G("ngIf",t.tournaments.length>0)}}function kt(n,i){1&n&&(e.qSk(),e.joV(),e.j41(0,"div",29),e.nrm(1,"div",30),e.k0s())}function Tt(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",73),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectPlayer(a))}),e.j41(1,"div",74)(2,"div",75),e.EFF(3),e.k0s()()()}if(2&n){const t=i.$implicit;e.R7$(3),e.SpI(" ",t.fullName," ")}}function Mt(n,i){if(1&n&&(e.qSk(),e.joV(),e.j41(0,"div",71),e.DNE(1,Tt,4,1,"div",72),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.filteredPlayers)}}function jt(n,i){if(1&n&&(e.j41(0,"p",35),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI(' No players found matching "',t.playerSearchTerm,'" ')}}function Pt(n,i){1&n&&(e.j41(0,"p",35),e.EFF(1," No players available. Add players first. "),e.k0s())}function It(n,i){if(1&n&&(e.qSk(),e.joV(),e.j41(0,"div",34),e.DNE(1,jt,2,1,"p",76),e.DNE(2,Pt,2,0,"p",76),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.playerSearchTerm&&""!==t.playerSearchTerm.trim()),e.R7$(1),e.Y8G("ngIf",!t.playerSearchTerm||""===t.playerSearchTerm.trim())}}function wt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTournamentModal())}),e.j41(1,"div",78),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTournamentModal())}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"h2",80),e.EFF(5,"Create New Tournament"),e.k0s(),e.j41(6,"div",31)(7,"div")(8,"label",81),e.EFF(9,"Tournament Name"),e.k0s(),e.j41(10,"input",82),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.createTournamentForm.name=r)}),e.k0s()(),e.j41(11,"div")(12,"label",81),e.EFF(13,"Scoring System"),e.k0s(),e.j41(14,"select",83),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.createTournamentForm.systemOfScoring=r)}),e.j41(15,"option",84),e.EFF(16,"Classic (Win/Draw/Loss)"),e.k0s(),e.j41(17,"option",85),e.EFF(18,"Points System"),e.k0s()()(),e.j41(19,"div",86)(20,"div")(21,"label",81),e.EFF(22,"Teams Count"),e.k0s(),e.j41(23,"input",87),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.createTournamentForm.teamCount=r)}),e.k0s()(),e.j41(24,"div")(25,"label",81),e.EFF(26,"Players per Team"),e.k0s(),e.j41(27,"input",88),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.createTournamentForm.playersPerTeam=r)}),e.k0s()()()(),e.j41(28,"div",89)(29,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTournamentModal())}),e.EFF(30," Cancel "),e.k0s(),e.j41(31,"button",91),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.createTournament())}),e.EFF(32),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(10),e.Y8G("ngModel",t.createTournamentForm.name),e.R7$(4),e.Y8G("ngModel",t.createTournamentForm.systemOfScoring),e.R7$(9),e.Y8G("ngModel",t.createTournamentForm.teamCount),e.R7$(4),e.Y8G("ngModel",t.createTournamentForm.playersPerTeam),e.R7$(4),e.Y8G("disabled",t.isCreatingTournament||!t.createTournamentForm.name.trim()),e.R7$(1),e.SpI(" ",t.isCreatingTournament?"Creating...":"Create Tournament"," ")}}function Nt(n,i){1&n&&(e.j41(0,"div",99),e.nrm(1,"div",100),e.k0s())}function St(n,i){1&n&&(e.j41(0,"div",101),e.EFF(1," No players available. Add players first. "),e.k0s())}function Rt(n,i){1&n&&(e.j41(0,"div",108),e.EFF(1," \u2713 Selected "),e.k0s())}function Dt(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",104),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.togglePlayerSelection(a.playerId))}),e.j41(1,"div",105),e.EFF(2),e.k0s(),e.j41(3,"div",106),e.EFF(4),e.k0s(),e.DNE(5,Rt,2,0,"div",107),e.k0s()}if(2&n){const t=i.$implicit,s=e.XpG(3);e.AVh("bg-blue-600",s.isPlayerSelected(t.playerId))("border-blue-500",s.isPlayerSelected(t.playerId))("bg-gray-700",!s.isPlayerSelected(t.playerId))("border-gray-600",!s.isPlayerSelected(t.playerId)),e.R7$(2),e.JRh(t.fullName),e.R7$(2),e.Lme(" Tournaments: ",t.multiParticipations," | Titles: ",t.multiTitlesWon," "),e.R7$(1),e.Y8G("ngIf",s.isPlayerSelected(t.playerId))}}function Et(n,i){if(1&n&&(e.j41(0,"div",102),e.DNE(1,Dt,6,12,"div",103),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.availablePlayers)}}function Gt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTeamModal())}),e.j41(1,"div",92),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTeamModal())}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"h2",80),e.EFF(5),e.k0s(),e.j41(6,"div",18)(7,"label",81),e.EFF(8,"Team Name"),e.k0s(),e.j41(9,"input",93),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.createTeamForm.teamName=r)}),e.k0s()(),e.j41(10,"div",18)(11,"label",94),e.EFF(12),e.k0s(),e.DNE(13,Nt,2,0,"div",95),e.DNE(14,St,2,0,"div",96),e.DNE(15,Et,2,1,"div",97),e.k0s(),e.j41(16,"div",89)(17,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeCreateTeamModal())}),e.EFF(18," Cancel "),e.k0s(),e.j41(19,"button",98),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.createTeam())}),e.EFF(20),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI(" Create Team for ",null==t.activeTournament?null:t.activeTournament.name," "),e.R7$(4),e.Y8G("ngModel",t.createTeamForm.teamName),e.R7$(3),e.Lme(" Select Players (",t.createTeamForm.playerIds.length,"/",null==t.activeTournament?null:t.activeTournament.playersPerTeam,") "),e.R7$(1),e.Y8G("ngIf",t.isLoadingPlayers),e.R7$(1),e.Y8G("ngIf",!t.isLoadingPlayers&&0===t.availablePlayers.length),e.R7$(1),e.Y8G("ngIf",!t.isLoadingPlayers&&t.availablePlayers.length>0),e.R7$(4),e.Y8G("disabled",t.isCreatingTeam||!t.createTeamForm.teamName.trim()||t.createTeamForm.playerIds.length!==(null==t.activeTournament?null:t.activeTournament.playersPerTeam)),e.R7$(1),e.SpI(" ",t.isCreatingTeam?"Creating...":"Create Team"," ")}}function $t(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showAddPlayerModal=!1)}),e.j41(1,"div",78),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showAddPlayerModal=!1)}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"h2",80),e.EFF(5,"Add New Player"),e.k0s(),e.j41(6,"input",109),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.newPlayerName=r)}),e.k0s(),e.j41(7,"div",89)(8,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showAddPlayerModal=!1)}),e.EFF(9," Cancel "),e.k0s(),e.j41(10,"button",110),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.addNewPlayer())}),e.EFF(11),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(6),e.Y8G("ngModel",t.newPlayerName),e.R7$(4),e.Y8G("disabled",t.isAddingPlayer||!t.newPlayerName.trim()),e.R7$(1),e.SpI(" ",t.isAddingPlayer?"Adding...":"Add Player"," ")}}function Vt(n,i){1&n&&(e.j41(0,"div",115),e.EFF(1," Classic System: Winner will be determined automatically based on scores "),e.k0s())}function Xt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeRecordResultModal())}),e.j41(1,"div",78),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeRecordResultModal())}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"h2",80),e.EFF(5,"Record Match Result"),e.k0s(),e.j41(6,"div",111)(7,"div")(8,"label",81),e.EFF(9),e.k0s(),e.j41(10,"input",112),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.recordingScore1=r)}),e.k0s()(),e.j41(11,"div")(12,"label",81),e.EFF(13),e.k0s(),e.j41(14,"input",112),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.recordingScore2=r)}),e.k0s()()(),e.DNE(15,Vt,2,0,"div",113),e.j41(16,"div",114)(17,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeRecordResultModal())}),e.EFF(18," Cancel "),e.k0s(),e.j41(19,"button",91),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.recordMatchResult())}),e.EFF(20),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(9),e.SpI("",t.getPlayerName(t.selectedPlayer1Id)," "),e.R7$(1),e.Y8G("ngModel",t.recordingScore1),e.R7$(3),e.SpI("",t.getPlayerName(t.selectedPlayer2Id)," "),e.R7$(1),e.Y8G("ngModel",t.recordingScore2),e.R7$(1),e.Y8G("ngIf","Classic"===(null==t.activeTournament?null:t.activeTournament.systemOfScoring)),e.R7$(4),e.Y8G("disabled",t.isRecordingResult||!t.recordingScore1.trim()||!t.recordingScore2.trim()),e.R7$(1),e.SpI(" ",t.isRecordingResult?"Recording...":"Record Result"," ")}}function Bt(n,i){1&n&&(e.qSk(),e.joV(),e.j41(0,"div",29),e.nrm(1,"div",30),e.k0s())}function At(n,i){if(1&n&&(e.j41(0,"div",132)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span",133),e.EFF(4,"-"),e.k0s(),e.j41(5,"span"),e.EFF(6),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.HbH((t.score1||0)>(t.score2||0)?"text-green-400":(t.score1||0)<(t.score2||0)?"text-red-400":"text-yellow-400"),e.R7$(1),e.SpI(" ",t.score1||0," "),e.R7$(3),e.HbH((t.score2||0)>(t.score1||0)?"text-green-400":(t.score2||0)<(t.score1||0)?"text-red-400":"text-yellow-400"),e.R7$(1),e.SpI(" ",t.score2||0," ")}}function Yt(n,i){if(1&n){const t=e.RV6();e.j41(0,"button",136),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2).$implicit,a=e.XpG(3);return e.Njj(a.openRecordResultModal(r))}),e.EFF(1," Record "),e.k0s()}}function Lt(n,i){if(1&n&&(e.j41(0,"div",134),e.EFF(1," Pending "),e.DNE(2,Yt,2,0,"button",135),e.k0s()),2&n){const t=e.XpG(4);e.R7$(2),e.Y8G("ngIf","Started"===(null==t.activeTournament?null:t.activeTournament.status))}}function Ot(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",137)(1,"button",138),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,a=e.XpG(3);return e.Njj(a.undoMatchResult(r))}),e.EFF(2," Undo "),e.k0s()()}}function Ut(n,i){if(1&n&&(e.j41(0,"div",123)(1,"div",124)(2,"div",125)(3,"span",126),e.EFF(4),e.k0s()(),e.j41(5,"div",127),e.DNE(6,At,7,6,"div",128),e.DNE(7,Lt,3,1,"div",129),e.k0s(),e.DNE(8,Ot,3,0,"div",130),e.j41(9,"div",131)(10,"span",126),e.EFF(11),e.k0s()()()()),2&n){const t=i.$implicit,s=e.XpG(3);e.R7$(4),e.JRh(t.player1Name),e.R7$(2),e.Y8G("ngIf",t.isCompleted),e.R7$(1),e.Y8G("ngIf",!t.isCompleted),e.R7$(1),e.Y8G("ngIf",t.isCompleted&&"Started"===(null==s.activeTournament?null:s.activeTournament.status)),e.R7$(3),e.JRh(t.player2Name)}}function zt(n,i){if(1&n&&(e.qSk(),e.joV(),e.j41(0,"div",31),e.DNE(1,Ut,12,5,"div",122),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.filteredPlayerMatches)}}function Jt(n,i){if(1&n&&(e.j41(0,"p",35),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.SpI(' No opponents found matching "',t.opponentSearchTerm,'" ')}}function Ht(n,i){1&n&&(e.j41(0,"p",35),e.EFF(1," No matches found for this player. "),e.k0s())}function Qt(n,i){if(1&n&&(e.qSk(),e.joV(),e.j41(0,"div",34),e.DNE(1,Jt,2,1,"p",76),e.DNE(2,Ht,2,0,"p",76),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.opponentSearchTerm&&""!==t.opponentSearchTerm.trim()),e.R7$(1),e.Y8G("ngIf",!t.opponentSearchTerm||""===t.opponentSearchTerm.trim())}}function qt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",116),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closePlayerMatchesModal())}),e.j41(1,"div",117),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closePlayerMatchesModal())}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"div",118)(5,"div",119)(6,"h3",120),e.EFF(7),e.k0s()(),e.j41(8,"div",18)(9,"div",19)(10,"input",121),e.bIt("ngModelChange",function(r){e.eBV(t);const a=e.XpG();return e.Njj(a.opponentSearchTerm=r)})("input",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.filterPlayerMatches())}),e.k0s(),e.j41(11,"div",21),e.qSk(),e.j41(12,"svg",22),e.nrm(13,"path",23),e.k0s()()()(),e.DNE(14,Bt,2,0,"div",14),e.DNE(15,zt,2,1,"div",15),e.DNE(16,Qt,3,2,"div",25),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(7),e.SpI(" Matches for ",null==t.selectedPlayer?null:t.selectedPlayer.fullName," "),e.R7$(3),e.Y8G("ngModel",t.opponentSearchTerm),e.R7$(4),e.Y8G("ngIf",t.isLoadingMatches),e.R7$(1),e.Y8G("ngIf",!t.isLoadingMatches&&t.filteredPlayerMatches.length>0),e.R7$(1),e.Y8G("ngIf",!t.isLoadingMatches&&0===t.filteredPlayerMatches.length)}}function Wt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",142),e.qSk(),e.j41(4,"svg",143),e.nrm(5,"path",144),e.k0s()(),e.joV(),e.j41(6,"h3",145),e.EFF(7,"\u062a\u0623\u0643\u064a\u062f \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629"),e.k0s(),e.j41(8,"p",11),e.EFF(9),e.k0s()(),e.j41(10,"div",114)(11,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeConfirmStartTournamentModal())}),e.EFF(12," \u0625\u0644\u063a\u0627\u0621 "),e.k0s(),e.j41(13,"button",146),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.confirmStartTournament())}),e.EFF(14," \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(9),e.SpI(' \u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "',null==t.tournamentToConfirm?null:t.tournamentToConfirm.name,'"\u061f ')}}function Zt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",147),e.qSk(),e.j41(4,"svg",148),e.nrm(5,"path",149),e.k0s()(),e.joV(),e.j41(6,"h3",145),e.EFF(7,"\u062a\u0623\u0643\u064a\u062f \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629"),e.k0s(),e.j41(8,"p",11),e.EFF(9),e.k0s()(),e.j41(10,"div",114)(11,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeConfirmFinishTournamentModal())}),e.EFF(12," \u0625\u0644\u063a\u0627\u0621 "),e.k0s(),e.j41(13,"button",150),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.confirmFinishTournament())}),e.EFF(14," \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(9),e.SpI(' \u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "',null==t.tournamentToConfirm?null:t.tournamentToConfirm.name,'"\u061f ')}}function Kt(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",151),e.qSk(),e.j41(4,"svg",152),e.nrm(5,"path",153),e.k0s()(),e.joV(),e.j41(6,"h3",145),e.EFF(7,"\u062a\u0623\u0643\u064a\u062f \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629"),e.k0s(),e.j41(8,"p",154),e.EFF(9),e.k0s(),e.j41(10,"p",155),e.EFF(11," \u26a0\ufe0f \u0633\u064a\u062a\u0645 \u062d\u0630\u0641 \u0643\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u0629 \u0628\u0647\u0627 \u0646\u0647\u0627\u0626\u064a\u0627\u064b "),e.k0s()(),e.j41(12,"div",114)(13,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeConfirmDeleteTournamentModal())}),e.EFF(14," \u0625\u0644\u063a\u0627\u0621 "),e.k0s(),e.j41(15,"button",156),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.confirmDeleteTournament())}),e.EFF(16," \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(9),e.SpI(' \u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 "',null==t.tournamentToConfirm?null:t.tournamentToConfirm.name,'"\u061f ')}}function er(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",157),e.qSk(),e.j41(4,"svg",158),e.nrm(5,"path",159),e.k0s()(),e.joV(),e.j41(6,"h3",145),e.EFF(7,"\u062a\u0623\u0643\u064a\u062f \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0646\u062a\u064a\u062c\u0629"),e.k0s(),e.j41(8,"p",154),e.EFF(9," \u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0644\u063a\u0627\u0621 \u0646\u062a\u064a\u062c\u0629 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629\u061f "),e.k0s(),e.j41(10,"div",160)(11,"p"),e.EFF(12),e.k0s(),e.j41(13,"p"),e.EFF(14),e.k0s()(),e.j41(15,"div",114)(16,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeConfirmUndoMatchModal())}),e.EFF(17," \u0625\u0644\u063a\u0627\u0621 "),e.k0s(),e.j41(18,"button",161),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.confirmUndoMatchResult())}),e.EFF(19," \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0646\u062a\u064a\u062c\u0629 "),e.k0s()()()()()}if(2&n){const t=e.XpG();e.R7$(12),e.Lme("",null==t.matchToUndo?null:t.matchToUndo.player1Name," vs ",null==t.matchToUndo?null:t.matchToUndo.player2Name,""),e.R7$(2),e.Lme("\u0627\u0644\u0646\u062a\u064a\u062c\u0629: ",null==t.matchToUndo?null:t.matchToUndo.score1," - ",null==t.matchToUndo?null:t.matchToUndo.score2,"")}}function tr(n,i){1&n&&(e.j41(0,"div",166),e.EFF(1," \u2713 Selected for Replacement "),e.k0s())}function rr(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",104),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectPlayerToReplace(a.playerId))}),e.j41(1,"div",105),e.EFF(2),e.k0s(),e.j41(3,"div",106),e.EFF(4),e.k0s(),e.DNE(5,tr,2,0,"div",165),e.k0s()}if(2&n){const t=i.$implicit,s=e.XpG(2);e.AVh("bg-red-600",s.replacePlayerForm.replacedPlayerId===t.playerId)("border-red-500",s.replacePlayerForm.replacedPlayerId===t.playerId)("bg-gray-700",s.replacePlayerForm.replacedPlayerId!==t.playerId)("border-gray-600",s.replacePlayerForm.replacedPlayerId!==t.playerId),e.R7$(2),e.JRh(t.fullName),e.R7$(2),e.Lme(" Tournaments: ",t.multiParticipations," | Titles: ",t.multiTitlesWon," "),e.R7$(1),e.Y8G("ngIf",s.replacePlayerForm.replacedPlayerId===t.playerId)}}function sr(n,i){1&n&&(e.j41(0,"div",99),e.nrm(1,"div",100),e.k0s())}function nr(n,i){1&n&&(e.j41(0,"div",101),e.EFF(1," No available players for replacement. "),e.k0s())}function ar(n,i){1&n&&(e.j41(0,"div",108),e.EFF(1," \u2713 Selected as Replacement "),e.k0s())}function ir(n,i){if(1&n){const t=e.RV6();e.j41(0,"div",104),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.selectNewPlayer(a.playerId))}),e.j41(1,"div",105),e.EFF(2),e.k0s(),e.j41(3,"div",106),e.EFF(4),e.k0s(),e.DNE(5,ar,2,0,"div",107),e.k0s()}if(2&n){const t=i.$implicit,s=e.XpG(3);e.AVh("bg-blue-600",s.replacePlayerForm.newPlayerId===t.playerId)("border-blue-500",s.replacePlayerForm.newPlayerId===t.playerId)("bg-gray-700",s.replacePlayerForm.newPlayerId!==t.playerId)("border-gray-600",s.replacePlayerForm.newPlayerId!==t.playerId),e.R7$(2),e.JRh(t.fullName),e.R7$(2),e.Lme(" Tournaments: ",t.multiParticipations," | Titles: ",t.multiTitlesWon," "),e.R7$(1),e.Y8G("ngIf",s.replacePlayerForm.newPlayerId===t.playerId)}}function or(n,i){if(1&n&&(e.j41(0,"div",102),e.DNE(1,ir,6,12,"div",103),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.availablePlayersForReplacement)}}const lr=function(){return[]};function cr(n,i){if(1&n){const t=e.RV6();e.qSk(),e.joV(),e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeReplacePlayerModal())}),e.j41(1,"div",92),e.bIt("click",function(r){return r.stopPropagation()}),e.j41(2,"button",79),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeReplacePlayerModal())}),e.EFF(3," Exit \xd7 "),e.k0s(),e.j41(4,"h2",80),e.EFF(5),e.k0s(),e.j41(6,"div",18)(7,"label",94),e.EFF(8," Select Player to Replace "),e.k0s(),e.j41(9,"div",162),e.DNE(10,rr,6,12,"div",163),e.k0s()(),e.j41(11,"div",18)(12,"label",94),e.EFF(13," Select New Player "),e.k0s(),e.DNE(14,sr,2,0,"div",95),e.DNE(15,nr,2,0,"div",96),e.DNE(16,or,2,1,"div",97),e.k0s(),e.j41(17,"div",89)(18,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeReplacePlayerModal())}),e.EFF(19," Cancel "),e.k0s(),e.j41(20,"button",164),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.replacePlayer())}),e.EFF(21),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI(" Replace Player in ",null==t.selectedTeamForReplacement?null:t.selectedTeamForReplacement.teamName," "),e.R7$(5),e.Y8G("ngForOf",(null==t.selectedTeamForReplacement?null:t.selectedTeamForReplacement.players)||e.lJ4(7,lr)),e.R7$(4),e.Y8G("ngIf",t.isLoadingPlayers),e.R7$(1),e.Y8G("ngIf",!t.isLoadingPlayers&&0===t.availablePlayersForReplacement.length),e.R7$(1),e.Y8G("ngIf",!t.isLoadingPlayers&&t.availablePlayersForReplacement.length>0),e.R7$(4),e.Y8G("disabled",t.isReplacingPlayer||!t.replacePlayerForm.replacedPlayerId||!t.replacePlayerForm.newPlayerId),e.R7$(1),e.SpI(" ",t.isReplacingPlayer?"Replacing...":"Replace Player"," ")}}const dr=[{path:"",component:x,data:{title:"Players"}},{path:"players",component:x,data:{title:"Admin Dashboard"}},{path:"inbox",component:pe,data:{title:"Inbox"}},{path:"friendlies",component:ze,data:{title:"Friendlies"}},{path:"friendly-inbox",component:it,data:{title:"Friendly Inbox"}},{path:"teams-dashboard",component:(()=>{class n{constructor(t,s){this.multiTournamentService=t,this.toastr=s,this.tournaments=[],this.activeTournament=null,this.availablePlayers=[],this.availablePlayersForReplacement=[],this.filteredPlayers=[],this.tournamentMatches=[],this.filteredPlayerMatches=[],this.selectedPlayer=null,this.showCreateTournamentModal=!1,this.showCreateTeamModal=!1,this.showAddPlayerModal=!1,this.showRecordResultModal=!1,this.showPlayerMatchesModal=!1,this.showReplacePlayerModal=!1,this.showConfirmStartTournamentModal=!1,this.showConfirmFinishTournamentModal=!1,this.showConfirmDeleteTournamentModal=!1,this.showConfirmUndoMatchModal=!1,this.tournamentToConfirm=null,this.matchToUndo=null,this.selectedTeamForReplacement=null,this.createTournamentForm={name:"",systemOfScoring:"Classic",teamCount:4,playersPerTeam:3},this.createTeamForm={teamName:"",playerIds:[]},this.replacePlayerForm={replacedPlayerId:0,newPlayerId:0},this.newPlayerName="",this.playerSearchTerm="",this.opponentSearchTerm="",this.selectedMatchId=null,this.selectedPlayer1Id=null,this.selectedPlayer2Id=null,this.recordingScore1="",this.recordingScore2="",this.isLoadingTournaments=!1,this.isLoadingPlayers=!1,this.isLoadingMatches=!1,this.isCreatingTournament=!1,this.isCreatingTeam=!1,this.isAddingPlayer=!1,this.isRecordingResult=!1,this.isReplacingPlayer=!1}ngOnInit(){this.loadTournaments(),this.loadAvailablePlayers()}loadTournaments(){this.isLoadingTournaments=!0,this.multiTournamentService.getAllTournaments().subscribe({next:t=>{t.success&&t.data&&(this.tournaments=t.data,this.activeTournament=this.tournaments.find(s=>s.isActive)||null,this.activeTournament&&this.loadTournamentMatches()),this.isLoadingTournaments=!1},error:t=>{console.error("Error loading tournaments:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u0637\u0648\u0644\u0627\u062a","\u062e\u0637\u0623"),this.isLoadingTournaments=!1}})}createTournament(){this.createTournamentForm.name.trim()?(this.isCreatingTournament=!0,this.multiTournamentService.createTournament(this.createTournamentForm).subscribe({next:t=>{t.success?(this.toastr.success("\u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.closeCreateTournamentModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623"),this.isCreatingTournament=!1},error:t=>{console.error("Error creating tournament:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623"),this.isCreatingTournament=!1}})):this.toastr.warning("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062a\u062d\u0630\u064a\u0631")}openCreateTournamentModal(){this.createTournamentForm={name:"",systemOfScoring:"Classic",teamCount:4,playersPerTeam:3},this.showCreateTournamentModal=!0}closeCreateTournamentModal(){this.showCreateTournamentModal=!1}getRemainingTeams(t){return t.teamCount-t.teams.length}canStartTournament(t){return"Created"===t.status&&t.teams.length===t.teamCount}getStatusColor(t){switch(t){case"Created":return"text-yellow-400";case"Started":return"text-green-400";case"Finished":return"text-blue-400";default:return"text-gray-400"}}loadAvailablePlayers(){this.isLoadingPlayers=!0,this.multiTournamentService.getAllPlayers().subscribe({next:t=>{t.success&&t.data&&(this.availablePlayers=t.data.filter(s=>s.isActive),this.filteredPlayers=[...this.availablePlayers]),this.isLoadingPlayers=!1},error:t=>{console.error("Error loading players:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062e\u0637\u0623"),this.isLoadingPlayers=!1}})}loadTournamentMatches(){this.activeTournament&&(this.isLoadingMatches=!0,this.multiTournamentService.getActiveTournamentMatches().subscribe({next:t=>{t.success&&t.data&&(this.tournamentMatches=t.data,this.selectedPlayer&&(this.filteredPlayerMatches=this.getPlayerMatches(this.selectedPlayer.playerId||0))),this.isLoadingMatches=!1},error:t=>{console.error("Error loading tournament matches:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0628\u0627\u0631\u064a\u0627\u062a","\u062e\u0637\u0623"),this.isLoadingMatches=!1}}))}startTournament(t){this.openConfirmStartTournamentModal(t)}confirmStartTournament(){this.tournamentToConfirm&&this.multiTournamentService.startTournament(this.tournamentToConfirm.multiTournamentId).subscribe({next:t=>{t.success?(this.toastr.success("\u062a\u0645 \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.closeConfirmStartTournamentModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")},error:t=>{console.error("Error starting tournament:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0628\u062f\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")}})}finishTournament(t){this.openConfirmFinishTournamentModal(t)}confirmFinishTournament(){this.tournamentToConfirm&&this.multiTournamentService.finishTournament(this.tournamentToConfirm.multiTournamentId).subscribe({next:t=>{t.success?(this.toastr.success("\u062a\u0645 \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.closeConfirmFinishTournamentModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")},error:t=>{console.error("Error finishing tournament:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0625\u0646\u0647\u0627\u0621 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")}})}deleteTournament(t){this.openConfirmDeleteTournamentModal(t)}confirmDeleteTournament(){this.tournamentToConfirm&&this.multiTournamentService.deleteTournament(this.tournamentToConfirm.multiTournamentId).subscribe({next:t=>{t.success?(this.toastr.success("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.closeConfirmDeleteTournamentModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")},error:t=>{console.error("Error deleting tournament:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u0628\u0637\u0648\u0644\u0629","\u062e\u0637\u0623")}})}createTeam(){this.createTeamForm.teamName.trim()?this.createTeamForm.playerIds.length===(this.activeTournament?.playersPerTeam||3)?this.activeTournament&&(this.isCreatingTeam=!0,this.multiTournamentService.createTeam(this.activeTournament.multiTournamentId,this.createTeamForm).subscribe({next:t=>{t.success?(this.toastr.success(`\u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0641\u0631\u064a\u0642 "${this.createTeamForm.teamName}" \u0628\u0646\u062c\u0627\u062d`,"\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.closeCreateTeamModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0641\u0631\u064a\u0642","\u062e\u0637\u0623"),this.isCreatingTeam=!1},error:t=>{console.error("Error creating team:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0641\u0631\u064a\u0642","\u062e\u0637\u0623"),this.isCreatingTeam=!1}})):this.toastr.warning(`\u064a\u062c\u0628 \u0627\u062e\u062a\u064a\u0627\u0631 ${this.activeTournament?.playersPerTeam} \u0644\u0627\u0639\u0628\u064a\u0646 \u0628\u0627\u0644\u0636\u0628\u0637`,"\u062a\u062d\u0630\u064a\u0631"):this.toastr.warning("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u064a\u0642","\u062a\u062d\u0630\u064a\u0631")}addNewPlayer(){this.newPlayerName.trim()?(this.isAddingPlayer=!0,this.multiTournamentService.addNewPlayer({fullName:this.newPlayerName.trim()}).subscribe({next:t=>{t.success?(this.toastr.success(`\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628 ${this.newPlayerName} \u0628\u0646\u062c\u0627\u062d`,"\u0646\u062c\u0627\u062d"),this.loadAvailablePlayers(),this.showAddPlayerModal=!1,this.newPlayerName=""):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623"),this.isAddingPlayer=!1},error:t=>{console.error("Error adding player:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0644\u0627\u0639\u0628","\u062e\u0637\u0623"),this.isAddingPlayer=!1}})):this.toastr.warning("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0644\u0627\u0639\u0628","\u062a\u062d\u0630\u064a\u0631")}togglePlayerSelection(t){const s=this.createTeamForm.playerIds.indexOf(t);-1===s?this.createTeamForm.playerIds.length<(this.activeTournament?.playersPerTeam||3)?this.createTeamForm.playerIds.push(t):this.toastr.warning(`\u064a\u0645\u0643\u0646 \u0627\u062e\u062a\u064a\u0627\u0631 ${this.activeTournament?.playersPerTeam} \u0644\u0627\u0639\u0628\u064a\u0646 \u0641\u0642\u0637`,"\u062a\u062d\u0630\u064a\u0631"):this.createTeamForm.playerIds.splice(s,1)}isPlayerSelected(t){return this.createTeamForm.playerIds.includes(t)}recordMatchResult(){if(!this.selectedMatchId||!this.activeTournament)return;if(!this.recordingScore1.trim()||!this.recordingScore2.trim())return void this.toastr.warning("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0627\u0644\u0646\u062a\u064a\u062c\u0629 \u0644\u0644\u0627\u0639\u0628\u064a\u0646","\u062a\u062d\u0630\u064a\u0631");const t=parseFloat(this.recordingScore1),s=parseFloat(this.recordingScore2);if(isNaN(t)||isNaN(s))return void this.toastr.warning("\u064a\u0631\u062c\u0649 \u0625\u062f\u062e\u0627\u0644 \u0623\u0631\u0642\u0627\u0645 \u0635\u062d\u064a\u062d\u0629","\u062a\u062d\u0630\u064a\u0631");let r={};"Classic"===this.activeTournament.systemOfScoring?r.winnerId=t>s?this.selectedPlayer1Id:s>t?this.selectedPlayer2Id:null:(r.score1=t,r.score2=s),this.isRecordingResult=!0,this.multiTournamentService.recordMatchResult(this.selectedMatchId,r).subscribe({next:a=>{a.success?(this.toastr.success("\u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u0646\u062a\u064a\u062c\u0629 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.loadTournamentMatches(),this.closeRecordResultModal()):this.toastr.error(a.message||"\u0641\u0634\u0644 \u0641\u064a \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0646\u062a\u064a\u062c\u0629","\u062e\u0637\u0623"),this.isRecordingResult=!1},error:a=>{console.error("Error recording match result:",a),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u062a\u0633\u062c\u064a\u0644 \u0646\u062a\u064a\u062c\u0629 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623"),this.isRecordingResult=!1}})}undoMatchResult(t){this.openConfirmUndoMatchModal(t)}confirmUndoMatchResult(){this.matchToUndo&&this.multiTournamentService.undoMatchResult(this.matchToUndo.multiMatchId).subscribe({next:t=>{t.success?(this.toastr.success("\u062a\u0645 \u0625\u0644\u063a\u0627\u0621 \u0646\u062a\u064a\u062c\u0629 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0628\u0646\u062c\u0627\u062d","\u0646\u062c\u0627\u062d"),this.loadTournaments(),this.loadTournamentMatches(),this.closeConfirmUndoMatchModal()):this.toastr.error(t.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0646\u062a\u064a\u062c\u0629","\u062e\u0637\u0623")},error:t=>{console.error("Error undoing match result:",t),this.toastr.error("\u062e\u0637\u0623 \u0641\u064a \u0625\u0644\u063a\u0627\u0621 \u0646\u062a\u064a\u062c\u0629 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629","\u062e\u0637\u0623")}})}openCreateTeamModal(t){this.activeTournament=t,this.createTeamForm={teamName:"",playerIds:[]},this.showCreateTeamModal=!0}closeCreateTeamModal(){this.showCreateTeamModal=!1,this.activeTournament=null}closeRecordResultModal(){this.showRecordResultModal=!1,this.selectedMatchId=null,this.selectedPlayer1Id=null,this.selectedPlayer2Id=null,this.recordingScore1="",this.recordingScore2=""}openConfirmStartTournamentModal(t){this.tournamentToConfirm=t,this.showConfirmStartTournamentModal=!0}closeConfirmStartTournamentModal(){this.showConfirmStartTournamentModal=!1,this.tournamentToConfirm=null}openConfirmFinishTournamentModal(t){this.tournamentToConfirm=t,this.showConfirmFinishTournamentModal=!0}closeConfirmFinishTournamentModal(){this.showConfirmFinishTournamentModal=!1,this.tournamentToConfirm=null}openConfirmDeleteTournamentModal(t){this.tournamentToConfirm=t,this.showConfirmDeleteTournamentModal=!0}closeConfirmDeleteTournamentModal(){this.showConfirmDeleteTournamentModal=!1,this.tournamentToConfirm=null}openConfirmUndoMatchModal(t){this.matchToUndo=t,this.showConfirmUndoMatchModal=!0}closeConfirmUndoMatchModal(){this.showConfirmUndoMatchModal=!1,this.matchToUndo=null}getTrophyIcon(t){switch(t){case 1:return"\u{1f947}";case 2:return"\u{1f948}";case 3:return"\u{1f949}";default:return""}}canFinishTournament(t){return"Started"===t.status}canDeleteTournament(t){return"Created"===t.status}openRecordResultModal(t){this.selectedMatchId=t.multiMatchId,this.selectedPlayer1Id=t.player1Id,this.selectedPlayer2Id=t.player2Id,this.recordingScore1="",this.recordingScore2="",this.showRecordResultModal=!0,this.showPlayerMatchesModal=!1}closePlayerMatchesModal(){this.showPlayerMatchesModal=!1,this.selectedPlayer=null}selectPlayer(t){this.selectedPlayer=t,this.opponentSearchTerm="",this.showPlayerMatchesModal=!0,this.loadTournamentMatches()}getPlayerMatches(t){if(!this.tournamentMatches||0===this.tournamentMatches.length)return[];const s=[];return this.tournamentMatches.forEach(r=>{r.matches.forEach(a=>{(a.player1Id===t||a.player2Id===t)&&s.push(a)})}),s}getPlayerName(t){if(!t)return"Unknown Player";const s=this.availablePlayers.find(r=>r.playerId===t);return s?s.fullName:"Unknown Player"}getTeamPlayersNames(t){return t.players&&0!==t.players.length?t.players.map(s=>s.fullName):["No players"]}filterPlayers(){if(this.playerSearchTerm&&""!==this.playerSearchTerm.trim()){const t=this.playerSearchTerm.trim();this.filteredPlayers=this.availablePlayers.filter(s=>s.fullName.toLowerCase().includes(t.toLowerCase()))}else this.filteredPlayers=[...this.availablePlayers]}filterPlayerMatches(){if(!this.selectedPlayer)return;const t=this.getPlayerMatches(this.selectedPlayer.playerId||0);if(this.opponentSearchTerm&&""!==this.opponentSearchTerm.trim()){const s=this.opponentSearchTerm.trim();this.filteredPlayerMatches=t.filter(r=>{const a=r.player1Name?.toLowerCase()||"",o=r.player2Name?.toLowerCase()||"",c=s.toLowerCase();return r.player1Id===this.selectedPlayer?.playerId?o.includes(c):r.player2Id===this.selectedPlayer?.playerId&&a.includes(c)})}else this.filteredPlayerMatches=t}openReplacePlayerModal(t){console.log("\u{1f50d} openReplacePlayerModal called with team:",t),this.selectedTeamForReplacement=t,this.replacePlayerForm={replacedPlayerId:0,newPlayerId:0},this.loadAvailablePlayersForReplacement(t),this.showReplacePlayerModal=!0,console.log("\u{1f50d} showReplacePlayerModal set to:",this.showReplacePlayerModal)}closeReplacePlayerModal(){this.showReplacePlayerModal=!1,this.selectedTeamForReplacement=null,this.replacePlayerForm={replacedPlayerId:0,newPlayerId:0}}loadAvailablePlayersForReplacement(t){if(!t.players)return;const s=t.players.map(r=>r.playerId);this.availablePlayersForReplacement=this.availablePlayers.filter(r=>!(s.includes(r.playerId)||this.activeTournament&&this.activeTournament.teams.some(o=>o.multiTeamId!==t.multiTeamId&&o.players.some(c=>c.playerId===r.playerId))))}selectPlayerToReplace(t){this.replacePlayerForm.replacedPlayerId=t}selectNewPlayer(t){this.replacePlayerForm.newPlayerId=t}replacePlayer(){!this.selectedTeamForReplacement||!this.replacePlayerForm.replacedPlayerId||!this.replacePlayerForm.newPlayerId||(this.isReplacingPlayer=!0,this.multiTournamentService.replacePlayer(this.selectedTeamForReplacement.multiTeamId,{replacedPlayerId:this.replacePlayerForm.replacedPlayerId,newPlayerId:this.replacePlayerForm.newPlayerId}).subscribe({next:t=>{t.success?(this.toastr.success("Player replaced successfully!"),this.closeReplacePlayerModal(),this.loadTournaments()):this.toastr.error(t.message||"Failed to replace player")},error:t=>{console.error("Error replacing player:",t),this.toastr.error("An error occurred while replacing the player")},complete:()=>{this.isReplacingPlayer=!1}}))}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(ot.y),e.rXU(f.tw))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-teams-dashboard"]],decls:52,vars:20,consts:[[1,"md:container","mx-auto"],[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-white","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-green-600","text-white","p-4","rounded-lg","hover:bg-green-700","transition-all",3,"click"],[1,"text-lg","font-bold"],[1,"text-sm"],[1,"bg-purple-600","text-white","p-4","rounded-lg","hover:bg-purple-700","transition-all",3,"click"],[1,"bg-gray-700","p-4","rounded-lg"],[1,"text-lg","font-bold","text-white"],[1,"text-sm","text-gray-300"],[1,"bg-blue-700","p-4","rounded-lg"],["class","text-sm text-gray-300",4,"ngIf"],["class","flex justify-center py-8",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"mt-8"],[1,"text-xl","font-semibold","text-white","mb-4"],[1,"mb-4"],[1,"relative"],["type","text","placeholder","Search players by name...",1,"w-full","px-4","py-2","pl-10","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModel","ngModelChange","input"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["class","grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50",3,"click",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",3,"click",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50",4,"ngIf"],[1,"flex","justify-center","py-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"space-y-4"],[1,"text-xl","font-semibold","text-white"],["class","grid grid-cols-1 lg:grid-cols-1 gap-6",4,"ngIf"],[1,"text-center","py-8"],[1,"text-gray-400"],[1,"grid","grid-cols-1","lg:grid-cols-1","gap-6"],["class","bg-black bg-opacity-50 rounded-lg p-6 border border-gray-700",4,"ngFor","ngForOf"],[1,"bg-black","bg-opacity-50","rounded-lg","p-6","border","border-gray-700"],[1,"flex","justify-between","items-start","mb-4"],[1,"text-xl","font-bold","text-white","mb-2"],[1,"flex","items-center","space-x-4","text-sm"],[1,"text-gray-300"],[1,"flex","flex-wrap","gap-2","mb-4"],["class","bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all",3,"click",4,"ngIf"],["class","bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm transition-all",3,"click",4,"ngIf"],["class","bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded text-sm transition-all",3,"click",4,"ngIf"],["class","bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm transition-all",3,"click",4,"ngIf"],["class","mb-4",4,"ngIf"],["class","text-center py-4",4,"ngIf"],[1,"mt-4","pt-4","border-t","border-gray-700"],[1,"flex","justify-between","text-sm","text-gray-400"],[1,"w-full","bg-gray-700","rounded-full","h-2","mt-1"],[1,"bg-blue-600","h-2","rounded-full","transition-all","duration-300"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded","text-sm","transition-all",3,"click"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded","text-sm","transition-all",3,"click"],[1,"bg-yellow-600","hover:bg-yellow-700","text-white","px-4","py-2","rounded","text-sm","transition-all",3,"click"],[1,"bg-red-600","hover:bg-red-700","text-white","px-4","py-2","rounded","text-sm","transition-all",3,"click"],[1,"text-lg","font-semibold","text-white","mb-3"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-6"],["class","bg-black bg-opacity-80 rounded p-3",4,"ngFor","ngForOf"],[1,"bg-black","bg-opacity-80","rounded","p-3"],[1,"font-medium","text-white","mb-2","text-center"],[1,"text-sm","text-gray-300","grid","grid-cols-3","gap-2","mb-3"],["class","px-2 py-2 text-center items-center justify-center flex bg-black bg-opacity-50 border border-gray-600 rounded-full text-white text-xs",4,"ngFor","ngForOf"],[1,"flex","justify-center"],["class","bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 rounded text-xs transition-all","title","Replace Player",3,"click",4,"ngIf"],[1,"px-2","py-2","text-center","items-center","justify-center","flex","bg-black","bg-opacity-50","border","border-gray-600","rounded-full","text-white","text-xs"],["title","Replace Player",1,"bg-orange-600","hover:bg-orange-700","text-white","px-3","py-1","rounded","text-xs","transition-all",3,"click"],[1,"text-center","py-4"],[1,"text-sm","text-gray-500"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],["class","bg-black bg-opacity-50 p-4 rounded-lg cursor-pointer hover:bg-gray-400 transition-all border-2 border-gray-600",3,"click",4,"ngFor","ngForOf"],[1,"bg-black","bg-opacity-50","p-4","rounded-lg","cursor-pointer","hover:bg-gray-400","transition-all","border-2","border-gray-600",3,"click"],[1,"text-center"],[1,"text-base","font-bold","text-white"],["class","text-gray-400",4,"ngIf"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-75","z-50",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","max-w-md","w-full","mx-4","relative",3,"click"],[1,"absolute","top-4","right-5","z-10","p-2","text-gray-100","hover:text-white","text-lg","font-bold","transition-colors","bg-gray-800","bg-opacity-70","rounded-full","h-8","flex","items-center","justify-center",3,"click"],[1,"text-lg","font-bold","mb-4","text-white"],[1,"block","text-sm","font-medium","mb-1","text-gray-300"],["type","text","placeholder","Enter tournament name",1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded",3,"ngModel","ngModelChange"],["value","Classic"],["value","Points"],[1,"grid","grid-cols-2","gap-4"],["type","number","min","2","max","16",1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded",3,"ngModel","ngModelChange"],["type","number","min","1","max","10",1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded",3,"ngModel","ngModelChange"],[1,"flex","justify-end","space-x-4","mt-6"],[1,"bg-gray-600","px-4","py-2","text-white","rounded","hover:bg-gray-700","transition",3,"click"],[1,"bg-green-600","px-4","py-2","text-white","rounded","hover:bg-green-700","transition","disabled:opacity-50",3,"disabled","click"],[1,"bg-gray-800","p-6","rounded-lg","max-w-2xl","w-full","mx-4","max-h-[90vh]","overflow-y-auto","relative",3,"click"],["type","text","placeholder","Enter team name",1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"block","text-sm","font-medium","mb-2","text-gray-300"],["class","flex justify-center py-4",4,"ngIf"],["class","text-center py-4 text-gray-400",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto",4,"ngIf"],[1,"bg-blue-600","px-4","py-2","text-white","rounded","hover:bg-blue-700","transition","disabled:opacity-50",3,"disabled","click"],[1,"flex","justify-center","py-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"text-center","py-4","text-gray-400"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2","max-h-60","overflow-y-auto"],["class","p-3 rounded border cursor-pointer transition-all",3,"bg-blue-600","border-blue-500","bg-gray-700","border-gray-600","click",4,"ngFor","ngForOf"],[1,"p-3","rounded","border","cursor-pointer","transition-all",3,"click"],[1,"text-white","font-medium"],[1,"text-xs","text-gray-300"],["class","text-blue-200 text-xs mt-1",4,"ngIf"],[1,"text-blue-200","text-xs","mt-1"],["type","text","placeholder","Enter player name",1,"border","border-gray-600","p-2","w-full","bg-gray-700","text-white","rounded","placeholder-gray-400",3,"ngModel","ngModelChange"],[1,"bg-purple-600","px-4","py-2","text-white","rounded","hover:bg-purple-700","transition","disabled:opacity-50",3,"disabled","click"],[1,"grid","grid-cols-2","gap-4","mb-4"],["type","text","placeholder","Enter score",1,"w-full","px-3","py-2","border","border-gray-600","bg-gray-700","text-white","rounded",3,"ngModel","ngModelChange"],["class","mb-4 text-xs text-gray-400",4,"ngIf"],[1,"flex","justify-end","space-x-4"],[1,"mb-4","text-xs","text-gray-400"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-black","bg-opacity-50","rounded-lg","w-full","max-w-4xl","max-h-[90vh]","overflow-hidden","relative",3,"click"],[1,"p-6","overflow-y-auto",2,"max-height","calc(90vh - 2rem)"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-white"],["type","text","placeholder","Search opponents by name...",1,"w-full","px-4","py-2","pl-10","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModel","ngModelChange","input"],["class","bg-black bg-opacity-50 rounded-lg p-4",4,"ngFor","ngForOf"],[1,"bg-black","bg-opacity-50","rounded-lg","p-4"],[1,"flex","justify-between","items-center"],[1,"flex-1"],[1,"text-white","font-semibold"],[1,"px-4","text-center"],["class","font-bold text-lg",4,"ngIf"],["class","text-gray-400 text-sm",4,"ngIf"],["class","ml-2",4,"ngIf"],[1,"flex-1","text-right"],[1,"font-bold","text-lg"],[1,"text-white","mx-2"],[1,"text-gray-400","text-sm"],["class","ml-2 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs transition-all",3,"click",4,"ngIf"],[1,"ml-2","bg-green-600","hover:bg-green-700","text-white","px-2","py-1","rounded","text-xs","transition-all",3,"click"],[1,"ml-2"],[1,"bg-red-600","hover:bg-red-700","text-white","px-2","py-1","rounded","text-xs","transition-all",3,"click"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-75","z-50"],[1,"bg-gray-800","p-6","rounded-lg","max-w-md","w-full","mx-4"],[1,"text-center","mb-6"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-green-100","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-lg","font-medium","text-white","mb-2"],[1,"bg-green-600","px-4","py-2","text-white","rounded","hover:bg-green-700","transition",3,"click"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-yellow-100","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-yellow-600","px-4","py-2","text-white","rounded","hover:bg-yellow-700","transition",3,"click"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-sm","text-gray-300","mb-4"],[1,"text-xs","text-red-400"],[1,"bg-red-600","px-4","py-2","text-white","rounded","hover:bg-red-700","transition",3,"click"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-orange-100","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-xs","text-gray-400","bg-gray-700","p-3","rounded"],[1,"bg-orange-600","px-4","py-2","text-white","rounded","hover:bg-orange-700","transition",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2","mb-4"],["class","p-3 rounded border cursor-pointer transition-all",3,"bg-red-600","border-red-500","bg-gray-700","border-gray-600","click",4,"ngFor","ngForOf"],[1,"bg-orange-600","px-4","py-2","text-white","rounded","hover:bg-orange-700","transition","disabled:opacity-50",3,"disabled","click"],["class","text-red-200 text-xs mt-1",4,"ngIf"],[1,"text-red-200","text-xs","mt-1"]],template:function(s,r){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4," Teams Tournament Management "),e.k0s(),e.j41(5,"div",4)(6,"button",5),e.bIt("click",function(){return r.openCreateTournamentModal()}),e.j41(7,"h3",6),e.EFF(8,"Create Tournament"),e.k0s(),e.j41(9,"p",7),e.EFF(10,"Create a new teams tournament"),e.k0s()(),e.j41(11,"button",8),e.bIt("click",function(){return r.showAddPlayerModal=!0}),e.j41(12,"h3",6),e.EFF(13,"Add Player"),e.k0s(),e.j41(14,"p",7),e.EFF(15,"Add new player to the pool"),e.k0s()(),e.j41(16,"div",9)(17,"h3",10),e.EFF(18,"Statistics"),e.k0s(),e.j41(19,"p",11),e.EFF(20),e.k0s(),e.j41(21,"p",11),e.EFF(22),e.k0s()(),e.j41(23,"div",12)(24,"h3",10),e.EFF(25,"Active Tournament"),e.k0s(),e.DNE(26,lt,2,1,"p",13),e.DNE(27,ct,2,0,"p",13),e.k0s()()(),e.DNE(28,dt,2,0,"div",14),e.DNE(29,Ct,5,2,"div",15),e.j41(30,"div",16)(31,"h3",17),e.EFF(32,"Tournament Players"),e.k0s(),e.j41(33,"div",18)(34,"div",19)(35,"input",20),e.bIt("ngModelChange",function(o){return r.playerSearchTerm=o})("input",function(){return r.filterPlayers()}),e.k0s(),e.j41(36,"div",21),e.qSk(),e.j41(37,"svg",22),e.nrm(38,"path",23),e.k0s()()()(),e.DNE(39,kt,2,0,"div",14),e.DNE(40,Mt,2,1,"div",24),e.DNE(41,It,3,2,"div",25),e.k0s()(),e.DNE(42,wt,33,6,"div",26),e.DNE(43,Gt,21,9,"div",26),e.DNE(44,$t,12,3,"div",26),e.DNE(45,Xt,21,7,"div",26),e.DNE(46,qt,17,5,"div",27),e.k0s(),e.DNE(47,Wt,15,1,"div",28),e.DNE(48,Zt,15,1,"div",28),e.DNE(49,Kt,17,1,"div",28),e.DNE(50,er,20,4,"div",28),e.DNE(51,cr,22,8,"div",26)),2&s&&(e.R7$(20),e.SpI(" Tournaments: ",r.tournaments.length," "),e.R7$(2),e.SpI(" Available Players: ",r.availablePlayers.length," "),e.R7$(4),e.Y8G("ngIf",r.activeTournament),e.R7$(1),e.Y8G("ngIf",!r.activeTournament),e.R7$(1),e.Y8G("ngIf",r.isLoadingTournaments),e.R7$(1),e.Y8G("ngIf",!r.isLoadingTournaments),e.R7$(6),e.Y8G("ngModel",r.playerSearchTerm),e.R7$(4),e.Y8G("ngIf",r.isLoadingPlayers),e.R7$(1),e.Y8G("ngIf",!r.isLoadingPlayers&&r.filteredPlayers.length>0),e.R7$(1),e.Y8G("ngIf",!r.isLoadingPlayers&&0===r.filteredPlayers.length),e.R7$(1),e.Y8G("ngIf",r.showCreateTournamentModal),e.R7$(1),e.Y8G("ngIf",r.showCreateTeamModal),e.R7$(1),e.Y8G("ngIf",r.showAddPlayerModal),e.R7$(1),e.Y8G("ngIf",r.showRecordResultModal),e.R7$(1),e.Y8G("ngIf",r.showPlayerMatchesModal),e.R7$(1),e.Y8G("ngIf",r.showConfirmStartTournamentModal),e.R7$(1),e.Y8G("ngIf",r.showConfirmFinishTournamentModal),e.R7$(1),e.Y8G("ngIf",r.showConfirmDeleteTournamentModal),e.R7$(1),e.Y8G("ngIf",r.showConfirmUndoMatchModal),e.R7$(1),e.Y8G("ngIf",r.showReplacePlayerModal))},dependencies:[m.Sq,m.bT,l.xH,l.y7,l.me,l.Q0,l.wz,l.BC,l.VZ,l.zX,l.vS,m.QX],styles:["[_nghost-%COMP%]{display:block;width:100%}.teams-dashboard[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#1f2937 0%,#111827 100%)}.tournament-card[_ngcontent-%COMP%]{transition:all .3s ease;border:1px solid transparent}.tournament-card[_ngcontent-%COMP%]:hover{border-color:#3b82f6;transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.status-badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;padding:.25rem .75rem;border-radius:9999px;text-transform:uppercase;letter-spacing:.025em}.status-created[_ngcontent-%COMP%]{background-color:#fbbf24;color:#1f2937}.status-started[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.status-finished[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.team-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;background-color:#3b82f6;color:#fff;border-radius:.375rem;font-size:.75rem;font-weight:500}.action-button[_ngcontent-%COMP%]{transition:all .2s ease;font-weight:500;padding:.5rem 1rem;border-radius:.375rem;font-size:.875rem}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0003}.action-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}.match-card[_ngcontent-%COMP%]{background-color:#374151;border:1px solid #4b5563;border-radius:.5rem;padding:1rem;transition:all .2s ease}.match-card[_ngcontent-%COMP%]:hover{background-color:#4b5563;border-color:#6b7280}.score-display[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-weight:700;font-size:1.125rem}.player-name[_ngcontent-%COMP%]{font-weight:600;color:#fff}.modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.grid-responsive[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}@media (max-width: 768px){.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}\n\n/*# sourceMappingURL=teams-dashboard.component.css.map*/"]})}}return n})(),data:{title:"Teams Dashboard"}}];let ur=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[_.iI.forChild(dr),_.iI]})}}return n})();var mr=u(6443),hr=u(6736),pr=u(3887);let gr=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[m.MD,ur,_.iI,l.YN,mr.q1,hr.PlayerModule,pr.G]})}}return n})()}}]);
//# sourceMappingURL=971.3df8fade0c98e9b7.js.map