"use strict";(self.webpackChunkYugiTournamnet=self.webpackChunkYugiTournamnet||[]).push([[792],{9706:(M,x,i)=>{i.d(x,{p:()=>P});var b=i(5797),h=i(9452),t=i(1873),v=i(1567),C=i(8764),u=i(1318),E=i(8700),a=i(271),l=i(8450),c=i(3665),g=i(9101),m=i(7137),w=i(6375),k=i(5716);let P=(()=>{class I{constructor(p,_,T,O,A){this.playerService=p,this.matchService=_,this.leagueService=T,this.messageService=O,this.noteService=A,this.essentialDataCache$=new b.t(null),this.secondaryDataCache=new Map,this.lastEssentialUpdate=0,this.lastSecondaryUpdate=new Map,this.CACHE_DURATION=9e5,this.SECONDARY_CACHE_DURATION=9e5}getEssentialData(p=!1){const _=Date.now();return!p&&this.essentialDataCache$.value&&_-this.lastEssentialUpdate<this.CACHE_DURATION?this.essentialDataCache$.asObservable().pipe((0,v.p)(O=>null!==O)):this.loadEssentialDataFromServer().pipe((0,C.M)(O=>{this.essentialDataCache$.next(O),this.lastEssentialUpdate=_}),(0,u.W)(O=>(0,h.of)(this.essentialDataCache$.value||this.getEmptyDashboardData())),(0,E.t)(1))}getSecondaryData(p,_=!1){const T=Date.now(),O=this.lastSecondaryUpdate.get(p)||0,A=this.secondaryDataCache.has(p)&&T-O<this.SECONDARY_CACHE_DURATION;return!_&&A?(0,h.of)(this.secondaryDataCache.get(p)):this.loadSecondaryDataFromServer(p).pipe((0,C.M)(L=>{this.secondaryDataCache.set(p,L),this.lastSecondaryUpdate.set(p,T)}),(0,u.W)(L=>(0,h.of)(this.secondaryDataCache.get(p)||[])))}loadEssentialDataFromServer(){return(0,t.p)({players:this.playerService.getAdminPlayers(),matches:this.matchService.getAdminMatches(),currentLeague:this.leagueService.getAdminCurrentLeague().pipe((0,a.T)(p=>p.league),(0,u.W)(()=>(0,h.of)(null))),allLeagues:this.leagueService.getAdminAllLeagues().pipe((0,u.W)(()=>(0,h.of)([]))),notes:this.noteService.getAdminNotes().pipe((0,a.T)(p=>p.notes),(0,u.W)(()=>(0,h.of)([]))),messages:this.messageService.getAdminMessages().pipe((0,a.T)(p=>p.messages||[]),(0,u.W)(()=>(0,h.of)([])))}).pipe((0,a.T)(({players:p,matches:_,currentLeague:T,allLeagues:O,notes:A,messages:L})=>{const B=Array.isArray(L)?L:[];return{players:p,matches:_,currentLeague:T,allLeagues:O,notes:A,messages:B,stats:{totalPlayers:p.length,totalMatches:_.length,totalMatchesLeft:_.filter(S=>!S.isCompleted).length,totalMessagesLeft:B.filter(S=>!S.isRead&&!S.isFromAdmin).length}}}))}loadSecondaryDataFromServer(p){switch(p){case"leagues":return this.leagueService.getAdminAllLeagues();case"notes":return this.noteService.getAdminNotes().pipe((0,a.T)(_=>_.notes));case"messages":return this.messageService.getAdminMessages().pipe((0,a.T)(_=>_.messages||[]));default:return(0,h.of)([])}}invalidateCache(p){switch(p){case"essential":this.lastEssentialUpdate=0;break;case"leagues":case"notes":case"messages":this.lastSecondaryUpdate.set(p,0),this.secondaryDataCache.delete(p);break;case"all":this.lastEssentialUpdate=0,this.lastSecondaryUpdate.clear(),this.secondaryDataCache.clear()}}getCurrentEssentialData(){return this.essentialDataCache$.value}updateMessageCount(p){const _=this.essentialDataCache$.value;_&&(_.stats.totalMessagesLeft=p,this.essentialDataCache$.next(_))}getEmptyDashboardData(){return{players:[],matches:[],currentLeague:null,allLeagues:[],notes:[],messages:[],stats:{totalPlayers:0,totalMatches:0,totalMatchesLeft:0,totalMessagesLeft:0}}}static{this.\u0275fac=function(_){return new(_||I)(l.KVO(c.x),l.KVO(g.T),l.KVO(m.N),l.KVO(w.b),l.KVO(k.i))}}static{this.\u0275prov=l.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})()},8010:(M,x,i)=>{i.d(x,{u:()=>E});var b=i(5312),h=i(5797),t=i(8764),v=i(8450),C=i(6443),u=i(4827);let E=(()=>{class a{constructor(c,g){this.http=c,this.router=g,this.baseUrl=b.c.apiUrl,this.isLoggedInSubject=new h.t(this.hasToken()),this.isLoggedIn$=this.isLoggedInSubject.asObservable(),this.userRole=null;const m=localStorage.getItem("token");m&&(this.userRole=this.getRoleFromToken(m),this.isLoggedInSubject.next(!0))}login(c,g){return this.http.post(`${this.baseUrl}/auth/login`,{email:c,password:g}).pipe((0,t.M)(m=>{m.success&&(localStorage.setItem("token",m.token),localStorage.setItem("userRole",m.userRole||"Admin"),this.userRole=m.userRole||"Admin",this.isLoggedInSubject.next(!0),this.router.navigate(["/admin"]))}))}playerLogin(c,g){return this.http.post(`${this.baseUrl}/auth/player-login`,{phoneNumber:c,password:g}).pipe((0,t.M)(m=>{if(m.success&&m.token){localStorage.setItem("token",m.token);const w=this.getRoleFromToken(m.token);this.userRole=w||"Player",localStorage.setItem("userRole",this.userRole),this.isLoggedInSubject.next(!0),this.router.navigate(["/player"])}}))}register(c,g,m,w){return this.http.post(`${this.baseUrl}/auth/register-player`,{phoneNumber:c,password:g,firstName:m,lastName:w})}resetPassword(c,g){return this.http.post(`${this.baseUrl}/auth/reset-password`,{phoneNumber:c,newPassword:g})}logout(){localStorage.removeItem("token"),this.userRole=null,this.isLoggedInSubject.next(!1),this.router.navigate(["/player"])}getRole(){return this.userRole}hasToken(){return!!localStorage.getItem("token")}getRoleFromToken(c){try{return JSON.parse(atob(c.split(".")[1])).role||null}catch{return null}}static{this.\u0275fac=function(g){return new(g||a)(v.KVO(C.Qq),v.KVO(u.Ix))}}static{this.\u0275prov=v.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},5430:(M,x,i)=>{i.d(x,{_:()=>C});var b=i(9452),h=i(8764),t=i(1318),v=i(8450);let C=(()=>{class u{constructor(){this.cache=new Map,this.DEFAULT_TTL=3e5,this.PLAYER_TTL=18e5,this.LEAGUE_TTL=18e5,this.RANKINGS_TTL=18e5,this.loadFromLocalStorage()}set(a,l,c=this.DEFAULT_TTL){const g={data:l,timestamp:Date.now(),ttl:c};this.cache.set(a,g),this.saveToLocalStorage()}get(a){const l=this.cache.get(a);return l?Date.now()-l.timestamp>l.ttl?(this.cache.delete(a),this.saveToLocalStorage(),null):l.data:null}has(a){return null!==this.get(a)}clear(){this.cache.clear(),this.saveToLocalStorage()}remove(a){this.cache.delete(a),this.saveToLocalStorage()}cacheRequest(a,l,c=this.DEFAULT_TTL){const g=this.get(a);return g?(0,b.of)(g):l.pipe((0,h.M)(m=>this.set(a,m,c)),(0,t.W)(m=>{throw m}))}cachePlayerRequest(a,l){return this.cacheRequest(a,l,this.PLAYER_TTL)}cacheLeagueRequest(a,l){return this.cacheRequest(a,l,this.LEAGUE_TTL)}cacheRankingsRequest(a,l){return this.cacheRequest(a,l,this.RANKINGS_TTL)}cacheAllLeaguesRequest(a,l){const c=this.get(a);return c?(0,b.of)(c):l.pipe((0,h.M)(g=>{if(Array.isArray(g)&&g.length>0&&g[0].createdOn){const m=[...g].sort((w,k)=>{const P=new Date(w.createdOn).getTime();return new Date(k.createdOn).getTime()-P});this.set(a,m,this.RANKINGS_TTL)}else this.set(a,g,this.RANKINGS_TTL)}),(0,t.W)(g=>{throw g}))}invalidatePattern(a){for(const l of this.cache.keys())l.includes(a)&&this.cache.delete(l);this.saveToLocalStorage()}getNextPlayerUpdateTime(){const a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()+1,0,0,0)}getLastUpdateTime(a){const l=this.cache.get(a);return l?new Date(l.timestamp):null}isCacheExpired(a){const l=this.cache.get(a);return!l||Date.now()-l.timestamp>l.ttl}getCacheExpiryTime(a){const l=this.cache.get(a);return l?new Date(l.timestamp+l.ttl):null}forceRefresh(a,l,c=this.DEFAULT_TTL){return this.remove(a),this.cacheRequest(a,l,c)}shouldRefreshRankings(){const a=this.getLastUpdateTime("all-leagues-rank");return!a||(Date.now()-a.getTime())/6e4>=30}shouldRefreshCurrentLeague(){const a=this.getLastUpdateTime("current-league");return!a||(Date.now()-a.getTime())/6e4>=30}saveToLocalStorage(){try{const a=Array.from(this.cache.entries());localStorage.setItem("app_cache",JSON.stringify(a))}catch{}}loadFromLocalStorage(){try{const a=localStorage.getItem("app_cache");if(a){const l=JSON.parse(a);this.cache=new Map(l);for(const[c,g]of this.cache.entries())Date.now()-g.timestamp>g.ttl&&this.cache.delete(c)}}catch{}}static{this.\u0275fac=function(l){return new(l||u)}}static{this.\u0275prov=v.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},7137:(M,x,i)=>{i.d(x,{N:()=>C});var b=i(5312),h=i(8450),t=i(6443),v=i(5430);let C=(()=>{class u{constructor(a,l){this.http=a,this.cacheService=l,this.baseUrl=b.c.apiUrl}resetLeague(a){return this.http.post(`${this.baseUrl}/league/reset/${a}`,{})}startLeague(a){return this.http.post(`${this.baseUrl}/league/start`,a)}GetCurrentLeague(a=!1){const l=this.http.get(`${this.baseUrl}/league/getCurrentLeague`);return a||this.cacheService.shouldRefreshCurrentLeague()?this.cacheService.forceRefresh("current-league",l,18e5):this.cacheService.cachePlayerRequest("current-league",l)}getAdminCurrentLeague(){return this.http.get(`${this.baseUrl}/league/getCurrentLeague`)}GetAllLeaguesRank(a=!1){const l=this.http.get(`${this.baseUrl}/player/players/all`);return a||this.cacheService.shouldRefreshRankings()?this.cacheService.forceRefresh("all-leagues-rank",l,18e5):this.cacheService.cacheAllLeaguesRequest("all-leagues-rank",l)}getAdminAllLeagues(){return this.http.get(`${this.baseUrl}/player/players/all`)}DeleteLeague(a){return this.http.delete(`${this.baseUrl}/league/delete/${a}`)}createGroupsAndMatches(a){return this.http.post(`${this.baseUrl}/league/${a}/create-groups`,{})}startKnockoutStage(a){return this.http.post(`${this.baseUrl}/league/${a}/start-knockouts`,{})}startSemiFinals(a){return this.http.post(`${this.baseUrl}/league/${a}/start-semifinals`,{})}startFinal(a){return this.http.post(`${this.baseUrl}/league/${a}/start-final`,{})}getLastLeaguesRankUpdateTime(){return this.cacheService.getLastUpdateTime("all-leagues-rank")}getLastCurrentLeagueUpdateTime(){return this.cacheService.getLastUpdateTime("current-league")}isRankingsCacheExpired(){return this.cacheService.isCacheExpired("all-leagues-rank")}isCurrentLeagueCacheExpired(){return this.cacheService.isCacheExpired("current-league")}getNextRankingsUpdateTime(){return this.cacheService.getCacheExpiryTime("all-leagues-rank")}getNextCurrentLeagueUpdateTime(){return this.cacheService.getCacheExpiryTime("current-league")}forceRefreshRankings(){return this.GetAllLeaguesRank(!0)}forceRefreshCurrentLeague(){return this.GetCurrentLeague(!0)}static{this.\u0275fac=function(l){return new(l||u)(h.KVO(t.Qq),h.KVO(v._))}}static{this.\u0275prov=h.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},9101:(M,x,i)=>{i.d(x,{T:()=>E});var b=i(8764),h=i(5312),t=i(8450),v=i(6443),C=i(3665),u=i(5430);let E=(()=>{class a{constructor(c,g,m){this.http=c,this.playerService=g,this.cacheService=m,this.baseUrl=h.c.apiUrl}getMatches(){return this.cacheService.cachePlayerRequest("current-matches",this.http.get(`${this.baseUrl}/match`))}getAdminMatches(){return this.http.get(`${this.baseUrl}/match`)}updateMatch(c,g){return this.http.post(`${this.baseUrl}/match/${c}/result`,{winnerId:g}).pipe((0,b.M)(()=>{this.playerService.refreshPlayers()}))}resetMatch(c){return this.http.delete(`${this.baseUrl}/match/reset/${c}`).pipe((0,b.M)(()=>{this.playerService.refreshPlayers()}))}getLastMatchesUpdateTime(){return this.cacheService.getLastUpdateTime("current-matches")}static{this.\u0275fac=function(g){return new(g||a)(t.KVO(v.Qq),t.KVO(C.x),t.KVO(u._))}}static{this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},6375:(M,x,i)=>{i.d(x,{b:()=>C});var b=i(5312),h=i(8450),t=i(6443),v=i(5430);let C=(()=>{class u{constructor(a,l){this.http=a,this.cacheService=l,this.baseUrl=b.c.apiUrl}sendMessage(a){return this.http.post(`${this.baseUrl}/Message/send`,{Content:a})}getMessages(){return this.http.get(`${this.baseUrl}/Message/inbox`)}getAdminMessages(){return this.http.get(`${this.baseUrl}/Message/inbox`)}toggleMarkMessage(a,l){return this.http.post(`${this.baseUrl}/Message/mark/${a}`,{Marked:l})}toggleDeleteMessage(a,l){return this.http.post(`${this.baseUrl}/Message/delete/${a}`,{Marked:l})}getPlayerMessages(){return this.http.get(`${this.baseUrl}/Message/my-messages`)}sendAdminReply(a,l){return this.http.post(`${this.baseUrl}/Message/reply/${a}`,{Content:l})}static{this.\u0275fac=function(l){return new(l||u)(h.KVO(t.Qq),h.KVO(v._))}}static{this.\u0275prov=h.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},5716:(M,x,i)=>{i.d(x,{i:()=>C});var b=i(5312),h=i(8450),t=i(6443),v=i(5430);let C=(()=>{class u{constructor(a,l){this.http=a,this.cacheService=l,this.baseUrl=b.c.apiUrl}sendNote(a){return this.http.post(`${this.baseUrl}/note/write`,{Content:a})}getNotes(){return this.http.get(`${this.baseUrl}/note/notes`)}getAdminNotes(){return this.http.get(`${this.baseUrl}/note/notes`)}toggleMarHide(a,l){return this.http.post(`${this.baseUrl}/note/hide/${a}`,{Marked:l})}DeleteNote(a,l){return this.http.post(`${this.baseUrl}/note/delete/${a}`,{Marked:l})}static{this.\u0275fac=function(l){return new(l||u)(h.KVO(t.Qq),h.KVO(v._))}}static{this.\u0275prov=h.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},3665:(M,x,i)=>{i.d(x,{x:()=>E});var b=i(5797),h=i(8764),t=i(5312),v=i(8450),C=i(6443),u=i(5430);let E=(()=>{class a{constructor(c,g){this.http=c,this.cacheService=g,this.baseUrl=t.c.apiUrl,this.rankingSubject=new b.t([]),this.ranking$=this.rankingSubject.asObservable()}getrank(){return this.cacheService.cachePlayerRequest("player-ranking",this.http.get(`${this.baseUrl}/player/ranking`).pipe((0,h.M)(c=>this.rankingSubject.next(c))))}getPlayers(){return this.cacheService.cachePlayerRequest("players-list",this.http.get(`${this.baseUrl}/player`).pipe((0,h.M)(c=>this.rankingSubject.next(c))))}getAdminPlayers(){return this.http.get(`${this.baseUrl}/player`).pipe((0,h.M)(c=>this.rankingSubject.next(c)))}addPlayer(c){return this.http.post(`${this.baseUrl}/player`,{fullName:c}).pipe((0,h.M)(()=>{this.cacheService.invalidatePattern("player"),this.refreshPlayers()}))}deletePlayer(c){return this.http.delete(`${this.baseUrl}/player/${c}`).pipe((0,h.M)(()=>{this.cacheService.invalidatePattern("player"),this.refreshPlayers()}))}refreshRanking(){this.cacheService.remove("player-ranking"),this.http.get(`${this.baseUrl}/player/ranking`).subscribe(c=>{this.rankingSubject.next(c)})}refreshPlayers(){this.cacheService.remove("players-list"),this.http.get(`${this.baseUrl}/player`).subscribe(c=>{this.rankingSubject.next(c)})}getNextUpdateTime(){return this.cacheService.getNextPlayerUpdateTime()}getLastRankingUpdateTime(){return this.cacheService.getLastUpdateTime("player-ranking")}getLastPlayersUpdateTime(){return this.cacheService.getLastUpdateTime("players-list")}static{this.\u0275fac=function(g){return new(g||a)(v.KVO(C.Qq),v.KVO(u._))}}static{this.\u0275prov=v.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},3887:(M,x,i)=>{i.d(x,{G:()=>u});var b=i(316),h=i(4456),t=i(6375),v=i(9706),C=i(8450);let u=(()=>{class E{static{this.\u0275fac=function(c){return new(c||E)}}static{this.\u0275mod=C.$C({type:E})}static{this.\u0275inj=C.G2t({providers:[t.b,v.p],imports:[b.MD,h.YN]})}}return E})()},5312:(M,x,i)=>{i.d(x,{c:()=>h});const h={production:!1,apiUrl:"https://yugiapp.runasp.net/api"}},8068:(M,x,i)=>{var b=i(436),h=i(4827),t=i(8450),v=i(8010);const u=[{path:"",redirectTo:"player",pathMatch:"full"},{path:"player",loadChildren:()=>i.e(736).then(i.bind(i,6736)).then(s=>s.PlayerModule),data:{title:"Players"}},{path:"auth",loadChildren:()=>i.e(949).then(i.bind(i,949)).then(s=>s.AuthModule),data:{title:"Auth"}},{path:"admin",loadChildren:()=>Promise.all([i.e(736),i.e(971)]).then(i.bind(i,9971)).then(s=>s.AdminModule),canActivate:[(s,f)=>((0,t.WQX)(v.u),!!localStorage.getItem("token"))],data:{title:"Admin"}},{path:"**",redirectTo:"player"}];let E=(()=>{class s{static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[h.iI.forRoot(u),h.iI]})}}return s})();var a=i(1567);let l=(()=>{class s{constructor(e,n){this.title=e,this.router=n,this.defaultTitle="Yugi-Oh Tournament",this.title.setTitle(this.defaultTitle),this.setupTitleUpdates()}setupTitleUpdates(){this.router.events.pipe((0,a.p)(e=>e instanceof h.wF)).subscribe(e=>{setTimeout(()=>{this.updateTitle()},50)})}updateTitle(){const e=this.getCurrentRoute();this.title.setTitle(e?.snapshot?.data?.title?e.snapshot.data.title:this.defaultTitle)}getCurrentRoute(){let e=this.router.routerState.root;for(;e.firstChild;)e=e.firstChild;let n=this.router.routerState.root;for(;n.firstChild;)n=n.firstChild;return e?.snapshot?.data?.title?e:n?.snapshot?.data?.title?n:e}setTitle(e){this.title.setTitle(e||this.defaultTitle)}static{this.\u0275fac=function(n){return new(n||s)(t.KVO(b.hE),t.KVO(h.Ix))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var c=i(1249),g=i(6375),m=i(4285),w=i(9706),k=i(316),P=i(4456);const I=["messagesContainer"];function K(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",2),t.bIt("mousedown",function(r){t.eBV(e);const o=t.XpG();return t.Njj(o.onButtonMouseDown(r))})("touchstart",function(r){t.eBV(e);const o=t.XpG();return t.Njj(o.onButtonTouchStart(r))})("touchend",function(r){t.eBV(e);const o=t.XpG();return t.Njj(o.onButtonTouchEnd(r))}),t.j41(1,"div",3),t.bIt("click",function(r){t.eBV(e);const o=t.XpG();return t.Njj(o.onButtonClick(r))}),t.nrm(2,"i",4),t.j41(3,"div",5),t.EFF(4," Admin Inbox (Drag to move) "),t.nrm(5,"div",6),t.k0s()()()}if(2&s){const e=t.XpG();t.xc7("left",e.buttonPosition.x,"px")("top",e.buttonPosition.y,"px"),t.AVh("dragging",e.isDragging),t.R7$(1),t.AVh("shadow-2xl",e.isDragging)}}function p(s,f){if(1&s&&(t.j41(0,"div",32),t.EFF(1),t.k0s()),2&s){const e=t.XpG().$implicit;t.R7$(1),t.SpI(" ",e.unreadCount," ")}}function _(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",25),t.bIt("click",function(){const o=t.eBV(e).$implicit,d=t.XpG(3);return t.Njj(d.selectChat(o))}),t.j41(1,"div",26)(2,"div",27)(3,"h4",28),t.EFF(4),t.k0s(),t.j41(5,"p",29),t.EFF(6),t.k0s(),t.j41(7,"p",30),t.EFF(8),t.nI1(9,"date"),t.k0s()(),t.DNE(10,p,2,1,"div",31),t.k0s()()}if(2&s){const e=f.$implicit;t.R7$(4),t.SpI(" ",e.playerFullName," "),t.R7$(2),t.SpI(" ",e.lastMessage," "),t.R7$(2),t.SpI(" ",t.i5U(9,4,e.lastMessageDate,"short")," "),t.R7$(2),t.Y8G("ngIf",e.unreadCount>0)}}function T(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",17)(1,"div",18)(2,"div",19)(3,"button",20),t.bIt("click",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.refreshMessages())}),t.nrm(4,"i",21),t.j41(5,"span",22),t.EFF(6,"\u062a\u062d\u062f\u064a\u062b"),t.k0s()()()(),t.j41(7,"div",23),t.DNE(8,_,11,7,"div",24),t.k0s()()}if(2&s){const e=t.XpG(2);t.R7$(8),t.Y8G("ngForOf",e.playerChats)}}function O(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",49)(1,"button",50),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.markAsRead(r.id))}),t.nrm(2,"i",51),t.j41(3,"span",22),t.EFF(4,"\u062a\u062d\u062f\u064a\u062f \u0643\u0645\u0642\u0631\u0648\u0621\u0629"),t.k0s()()()}}const A=function(s,f){return{"text-right":s,"text-left":f}},L=function(s,f){return{"bg-green-700":s,"bg-gray-700":f}};function B(s,f){if(1&s&&(t.j41(0,"div",44)(1,"div",45)(2,"p",46),t.EFF(3),t.k0s(),t.j41(4,"p",47),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.DNE(7,O,5,0,"div",48),t.k0s()()),2&s){const e=f.$implicit;t.Y8G("ngClass",t.l_i(8,A,!e.isFromAdmin,e.isFromAdmin)),t.R7$(1),t.Y8G("ngClass",t.l_i(11,L,!e.isFromAdmin,e.isFromAdmin)),t.R7$(2),t.SpI(" ",e.content," "),t.R7$(2),t.SpI(" ",t.i5U(6,5,e.sentAt,"MMM d, y, hh:mm a")," "),t.R7$(2),t.Y8G("ngIf",e.isFromAdmin&&!e.isRead)}}function S(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",17)(1,"div",33)(2,"button",34),t.bIt("click",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.goBack())}),t.nrm(3,"i",35),t.k0s(),t.j41(4,"h3",36),t.EFF(5),t.k0s()(),t.j41(6,"div",37,38),t.DNE(8,B,8,14,"div",39),t.k0s(),t.j41(9,"div",40)(10,"div",19)(11,"input",41),t.bIt("ngModelChange",function(r){t.eBV(e);const o=t.XpG(2);return t.Njj(o.replyText=r)})("keyup.enter",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.sendReply(r.selectedChat.playerId))}),t.k0s(),t.j41(12,"button",42),t.bIt("click",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.sendReply(r.selectedChat.playerId))}),t.nrm(13,"i",43),t.j41(14,"span",22),t.EFF(15,"\u0625\u0631\u0633\u0627\u0644"),t.k0s()()()()()}if(2&s){const e=t.XpG(2);t.R7$(5),t.SpI(" ",e.selectedChat.playerFullName," "),t.R7$(3),t.Y8G("ngForOf",e.selectedChat.messages)("ngForTrackBy",e.trackByMessageId),t.R7$(3),t.Y8G("ngModel",e.replyText)}}function G(s,f){if(1&s){const e=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.closeInboxOverlay())}),t.j41(1,"div",8),t.bIt("click",function(r){return r.stopPropagation()}),t.j41(2,"div",9)(3,"div",10),t.nrm(4,"i",11),t.j41(5,"h2",12),t.EFF(6,"Admin Inbox"),t.k0s()(),t.j41(7,"button",13),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.closeInboxOverlay())}),t.nrm(8,"i",14),t.k0s()(),t.j41(9,"div",15),t.DNE(10,T,9,1,"div",16),t.DNE(11,S,16,4,"div",16),t.k0s()()()}if(2&s){const e=t.XpG();t.R7$(10),t.Y8G("ngIf",!e.selectedChat),t.R7$(1),t.Y8G("ngIf",e.selectedChat)}}let H=(()=>{class s{constructor(e,n,r,o,d){this.authService=e,this.messageService=n,this.toastr=r,this.cdr=o,this.adminDashboardService=d,this.isAdmin=!1,this.showInboxOverlay=!1,this.buttonPosition={x:20,y:100},this.isDragging=!1,this.dragOffset={x:0,y:0},this.hasMovedDuringDrag=!1,this.unreadCount=0,this.isMobile=!1,this.playerChats=[],this.selectedPlayerId=null,this.selectedChat=null,this.replyText="",this.navbarHeight=60,this.shouldScrollToBottom=!1,this.CACHE_KEY="adminMessagesCache",this.CACHE_DURATION=18e5,this.cachedMessages=[],this.lastCacheUpdate=0}ngOnInit(){this.checkAdminStatus(),this.setInitialButtonPosition(),this.detectMobileDevice(),this.isAdmin&&this.loadAdminMessages()}ngAfterViewInit(){}ngAfterViewChecked(){this.shouldScrollToBottom&&this.selectedChat&&this.messagesContainer&&setTimeout(()=>{this.scrollToBottom(),this.shouldScrollToBottom=!1},100)}ngOnDestroy(){this.isDragging=!1,this.showInboxOverlay=!1,document.body.style.cursor="default",document.body.classList.remove("dragging"),this.updateStatusSubscription&&this.updateStatusSubscription.unsubscribe(),this.refreshSubscription&&this.refreshSubscription.unsubscribe(),document.removeEventListener("mousemove",this.onGlobalMouseMove.bind(this)),document.removeEventListener("mouseup",this.onGlobalMouseUp.bind(this))}checkAdminStatus(){try{const e=this.authService.getRole();this.isAdmin="Admin"===e}catch(e){console.warn("Error checking admin status:",e),this.isAdmin=!1}}toggleInboxOverlay(){this.showInboxOverlay=!this.showInboxOverlay,this.showInboxOverlay&&(this.loadAdminMessages(),setTimeout(()=>{this.fixInboxComponentForOverlay()},100))}onButtonClick(e){!this.isDragging&&!this.isMobile&&this.toggleInboxOverlay()}detectMobileDevice(){this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0}closeInboxOverlay(){this.showInboxOverlay=!1}fixInboxComponentForOverlay(){const e=document.querySelector(".overlay-enter app-floating-inbox");e&&(e.querySelectorAll('[style*="margin-top"]').forEach(o=>{o.style.marginTop="0px"}),e.querySelectorAll('[style*="top"]').forEach(o=>{o.style.top="0px"}))}setInitialButtonPosition(){const e=localStorage.getItem("floatingInboxButtonPosition");if(e)try{const y=JSON.parse(e),D=24,R=48,F=window.innerWidth-R-D,U=window.innerHeight-R-D;if(y.x>=D&&y.x<=F&&y.y>=D&&y.y<=U)return void(this.buttonPosition=y)}catch(y){console.warn("Error parsing saved button position:",y)}const o=window.innerWidth-48-24,d=window.innerHeight-48-24;this.buttonPosition={x:Math.max(24,o),y:Math.max(24,d)}}onButtonMouseDown(e){this.isDragging=!0,this.hasMovedDuringDrag=!1,this.dragOffset={x:e.clientX-this.buttonPosition.x,y:e.clientY-this.buttonPosition.y},e.preventDefault(),e.stopPropagation(),document.body.style.cursor="grabbing",document.body.classList.add("dragging")}onButtonTouchStart(e){this.isDragging=!0,this.hasMovedDuringDrag=!1;const n=e.touches[0];this.dragOffset={x:n.clientX-this.buttonPosition.x,y:n.clientY-this.buttonPosition.y},e.stopPropagation(),document.body.style.cursor="grabbing",document.body.classList.add("dragging")}onButtonTouchEnd(e){this.isDragging&&!this.hasMovedDuringDrag&&(e.preventDefault(),e.stopPropagation(),this.toggleInboxOverlay()),this.isDragging=!1,document.body.style.cursor="default",document.body.classList.remove("dragging"),this.hasMovedDuringDrag=!1}onGlobalMouseMove(e){this.isDragging&&requestAnimationFrame(()=>{const r=e.clientY-this.dragOffset.y,o=this.buttonPosition.x,d=this.buttonPosition.y,R=window.innerWidth-48-24,F=window.innerHeight-48-24,U=Math.max(24,Math.min(e.clientX-this.dragOffset.x,R)),j=Math.max(24,Math.min(r,F));(Math.abs(U-o)>5||Math.abs(j-d)>5)&&(this.hasMovedDuringDrag=!0),this.buttonPosition={x:U,y:j},this.saveButtonPosition()})}onGlobalTouchMove(e){this.isDragging&&requestAnimationFrame(()=>{const n=e.touches[0],o=n.clientY-this.dragOffset.y,d=this.buttonPosition.x,y=this.buttonPosition.y,F=window.innerWidth-48-24,U=window.innerHeight-48-24,j=Math.max(24,Math.min(n.clientX-this.dragOffset.x,F)),$=Math.max(24,Math.min(o,U));(Math.abs(j-d)>5||Math.abs($-y)>5)&&(this.hasMovedDuringDrag=!0),this.buttonPosition={x:j,y:$},this.saveButtonPosition()})}onGlobalMouseUp(){this.isDragging&&(this.isDragging=!1,document.body.style.cursor="default",document.body.classList.remove("dragging"),setTimeout(()=>{this.hasMovedDuringDrag=!1},100))}onGlobalTouchEnd(e){this.isDragging&&!e.target?.closest(".floating-button")&&(this.isDragging=!1,document.body.style.cursor="default",document.body.classList.remove("dragging"),setTimeout(()=>{this.hasMovedDuringDrag=!1},100))}onWindowResize(){const r=window.innerWidth-48-24,o=window.innerHeight-48-24;this.buttonPosition={x:Math.max(24,Math.min(this.buttonPosition.x,r)),y:Math.max(24,Math.min(this.buttonPosition.y,o))}}onEscapeKey(){this.showInboxOverlay&&(this.showInboxOverlay=!1)}saveButtonPosition(){try{localStorage.setItem("floatingInboxButtonPosition",JSON.stringify(this.buttonPosition))}catch(e){console.warn("Error saving button position to localStorage:",e)}}saveToCache(e){try{const n={messages:e,timestamp:Date.now()};localStorage.setItem(this.CACHE_KEY,JSON.stringify(n)),this.cachedMessages=e,this.lastCacheUpdate=Date.now()}catch(n){console.warn("Error saving messages to cache:",n)}}loadFromCache(){try{const e=localStorage.getItem(this.CACHE_KEY);if(!e)return null;const n=JSON.parse(e);return Date.now()-n.timestamp<this.CACHE_DURATION?(this.cachedMessages=n.messages,this.lastCacheUpdate=n.timestamp,n.messages):(localStorage.removeItem(this.CACHE_KEY),null)}catch(e){return console.warn("Error loading messages from cache:",e),localStorage.removeItem(this.CACHE_KEY),null}}isCacheValid(){return this.cachedMessages.length>0&&Date.now()-this.lastCacheUpdate<this.CACHE_DURATION}getCacheStatus(){if(0===this.cachedMessages.length)return{isValid:!1,lastUpdate:null,age:0};const e=Date.now()-this.lastCacheUpdate;return{isValid:e<this.CACHE_DURATION,lastUpdate:new Date(this.lastCacheUpdate),age:Math.floor(e/1e3/60)}}clearCache(){try{localStorage.removeItem(this.CACHE_KEY),this.cachedMessages=[],this.lastCacheUpdate=0}catch(e){console.warn("Error clearing cache:",e)}}updateCacheWithNewData(e){0!==e.length&&(e.forEach(n=>{const r=this.cachedMessages.find(o=>o.playerId===n.senderId);r?r.messages.some(d=>d.id===n.id)||(r.messages.push(n),new Date(n.sentAt)>new Date(r.lastMessageDate)&&(r.lastMessage=n.content,r.lastMessageDate=n.sentAt),!n.isRead&&!n.isFromAdmin&&r.unreadCount++):this.cachedMessages.push({playerId:n.senderId,playerFullName:n.senderFullName,lastMessage:n.content,lastMessageDate:n.sentAt,unreadCount:n.isRead||n.isFromAdmin?0:1,messages:[n]})}),this.cachedMessages.sort((n,r)=>new Date(r.lastMessageDate).getTime()-new Date(n.lastMessageDate).getTime()),this.saveToCache(this.cachedMessages),this.playerChats=[...this.cachedMessages])}loadAdminMessages(){this.loadFromServer(!1)}loadFromServer(e=!1){this.adminDashboardService.getSecondaryData("messages").subscribe({next:n=>{if(n&&n.length>0){const r=this.groupMessagesBySender(n);this.playerChats=r.sort((o,d)=>new Date(d.lastMessageDate).getTime()-new Date(o.lastMessageDate).getTime()),this.saveToCache(this.playerChats)}else this.toastr.error("\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644"),this.playerChats=[],this.saveToCache([])},error:n=>{this.toastr.error(n.message),this.playerChats=[],this.saveToCache([])}})}refreshMessages(){this.messageService.getAdminMessages().subscribe({next:e=>{if(e&&e.messages){const n=this.groupMessagesBySender(e.messages);this.playerChats=n.sort((r,o)=>new Date(o.lastMessageDate).getTime()-new Date(r.lastMessageDate).getTime()),this.saveToCache(this.playerChats),this.cdr.detectChanges()}else this.toastr.error("\u0644\u0627 \u064a\u0648\u062c\u062f \u0631\u0633\u0627\u0626\u0644")},error:e=>{this.toastr.error(e.message||"\u0641\u0634\u0644 \u0641\u064a \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0631\u0633\u0627\u0626\u0644")}})}selectChat(e){this.selectedChat=e,this.selectedPlayerId=e.playerId,this.selectedChat&&this.selectedChat.messages&&(this.markUnreadMessagesAsRead(e.playerId),this.shouldScrollToBottom=!0)}loadChatMessages(e){if(this.cachedMessages.length>0){const n=this.cachedMessages.find(r=>r.playerId===e)?.messages||[];this.selectedChat&&(this.selectedChat.messages=n,this.markUnreadMessagesAsRead(e),setTimeout(()=>{this.scrollToBottom()},100))}else this.loadFromServer(!1)}markUnreadMessagesAsRead(e){if(!this.selectedChat)return;const n=this.selectedChat.messages.filter(r=>!r.isFromAdmin&&!r.isRead);n.length>0&&n.forEach(r=>{this.messageService.toggleMarkMessage(r.id,!0).subscribe({next:o=>{if(o.success){r.isRead=!0;const d=this.playerChats.find(y=>y.playerId===e);d&&(d.unreadCount=Math.max(0,d.unreadCount-1)),this.saveToCache(this.playerChats),this.cdr.detectChanges()}},error:o=>{console.error("Error marking message as read:",o)}})})}scrollToTop(){const e=document.querySelector("#messagesContainer");e&&(e.scrollTop=0)}scrollToBottom(){this.messagesContainer&&this.messagesContainer.nativeElement&&(this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight)}groupMessagesBySender(e){const n=new Map;return e.forEach(r=>{const o=r.senderId;if(n.has(o)){const d=n.get(o);d.messages.push(r),new Date(r.sentAt)>new Date(d.lastMessageDate)&&(d.lastMessage=r.content,d.lastMessageDate=r.sentAt),r.isRead||d.unreadCount++}else n.set(o,{playerId:o,playerFullName:r.senderFullName,lastMessage:r.content,lastMessageDate:r.sentAt,unreadCount:r.isRead?0:1,messages:[r]})}),Array.from(n.values()).forEach(r=>{r.messages.sort((o,d)=>new Date(o.sentAt).getTime()-new Date(d.sentAt).getTime())}),Array.from(n.values())}sendReply(e){if(!this.replyText||""===this.replyText.trim())return void this.toastr.error("\u064a\u0631\u062c\u0649 \u0643\u062a\u0627\u0628\u0629 \u0631\u062f");const n=this.replyText;this.replyText="",this.messageService.sendAdminReply(e,n).subscribe({next:r=>{if(r.success){if(this.toastr.success("\u062a\u0645 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f \u0628\u0646\u062c\u0627\u062d"),this.selectedChat){const o={id:r.messageId||Date.now(),content:n,sentAt:(new Date).toISOString(),isFromAdmin:!0,isRead:!0,senderId:"admin",senderFullName:"Admin"};this.selectedChat.messages.push(o);const d=this.playerChats.find(y=>y.playerId===e);d&&(d.lastMessage=n,d.lastMessageDate=o.sentAt,this.playerChats.sort((y,D)=>new Date(D.lastMessageDate).getTime()-new Date(y.lastMessageDate).getTime())),this.saveToCache(this.playerChats),this.cdr.detectChanges(),setTimeout(()=>{this.scrollToBottom()},100)}}else this.toastr.error(r.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f")},error:r=>{this.toastr.error(r.message||"\u0641\u0634\u0644 \u0641\u064a \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u062f")}})}markAsRead(e){this.messageService.toggleMarkMessage(e,!0).subscribe({next:n=>{if(n.success){if(this.selectedChat){const r=this.selectedChat.messages.find(o=>o.id===e);if(r){r.isRead=!0;const o=this.playerChats.find(d=>d.playerId===this.selectedChat?.playerId);o&&(o.unreadCount=Math.max(0,o.unreadCount-1)),this.saveToCache(this.playerChats)}}this.cdr.detectChanges()}},error:n=>{console.error("Error marking message as read:",n)}})}goBack(){this.selectedChat=null,this.selectedPlayerId=null}trackByMessageId(e,n){return n.id}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(v.u),t.rXU(g.b),t.rXU(m.tw),t.rXU(t.gRc),t.rXU(w.p))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-floating-inbox"]],viewQuery:function(n,r){if(1&n&&t.GBs(I,5),2&n){let o;t.mGM(o=t.lsd())&&(r.messagesContainer=o.first)}},hostBindings:function(n,r){1&n&&t.bIt("mousemove",function(d){return r.onGlobalMouseMove(d)},!1,t.EBC)("touchmove",function(d){return r.onGlobalTouchMove(d)},!1,t.EBC)("mouseup",function(){return r.onGlobalMouseUp()},!1,t.EBC)("touchend",function(d){return r.onGlobalTouchEnd(d)},!1,t.EBC)("resize",function(){return r.onWindowResize()},!1,t.tSv)("keydown.escape",function(){return r.onEscapeKey()},!1,t.EBC)},decls:2,vars:2,consts:[["class","fixed z-50 cursor-pointer select-none",3,"left","top","dragging","mousedown","touchstart","touchend",4,"ngIf"],["class","fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center pt-[50px] sm:p-4 md:p-4",3,"click",4,"ngIf"],[1,"fixed","z-50","cursor-pointer","select-none",3,"mousedown","touchstart","touchend"],[1,"w-12","h-12","md:w-12","md:h-12","bg-gradient-to-br","from-blue-500","to-blue-600","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","flex","items-center","justify-center","hover:scale-110","floating-button","relative","group","border-2","border-blue-400",3,"click"],[1,"fa-solid","fa-comments","text-lg","text-white"],[1,"absolute","bottom-full","right-0","mb-2","px-3","py-2","bg-gray-800","text-white","text-sm","rounded-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-300","whitespace-nowrap","pointer-events-none","tooltip"],[1,"absolute","top-full","right-4","w-0","h-0","border-l-4","border-r-4","border-t-4","border-transparent","border-t-gray-800"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-50","flex","items-center","justify-center","pt-[50px]","sm:p-4","md:p-4",3,"click"],[1,"bg-gray-900","rounded-lg","shadow-2xl","overflow-hidden","overlay-enter","w-full","h-full","md:w-auto","md:h-auto",2,"min-width","320px","min-height","500px","max-width","90vw","max-height","90vh",3,"click"],[1,"bg-gray-800","p-4","border-b","border-gray-600","flex","items-center","justify-between"],[1,"flex","items-center"],[1,"fa-solid","fa-inbox","text-white","mr-3","text-xl"],[1,"text-xl","font-bold","text-white"],["title","Close",1,"text-gray-400","hover:text-white","transition-colors","p-2","rounded-lg","hover:bg-gray-700","active:bg-gray-600",3,"click"],[1,"fa-solid","fa-times","text-xl"],[1,"h-full","overflow-hidden"],["class","h-full flex flex-col",4,"ngIf"],[1,"h-full","flex","flex-col"],[1,"bg-gray-700","p-3","border-b","border-gray-600","flex","flex-col","space-y-2"],[1,"flex","items-center","space-x-2","rtl:space-x-reverse"],["title","\u062a\u062d\u062f\u064a\u062b",1,"bg-blue-600","hover:bg-blue-700","text-white","px-3","py-2","rounded","text-sm","transition-colors","active:bg-blue-800","min-w-[80px]",3,"click"],[1,"fa-solid","fa-refresh","mr-1"],[1,"hidden","sm:inline"],[1,"flex-1","overflow-y-auto","p-2","max-h-96"],["class","bg-gray-800 hover:bg-gray-700 rounded-lg p-3 mb-2 cursor-pointer transition-colors border-l-4 border-transparent hover:border-blue-500 active:bg-gray-600",3,"click",4,"ngFor","ngForOf"],[1,"bg-gray-800","hover:bg-gray-700","rounded-lg","p-3","mb-2","cursor-pointer","transition-colors","border-l-4","border-transparent","hover:border-blue-500","active:bg-gray-600",3,"click"],[1,"flex","justify-between","items-start"],[1,"flex-1","min-w-0"],[1,"text-white","font-medium","text-sm","truncate"],[1,"text-gray-300","text-xs","mt-1","truncate"],[1,"text-gray-400","text-xs","mt-1"],["class","bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center flex-shrink-0 ml-2",4,"ngIf"],[1,"bg-red-500","text-white","text-xs","rounded-full","px-2","py-1","min-w-[20px]","text-center","flex-shrink-0","ml-2"],[1,"bg-gray-700","px-2","border-b","border-gray-600","flex","items-center"],["title","\u0631\u062c\u0648\u0639",1,"text-gray-400","hover:text-white","mr-3","transition-colors","p-2","rounded","active:bg-gray-600",3,"click"],[1,"fa-solid","fa-arrow-left","text-lg"],[1,"text-white","text-sm","font-semibold","truncate","flex-1"],[1,"flex-1","overflow-y-auto","p-3","space-y-3","max-h-80"],["messagesContainer",""],["class","mb-4",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-gray-700","p-3","border-t","border-gray-600"],["type","text","placeholder","\u0627\u0643\u062a\u0628 \u0631\u062f\u0643 \u0647\u0646\u0627...","autocomplete","off","autocorrect","off","autocapitalize","off",1,"flex-1","bg-gray-600","text-white","text-sm","px-3","py-2","md:py-2","rounded","border","border-gray-500","focus:border-blue-500","focus:outline-none",3,"ngModel","ngModelChange","keyup.enter"],["title","\u0625\u0631\u0633\u0627\u0644",1,"bg-blue-600","hover:bg-blue-700","text-white","px-3","md:px-4","py-2","md:py-2","rounded","text-sm","transition-colors","min-w-[60px]","md:min-w-[80px]",3,"click"],[1,"fa-solid","fa-paper-plane","mr-1"],[1,"mb-4",3,"ngClass"],[1,"inline-block","p-3","rounded-lg","max-w-[85%]","md:max-w-xs",3,"ngClass"],[1,"text-white","text-sm","break-words"],[1,"text-xs","mt-1","text-gray-300"],["class","flex justify-end items-center mt-2",4,"ngIf"],[1,"flex","justify-end","items-center","mt-2"],["title","\u062a\u062d\u062f\u064a\u062f \u0643\u0645\u0642\u0631\u0648\u0621\u0629",1,"text-green-400","hover:text-green-300","text-xs","transition-colors","p-1","rounded","active:bg-green-800",3,"click"],[1,"fa-solid","fa-check","mr-1"]],template:function(n,r){1&n&&(t.DNE(0,K,6,8,"div",0),t.DNE(1,G,12,2,"div",1)),2&n&&(t.Y8G("ngIf",r.isAdmin),t.R7$(1),t.Y8G("ngIf",r.isAdmin&&r.showInboxOverlay))},dependencies:[k.YU,k.Sq,k.bT,P.me,P.BC,P.vS,k.vh],styles:[".floating-button[_ngcontent-%COMP%]{position:fixed;z-index:1000;cursor:grab;transition:transform .2s ease;box-shadow:0 4px 12px #0000004d;-webkit-tap-highlight-color:transparent;touch-action:manipulation;user-select:none;-webkit-user-select:none}.floating-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.floating-button[_ngcontent-%COMP%]:active, .floating-button.dragging[_ngcontent-%COMP%]{cursor:grabbing}.tooltip[_ngcontent-%COMP%]{position:absolute;background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:6px;font-size:12px;white-space:nowrap;pointer-events:none;z-index:1001;opacity:0;transition:opacity .3s ease}.floating-button[_ngcontent-%COMP%]:hover   .tooltip[_ngcontent-%COMP%]{opacity:1}.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:999;display:flex;align-items:center;justify-content:center;padding:20px}.overlay-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_overlayEnter .3s ease-out}@keyframes _ngcontent-%COMP%_overlayEnter{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.modal[_ngcontent-%COMP%]{background:#1f2937;border-radius:12px;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;max-width:90vw;max-height:90vh;min-width:400px;min-height:500px;overflow:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;border-radius:4px;border:1px solid #374151}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280;border-radius:4px;border:1px solid #374151}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:#374151}*[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#6b7280 #374151}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth}.overflow-y-auto[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#9ca3af}input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.cache-status[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.cache-status[_ngcontent-%COMP%]   .valid[_ngcontent-%COMP%]{color:#10b981}.cache-status[_ngcontent-%COMP%]   .expired[_ngcontent-%COMP%]{color:#f59e0b}.action-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}@media (max-width: 640px){.modal[_ngcontent-%COMP%]{min-width:95vw;min-height:95vh;margin:10px}.max-h-96[_ngcontent-%COMP%]{max-height:60vh}.max-h-80[_ngcontent-%COMP%]{max-height:50vh}.overlay-enter[_ngcontent-%COMP%]{width:100vw!important;height:100vh!important;max-width:100vw!important;max-height:100vh!important;border-radius:0;margin:0}.floating-button[_ngcontent-%COMP%]{min-width:56px;min-height:56px}input[type=text][_ngcontent-%COMP%]{font-size:16px}.overflow-y-auto[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch}.cache-status[_ngcontent-%COMP%]{font-size:.7rem}.fixed.bottom-0[_ngcontent-%COMP%]{position:fixed!important;bottom:0!important;left:0!important;right:0!important;z-index:50!important}}#messagesContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse}#messagesContainer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-bottom:1rem}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{transition:all .2s ease}.mb-2[_ngcontent-%COMP%]{margin-bottom:.75rem}@media (max-width: 768px){.floating-button[_ngcontent-%COMP%]{min-width:56px;min-height:56px;transform:none}.floating-button[_ngcontent-%COMP%]:hover{transform:none}.tooltip[_ngcontent-%COMP%]{display:none}}\n\n/*# sourceMappingURL=floating-inbox.component.css.map*/"]})}}return s})();var W=i(5716);const V=["navbarContainer"],Y=["navbarOnly"];function X(s,f){1&s&&(t.j41(0,"a",34),t.EFF(1," YuGi Tournament "),t.k0s())}function z(s,f){1&s&&(t.j41(0,"a",35),t.EFF(1," Admin Dashboard "),t.k0s())}function Q(s,f){1&s&&(t.j41(0,"a",36),t.EFF(1," Friendlies "),t.k0s())}function J(s,f){1&s&&(t.j41(0,"a",37),t.EFF(1," Inbox "),t.k0s())}function Z(s,f){1&s&&(t.j41(0,"a",38),t.EFF(1," Inbox "),t.k0s())}function q(s,f){1&s&&(t.qex(0),t.j41(1,"a",39),t.EFF(2," Login "),t.k0s(),t.j41(3,"a",40),t.EFF(4," Register "),t.k0s(),t.bVm())}function tt(s,f){if(1&s){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.logout())}),t.EFF(1," Logout "),t.k0s()}}function et(s,f){if(1&s){const e=t.RV6();t.qex(0),t.j41(1,"a",42),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.closeMenu())}),t.EFF(2," Login "),t.k0s(),t.j41(3,"a",43),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.closeMenu())}),t.EFF(4," Register "),t.k0s(),t.bVm()}}function nt(s,f){if(1&s){const e=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return r.logout(),t.Njj(r.closeMenu())}),t.EFF(1," Logout "),t.k0s()}}function rt(s,f){if(1&s&&(t.j41(0,"div",47)(1,"h4",48),t.EFF(2),t.k0s()()),2&s){const e=f.$implicit;t.R7$(2),t.SpI(" ",e.content," ")}}function at(s,f){if(1&s&&(t.j41(0,"div",44)(1,"div",45),t.DNE(2,rt,3,1,"div",46),t.k0s()()),2&s){const e=t.XpG();t.xc7("top",e.getNavbarOnlyHeight(),"px"),t.R7$(2),t.Y8G("ngForOf",e.notes)}}const st=function(s,f){return{block:s,hidden:f}};let it=(()=>{class s{constructor(e,n,r,o){this.authService=e,this.router=n,this.toastr=r,this.noteService=o,this.navbarHeightChange=new t.bkB,this.isLoggedIn=!1,this.isAdmin=!1,this.notes=[],this.isMenuOpen=!1,this.navbarHeight=80,this.navbarOnlyHeight=60,this.authService.isLoggedIn$.subscribe(d=>{this.isLoggedIn=d;const y=this.authService.getRole();this.isAdmin="Admin"===y})}ngOnInit(){this.getNotes()}ngAfterViewInit(){this.calculateNavbarHeight()}calculateNavbarHeight(){setTimeout(()=>{this.navbarOnly&&(this.navbarOnlyHeight=this.navbarOnly.nativeElement.offsetHeight);const n=this.navbarOnlyHeight+32*this.notes.length;this.navbarHeight=n,this.navbarHeightChange.emit(n)},150)}getNavbarOnlyHeight(){return this.navbarOnlyHeight}logout(){this.authService.logout(),this.toastr.success("\u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c \u0628\u0646\u062c\u0627\u062d"),this.router.navigate(["/player"])}getNotes(){this.noteService.getNotes().subscribe(e=>{const n=Array.isArray(e.notes)?e.notes:e.notes?.data||[];this.notes=n.filter(r=>0==r.isHidden),setTimeout(()=>this.calculateNavbarHeight(),50)})}toggleMenu(){this.isMenuOpen=!this.isMenuOpen}closeMenu(){this.isMenuOpen=!1}onResize(e){this.calculateNavbarHeight()}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(v.u),t.rXU(h.Ix),t.rXU(m.tw),t.rXU(W.i))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-navbar"]],viewQuery:function(n,r){if(1&n&&(t.GBs(V,5),t.GBs(Y,5)),2&n){let o;t.mGM(o=t.lsd())&&(r.navbarContainer=o.first),t.mGM(o=t.lsd())&&(r.navbarOnly=o.first)}},hostBindings:function(n,r){1&n&&t.bIt("resize",function(d){return r.onResize(d)},!1,t.tSv)},outputs:{navbarHeightChange:"navbarHeightChange"},decls:49,vars:14,consts:[[1,"fixed","top-0","left-0","w-full","z-50","bg-black","backdrop-blur-sm","transition-all","duration-300"],["navbarContainer",""],["navbarOnly",""],[1,"container","mx-auto","flex","flex-col","md:flex-row","md:items-center","md:justify-between","p-2"],[1,"w-full","flex","items-center","justify-between","md:gap-4"],[1,"flex","items-center","gap-4"],["class","text-xl font-bold bg-gradient-to-r from-indigo-400 to-cyan-400 text-transparent bg-clip-text",4,"ngIf"],["routerLink","/admin/players","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white","class","text-white hover:text-gray-300 hover:bg-gray-700 transition rounded py-2 px-2 font-bold",4,"ngIf"],["routerLink","/admin/friendlies","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white","class","text-white hover:text-gray-300 hover:bg-gray-700 transition rounded py-2 px-2 font-bold",4,"ngIf"],["routerLink","/player/inbox","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white","class","md:hidden font-bold text-white hover:text-gray-300 hover:bg-gray-700 transition rounded py-2 px-2 cursor-pointer",4,"ngIf"],[1,"hidden","md:flex","justify-center","space-x-2","font-bold"],["routerLink","/player/friendlies","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/player/teams","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/player/forbidden","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/player/allLeagues","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/player/league-table","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/player/ranking","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],[1,"hidden","md:flex","justify-end","items-center","space-x-4"],["routerLink","/player/inbox","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white","class","text-white font-bold hover:text-gray-300 hover:bg-gray-700 transition rounded py-2 px-2 cursor-pointer",4,"ngIf"],[4,"ngIf"],["class","text-white hover:text-gray-300 hover:bg-gray-700 transition rounded py-2 px-2 cursor-pointer",3,"click",4,"ngIf"],[1,"md:hidden"],[1,"text-white","ml-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","d","M4 6h16M4 12h16M4 18h16"],[1,"w-full","mt-4","md:hidden",3,"ngClass"],[1,"flex","flex-col","space-y-2","font-bold","text-center"],["routerLink","/player/friendlies","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/player/teams","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/player/forbidden","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/player/allLeagues","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/player/league-table","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/player/ranking","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["class","fixed w-full z-40 bg-black/10 backdrop-blur-sm",3,"top",4,"ngIf"],[1,"text-xl","font-bold","bg-gradient-to-r","from-indigo-400","to-cyan-400","text-transparent","bg-clip-text"],["routerLink","/admin/players","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2","font-bold"],["routerLink","/admin/friendlies","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2","font-bold"],["routerLink","/player/inbox","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"md:hidden","font-bold","text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2","cursor-pointer"],["routerLink","/player/inbox","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","font-bold","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2","cursor-pointer"],["routerLink","/auth/login","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],["routerLink","/auth/register","routerLinkActive","!text-indigo-300 bg-white/10 border-b-2 border-white",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2"],[1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2","cursor-pointer",3,"click"],["routerLink","/auth/login",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],["routerLink","/auth/register",1,"text-white","hover:text-gray-300","hover:bg-gray-700","transition","rounded","py-2","px-2",3,"click"],[1,"fixed","w-full","z-40","bg-black/10","backdrop-blur-sm"],[1,"min-h-[30px]","w-full"],["class","py-1",4,"ngFor","ngForOf"],[1,"py-1"],[1,"text-center","text-[16px]","text-white","font-bold"]],template:function(n,r){1&n&&(t.j41(0,"div",0,1)(2,"nav",null,2)(4,"div",3)(5,"div",4)(6,"div",5),t.DNE(7,X,2,0,"a",6),t.DNE(8,z,2,0,"a",7),t.DNE(9,Q,2,0,"a",8),t.DNE(10,J,2,0,"a",9),t.k0s(),t.j41(11,"div",10)(12,"a",11),t.EFF(13," \u{1f3ae} Friendlies "),t.k0s(),t.j41(14,"a",12),t.EFF(15," \u{1f465} Teams "),t.k0s(),t.j41(16,"a",13),t.EFF(17," Forbidden Cards "),t.k0s(),t.j41(18,"a",14),t.EFF(19," All Leagues "),t.k0s(),t.j41(20,"a",15),t.EFF(21," League Table "),t.k0s(),t.j41(22,"a",16),t.EFF(23," Ranking "),t.k0s()(),t.j41(24,"div",17),t.DNE(25,Z,2,0,"a",18),t.DNE(26,q,5,0,"ng-container",19),t.DNE(27,tt,2,0,"a",20),t.k0s(),t.j41(28,"div",21)(29,"button",22),t.bIt("click",function(){return r.toggleMenu()}),t.qSk(),t.j41(30,"svg",23),t.nrm(31,"path",24),t.k0s()()()(),t.joV(),t.j41(32,"div",25)(33,"div",26)(34,"a",27),t.bIt("click",function(){return r.closeMenu()}),t.EFF(35," \u{1f3ae} Friendlies "),t.k0s(),t.j41(36,"a",28),t.bIt("click",function(){return r.closeMenu()}),t.EFF(37," \u{1f465} Teams "),t.k0s(),t.j41(38,"a",29),t.bIt("click",function(){return r.closeMenu()}),t.EFF(39," Forbidden Cards "),t.k0s(),t.j41(40,"a",30),t.bIt("click",function(){return r.closeMenu()}),t.EFF(41," All Leagues "),t.k0s(),t.j41(42,"a",31),t.bIt("click",function(){return r.closeMenu()}),t.EFF(43," League Table "),t.k0s(),t.j41(44,"a",32),t.bIt("click",function(){return r.closeMenu()}),t.EFF(45," Ranking "),t.k0s(),t.DNE(46,et,5,0,"ng-container",19),t.DNE(47,nt,2,0,"a",20),t.k0s()()()()(),t.DNE(48,at,3,3,"div",33)),2&n&&(t.R7$(7),t.Y8G("ngIf",!r.isAdmin),t.R7$(1),t.Y8G("ngIf",r.isAdmin),t.R7$(1),t.Y8G("ngIf",r.isAdmin),t.R7$(1),t.Y8G("ngIf",r.isLoggedIn&&!r.isAdmin),t.R7$(15),t.Y8G("ngIf",r.isLoggedIn&&!r.isAdmin),t.R7$(1),t.Y8G("ngIf",!r.isLoggedIn),t.R7$(1),t.Y8G("ngIf",r.isLoggedIn),t.R7$(5),t.Y8G("ngClass",t.l_i(11,st,r.isMenuOpen,!r.isMenuOpen)),t.R7$(14),t.Y8G("ngIf",!r.isLoggedIn),t.R7$(1),t.Y8G("ngIf",r.isLoggedIn),t.R7$(1),t.Y8G("ngIf",r.notes.length>0))},dependencies:[k.YU,k.Sq,k.bT,h.Wk,h.wQ],styles:[".navbar[_ngcontent-%COMP%]{position:relative;z-index:9999;background:linear-gradient(135deg,rgba(15,23,42,.95),rgba(30,41,59,.95));-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 4px 20px #0000004d;transition:all .6s ease}nav[_ngcontent-%COMP%]{position:fixed!important;z-index:9999!important;width:100%;top:0;left:0;background:linear-gradient(135deg,rgba(15,23,42,.98),rgba(30,41,59,.98));-webkit-backdrop-filter:blur(25px);backdrop-filter:blur(25px);border-bottom:2px solid rgba(59,130,246,.3);box-shadow:0 8px 40px #0006}.navbar-brand[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#fff!important;text-decoration:none;background:linear-gradient(135deg,#3b82f6,#8b5cf6);-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;transition:all .6s ease;text-shadow:0 2px 4px rgba(0,0,0,.3)}.navbar-brand[_ngcontent-%COMP%]:hover{transform:scale(1.02);filter:brightness(1.1)}.navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#e2e8f0!important;font-weight:500;padding:10px 16px!important;margin:0 4px;border-radius:8px;transition:all .6s ease;position:relative;text-decoration:none}.navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#fff!important;background:rgba(59,130,246,.2);transform:translateY(-1px);box-shadow:0 2px 8px #3b82f633}.navbar-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#fff!important;background:linear-gradient(135deg,#3b82f6,#1d4ed8);box-shadow:0 2px 10px #3b82f64d}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-menu[_ngcontent-%COMP%]{display:block;animation:_ngcontent-%COMP%_fadeInDown .5s ease}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.dropdown-menu[_ngcontent-%COMP%]{background:rgba(15,23,42,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.1);border-radius:12px;box-shadow:0 8px 40px #0006;margin-top:8px}.dropdown-item[_ngcontent-%COMP%]{color:#e2e8f0!important;padding:12px 20px;transition:all .6s ease;border-radius:8px;margin:4px 8px;font-weight:500}.dropdown-item[_ngcontent-%COMP%]:hover{color:#fff!important;background:linear-gradient(135deg,#3b82f6,#1d4ed8);transform:translate(2px)}.navbar-toggler[_ngcontent-%COMP%]{border:none;padding:4px 8px;border-radius:8px;background:rgba(59,130,246,.2);transition:all .6s ease}.navbar-toggler[_ngcontent-%COMP%]:hover{background:rgba(59,130,246,.4);transform:scale(1.02)}.navbar-toggler-icon[_ngcontent-%COMP%]{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}.search-box[_ngcontent-%COMP%]{position:relative;max-width:300px}.search-input[_ngcontent-%COMP%]{background:rgba(0,0,0,.3);border:2px solid rgba(255,255,255,.2);border-radius:25px;color:#fff;padding:8px 40px 8px 16px;transition:all .6s ease;width:100%}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 20px #3b82f64d;background:rgba(0,0,0,.5)}.search-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.search-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#94a3b8;pointer-events:none}.user-avatar[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:2px solid rgba(59,130,246,.5);transition:all .6s ease}.user-avatar[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 0 10px #3b82f666;transform:scale(1.05)}.notification-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;border-radius:50%;width:20px;height:20px;font-size:.75rem;display:flex;align-items:center;justify-content:center;font-weight:700;animation:_ngcontent-%COMP%_pulse 3s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}@media (max-width: 768px){.navbar-brand[_ngcontent-%COMP%]{font-size:1.5rem}.navbar-nav[_ngcontent-%COMP%]{background:rgba(15,23,42,.98);border-radius:12px;margin:10px;padding:10px;box-shadow:0 8px 40px #0006}.navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{margin:4px 0;text-align:center}.search-box[_ngcontent-%COMP%]{margin:10px;max-width:none}}@media (max-width: 480px){.navbar-brand[_ngcontent-%COMP%]{font-size:1.3rem}.navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:8px 12px!important;font-size:.9rem}}\n\n/*# sourceMappingURL=navbar.component.css.map*/"]})}}return s})(),ot=(()=>{class s{constructor(e){this.titleStrategy=e,this.title="Yugi-Oh Tournament",this.navbarHeight=80}ngOnInit(){setTimeout(()=>{this.titleStrategy.setTitle("")},100)}ngOnDestroy(){}onNavbarHeightChange(e){this.navbarHeight=e}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(l))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-root"]],decls:7,vars:5,consts:[[3,"navbarHeightChange"],[1,"relative"],["bdColor","rgba(0, 0, 0, 1)","size","medium","color","#fff","type","square-jelly-box",3,"fullScreen"],[2,"color","white"]],template:function(n,r){1&n&&(t.j41(0,"app-navbar",0),t.bIt("navbarHeightChange",function(d){return r.onNavbarHeightChange(d)}),t.k0s(),t.j41(1,"div",1),t.nrm(2,"router-outlet"),t.k0s(),t.nrm(3,"app-floating-inbox"),t.j41(4,"ngx-spinner",2)(5,"p",3),t.EFF(6,"Loading..."),t.k0s()()),2&n&&(t.R7$(1),t.xc7("margin-top",r.navbarHeight,"px")("min-height","calc(100vh - "+r.navbarHeight+"px)"),t.R7$(3),t.Y8G("fullScreen",!0))},dependencies:[h.n3,c.et,H,it]})}}return s})();var N=i(6443),lt=i(2552),ct=i(9475);let ht=(()=>{class s{constructor(e){this.spinner=e}intercept(e,n){this.spinner.show();const r=localStorage.getItem("token");let o=e;return r&&(o=e.clone({setHeaders:{Authorization:`Bearer ${r}`}})),n.handle(o).pipe((0,ct.j)(()=>{this.spinner.hide()}))}static{this.\u0275fac=function(n){return new(n||s)(t.KVO(c.ex))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();var gt=i(9452),dt=i(5430);let ut=(()=>{class s{constructor(e){this.cacheService=e}intercept(e,n){if("GET"===e.method&&this.shouldCache(e.url)){const r=this.cacheService.get(e.url);if(r)return(0,gt.of)(new N.cS({body:r}))}return n.handle(e)}shouldCache(e){return["/player/ranking","/player","/match","/Message/inbox","/note/notes","/player/players/all","/league/getCurrentLeague"].some(r=>e.includes(r))}static{this.\u0275fac=function(n){return new(n||s)(t.KVO(dt._))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}}return s})();var pt=i(3887);let mt=(()=>{class s{static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275mod=t.$C({type:s,bootstrap:[ot]})}static{this.\u0275inj=t.G2t({providers:[{provide:N.a7,useClass:ht,multi:!0},{provide:N.a7,useClass:ut,multi:!0},c.PO,b.hE,l],imports:[b.Bb,E,N.q1,lt.uj,m._B.forRoot({timeOut:3e3,positionClass:"toast-top-right",preventDuplicates:!0}),c.PO.forRoot({type:"square-jelly-box"}),pt.G]})}}return s})();b.sG().bootstrapModule(mt).catch(s=>{})}},M=>{M.O(0,[502],()=>M(M.s=8068)),M.O()}]);
//# sourceMappingURL=main.bc1878eceb81fdfe.js.map