{"version":3,"file":"971.20d91b126b58e14a.js","mappings":"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","names":["i0","player_r16","_r18","$implicit","ctx_r17","selectPlayer","$event","ctx_r19","confirmDelete","ctx_r15","selectedPlayer","playerId","fullName","PlayersComponent_ul_6_li_1_Template","ctx_r0","players","_r21","ctx_r20","openModal","match_r23","_r26","ctx_r25","updateMatch","matchId","player1Id","ctx_r27","player2Id","ctx_r28","ctx_r29","resetMatch","i_r24","player1Name","player2Name","score1","score2","isCompleted","_c0","ctx_r22","loadingMatches","PlayersComponent_div_9_tr_15_Template","ctx_r2","displayMatches","ctx_r3","totalMessagesLeft","_r31","ctx_r30","openStartLeagueModal","_r33","ctx_r32","showEndLeagueModal","_r35","ctx_r34","onTournamentStageButtonClick","ctx_r6","tournamentStageButtonText","ctx_r7","leagueData","description","getLeagueTypeIcon","typeOfLeague","getLeagueTypeText","getSystemTypeIcon","systemOfLeague","undefined","getSystemTypeText","createdOn","name","league_r36","_r39","ctx_r38","openDeleteLeagueModal","leagueId","_c1","i_r37","leagueName","isFinished","ctx_r8","getLeagueTypeTextForTable","leagueType","getSystemTypeTextForTable","getWinnerForLeague","_r41","ctx_r40","closeDeleteLeagueModal","ctx_r42","deleteConfirmedLeague","ctx_r9","selectedLeagueToDelete","_r44","ctx_r43","showDeleteModal","ctx_r45","deleteConfirmedPlayer","ctx_r10","selectedPlayerToDelete","_r47","ctx_r46","newPlayerName","ctx_r48","closeModal","ctx_r49","addPlayer","ctx_r11","_r52","ctx_r51","newLeague","roundsPerMatch","ctx_r50","_r54","ctx_r53","ctx_r55","ctx_r56","ctx_r57","PlayersComponent_div_66_div_30_Template","ctx_r58","closeStartLeagueModal","ctx_r59","startLeague","ctx_r12","_r61","ctx_r60","ctx_r62","resetTournament","id","_r70","note_r64","ctx_r68","toggleHideNote","_r73","ctx_r71","_r76","ctx_r74","toggleDeleteNote","PlayersComponent_div_68_div_15_div_1_button_5_Template","PlayersComponent_div_68_div_15_div_1_button_6_Template","content","isHidden","PlayersComponent_div_68_div_15_div_1_Template","isDeleted","_r79","ctx_r78","newNote","ctx_r80","sendNote","PlayersComponent_div_68_div_15_Template","ctx_r81","closeNoteModal","ctx_r14","notes","PlayersComponent","constructor","playerService","matchService","toastr","leagueService","noteService","adminDashboardService","this","playerMatches","showModal","isSidebarOpen","showNoteModal","showDeleteLeagueModal","showStartLeagueModal","totalPlayers","totalMatches","totalMatchesLeft","totalMessages","leagues","currentMatches","showTournamentStageButton","tournamentStageButtonAction","requestQueue","isProcessingQueue","showResetModal","ngOnInit","loadEssentialData","ngOnDestroy","getEssentialData","subscribe","next","data","matches","currentLeague","allLeagues","reverse","stats","updateTournamentStageButton","error","err","toggleSidebar","player","loadMatches","getAdminMatches","filter","m","sort","a","b","nameA","toLowerCase","nameB","localeCompare","map","match","forEach","addToQueue","request","push","processQueue","_this","_asyncToGenerator","length","shift","winnerId","Promise","resolve","reject","response","success","message","invalidateCache","deletePlayer","event","stopPropagation","warning","trim","resetLeague","DeleteLeague","find","l","res","note","toggleMarHide","noteId","DeleteNote","openNoteModal","LeagueType","Groups","startGroupStage","groupMatches","stage","TournamentStage","GroupStage","tournamentStage","quarterMatches","QuarterFinals","semiMatches","SemiFinals","finalMatches","Final","allGroupMatchesCompleted","every","allQuarterMatchesCompleted","allSemiMatchesCompleted","startQuarterStage","startSemiFinalStage","startFinalStage","createGroupsAndMatches","startKnockoutStage","startSemiFinals","startFinal","coerceLeagueType","value","Single","Multi","v","coerceSystemType","SystemOfLeague","Points","Classic","type","t","system","s","systemType","league","String","knockoutMatches","finalMatch","i1","i2","i3","i4","i5","i6","selectors","decls","vars","consts","template","rf","ctx","PlayersComponent_ul_6_Template","PlayersComponent_button_7_Template","PlayersComponent_div_9_Template","PlayersComponent_div_17_Template","PlayersComponent_button_18_Template","PlayersComponent_button_19_Template","PlayersComponent_button_20_Template","PlayersComponent_div_23_Template","PlayersComponent_tr_62_Template","PlayersComponent_div_63_Template","PlayersComponent_div_64_Template","PlayersComponent_div_65_Template","PlayersComponent_div_66_Template","PlayersComponent_div_67_Template","PlayersComponent_div_68_Template","_c2","chat_r6","unreadCount","_r10","openChat","senderId","InboxComponent_div_6_div_1_span_6_Template","senderFullName","lastMessage","InboxComponent_div_6_div_1_Template","ctx_r1","playerChats","trackByPlayerId","message_r13","isFromAdmin","sentAt","_r15","closeChat","InboxComponent_div_8_div_12_Template","ctx_r16","sendReply","replyMessages","selectedChat","messages","ctx_r18","navbarHeight","_c3","senderPhoneNumber","trackByMessageId","_c4","InboxComponent","messageService","cdr","selectedPlayerId","loadAdminMessages","updateStatusSubscription","unsubscribe","refreshSubscription","loadFromServer","loadFromCache","getSecondaryData","groupedMessages","groupMessagesBySender","Date","lastMessageDate","getTime","refreshMessages","getAdminMessages","ngAfterViewChecked","messagesContainer","scrollToBottom","loadMessages","getMessages","processMessages","detectChanges","chatMap","msg","isRead","Object","values","chat","lastMsg","toggleMarkMessage","replyContent","sendAdminReply","newMessage","Math","random","toISOString","container","nativeElement","scrollTop","scrollHeight","index","viewQuery","InboxComponent_div_5_Template","InboxComponent_div_6_Template","InboxComponent_div_8_Template","InboxComponent_ng_template_9_Template","_c5","_c6","_r3","player_r7","_r9","openRecordMatchModal","FriendliesComponent_ul_6_li_1_Template","_r13","totalUnreadFriendlyMessages","player_r19","match_r20","_r22","ctx_r21","editMatch","ctx_r23","deleteMatchFromList","playedOn","getPlayerName","player1Score","player2Score","i_r26","_r28","changePage","ctx_r24","currentPage","_r30","FriendliesComponent_div_9_div_70_span_4_Template","ctx_r31","totalPages","FriendliesComponent_div_9_div_1_Template","FriendliesComponent_div_9_div_9_Template","ctx_r35","ctx_r36","filterForm","dateFilter","ctx_r37","onFilterChange","ctx_r39","FriendliesComponent_div_9_option_50_Template","clearFilters","FriendliesComponent_div_9_tr_69_Template","FriendliesComponent_div_9_div_70_Template","DateFilter","AllTime","Today","Last3Days","LastWeek","LastMonth","getAllActivePlayers","getPaginatedMatches","itemsPerPage","min","allMatches","_r42","ctx_r41","_r45","ctx_r44","friendlyPlayerName","ctx_r47","ctx_r4","player_r56","matchForm","_r58","selectPlayer1FromSelect","showPlayer1Select","FriendliesComponent_div_12_div_4_div_5_option_4_Template","ctx_r52","player_r61","_r63","selectPlayer1","FriendliesComponent_div_12_div_4_div_6_div_1_Template","filteredPlayer1Suggestions","_r65","ctx_r64","ctx_r66","searchPlayer1","ctx_r67","showPlayer1Suggestions","hidePlayer1Suggestions","FriendliesComponent_div_12_div_4_div_5_Template","FriendliesComponent_div_12_div_4_div_6_Template","FriendliesComponent_div_12_div_4_div_7_Template","getPlayerByName","player_r73","ctx_r72","_r75","selectPlayer2FromSelect","ctx_r76","showPlayer2Select","FriendliesComponent_div_12_div_5_div_5_option_4_Template","ctx_r69","getOpponentsForPlayerByName","player_r78","_r80","ctx_r79","selectPlayer2","FriendliesComponent_div_12_div_5_div_6_div_1_Template","ctx_r70","filteredPlayer2Suggestions","_r82","ctx_r83","searchPlayer2","ctx_r84","showPlayer2Suggestions","ctx_r85","hidePlayer2Suggestions","FriendliesComponent_div_12_div_5_div_5_Template","FriendliesComponent_div_12_div_5_div_6_Template","FriendliesComponent_div_12_div_5_div_7_Template","selectedPlayerForMatch","FriendliesComponent_div_12_div_4_Template","FriendliesComponent_div_12_div_5_Template","FriendliesComponent_div_12_div_6_Template","FriendliesComponent_div_12_div_7_Template","_r87","ctx_r86","ctx_r88","validateScore","ctx_r89","ctx_r90","ctx_r91","closeRecordMatchModal","ctx_r92","recordNewMatch","ctx_r5","isRecordingMatch","FriendliesComponent","friendlyMatchService","friendlyMessageService","activeTab","showRecordMatchModal","opponentIds","loadPlayers","loadAllMatches","loadUnreadFriendlyMessagesCount","getAllMessages","calculateUnreadCount","console","getAllFriendlyPlayers","calculateStatistics","loadPlayerMatches","getAllFriendlyMatches","playerName","p","addFriendlyPlayerAsync","refreshFriendlyPlayers","deleteFriendlyPlayerAsync","getActivePlayersCount","isActive","getRecentMatches","slice","player1","player2","matchData","recordFriendlyMatchAsync","refreshFriendlyMatches","getOpponentsForPlayer","ceil","loadFilteredMatchesFromCache","filteredMatches","now","cutoffDate","getFullYear","getMonth","getDate","selectedPlayerName","reorderMatchesForSelectedPlayer","opponentNames","includes","loadFilteredMatches","page","pageSize","getFilteredMatches","result","totalCount","startIndex","target","parseInt","setTimeout","updateFriendlyMatchAsync","confirm","deleteFriendlyMatchAsync","FriendliesComponent_ul_6_Template","FriendliesComponent_button_7_Template","FriendliesComponent_div_9_Template","FriendliesComponent_div_10_Template","FriendliesComponent_div_11_Template","FriendliesComponent_div_12_Template","FriendlyInboxComponent_div_6_div_1_span_6_Template","FriendlyInboxComponent_div_6_div_1_Template","FriendlyInboxComponent_div_8_div_12_Template","FriendlyInboxComponent","loadFriendlyMessages","unreadMessages","info","parsedId","isNaN","playerFullName","markMessageAsRead","messageType","FriendlyInboxComponent_div_5_Template","FriendlyInboxComponent_div_6_Template","FriendlyInboxComponent_div_8_Template","FriendlyInboxComponent_ng_template_9_Template","activeTournament","_r29","tournament_r20","openCreateTeamModal","getRemainingTeams","startTournament","_r36","finishTournament","deleteTournament","playerName_r44","team_r41","openReplacePlayerModal","TeamsDashboardComponent_div_29_div_4_div_1_div_21_div_4_span_4_Template","TeamsDashboardComponent_div_29_div_4_div_1_div_21_div_4_button_6_Template","teamName","getTeamPlayersNames","status","TeamsDashboardComponent_div_29_div_4_div_1_div_21_div_4_Template","teams","TeamsDashboardComponent_div_29_div_4_div_1_button_17_Template","TeamsDashboardComponent_div_29_div_4_div_1_button_18_Template","TeamsDashboardComponent_div_29_div_4_div_1_button_19_Template","TeamsDashboardComponent_div_29_div_4_div_1_button_20_Template","TeamsDashboardComponent_div_29_div_4_div_1_div_21_Template","TeamsDashboardComponent_div_29_div_4_div_1_div_22_Template","getStatusColor","teamCount","playersPerTeam","systemOfScoring","canStartTournament","canFinishTournament","canDeleteTournament","TeamsDashboardComponent_div_29_div_4_div_1_Template","tournaments","TeamsDashboardComponent_div_29_div_3_Template","TeamsDashboardComponent_div_29_div_4_Template","player_r51","_r53","TeamsDashboardComponent_div_40_div_1_Template","filteredPlayers","ctx_r54","playerSearchTerm","TeamsDashboardComponent_div_41_p_1_Template","TeamsDashboardComponent_div_41_p_2_Template","_r57","closeCreateTournamentModal","createTournamentForm","ctx_r61","ctx_r63","ctx_r65","createTournament","isCreatingTournament","player_r70","togglePlayerSelection","TeamsDashboardComponent_div_43_div_15_div_1_div_5_Template","isPlayerSelected","multiParticipations","multiTitlesWon","TeamsDashboardComponent_div_43_div_15_div_1_Template","availablePlayers","closeCreateTeamModal","ctx_r77","createTeamForm","TeamsDashboardComponent_div_43_div_13_Template","TeamsDashboardComponent_div_43_div_14_Template","TeamsDashboardComponent_div_43_div_15_Template","createTeam","playerIds","isLoadingPlayers","isCreatingTeam","showAddPlayerModal","ctx_r87","addNewPlayer","isAddingPlayer","_r90","closeRecordResultModal","ctx_r93","recordingScore1","ctx_r94","recordingScore2","TeamsDashboardComponent_div_45_div_15_Template","ctx_r95","ctx_r96","recordMatchResult","selectedPlayer1Id","selectedPlayer2Id","isRecordingResult","match_r101","_r109","ctx_r107","openRecordResultModal","TeamsDashboardComponent_div_46_div_15_div_1_div_7_button_2_Template","ctx_r103","_r112","ctx_r110","undoMatchResult","TeamsDashboardComponent_div_46_div_15_div_1_div_6_Template","TeamsDashboardComponent_div_46_div_15_div_1_div_7_Template","TeamsDashboardComponent_div_46_div_15_div_1_div_8_Template","ctx_r100","TeamsDashboardComponent_div_46_div_15_div_1_Template","ctx_r98","filteredPlayerMatches","ctx_r113","opponentSearchTerm","TeamsDashboardComponent_div_46_div_16_p_1_Template","TeamsDashboardComponent_div_46_div_16_p_2_Template","ctx_r99","_r116","ctx_r115","closePlayerMatchesModal","ctx_r118","ctx_r119","ctx_r120","filterPlayerMatches","TeamsDashboardComponent_div_46_div_14_Template","TeamsDashboardComponent_div_46_div_15_Template","TeamsDashboardComponent_div_46_div_16_Template","isLoadingMatches","_r122","ctx_r121","closeConfirmStartTournamentModal","ctx_r123","confirmStartTournament","tournamentToConfirm","_r125","ctx_r124","closeConfirmFinishTournamentModal","ctx_r126","confirmFinishTournament","ctx_r13","_r128","ctx_r127","closeConfirmDeleteTournamentModal","ctx_r129","confirmDeleteTournament","_r131","ctx_r130","closeConfirmUndoMatchModal","ctx_r132","confirmUndoMatchResult","matchToUndo","player_r137","_r140","ctx_r139","selectPlayerToReplace","TeamsDashboardComponent_div_51_div_10_div_5_Template","ctx_r133","replacePlayerForm","replacedPlayerId","player_r142","_r145","ctx_r144","selectNewPlayer","TeamsDashboardComponent_div_51_div_16_div_1_div_5_Template","ctx_r141","newPlayerId","TeamsDashboardComponent_div_51_div_16_div_1_Template","ctx_r136","availablePlayersForReplacement","_r147","ctx_r146","closeReplacePlayerModal","ctx_r149","TeamsDashboardComponent_div_51_div_10_Template","TeamsDashboardComponent_div_51_div_14_Template","TeamsDashboardComponent_div_51_div_15_Template","TeamsDashboardComponent_div_51_div_16_Template","ctx_r150","ctx_r151","replacePlayer","selectedTeamForReplacement","isReplacingPlayer","routes","path","component","title","TeamsDashboardComponent","multiTournamentService","tournamentMatches","showCreateTournamentModal","showCreateTeamModal","showRecordResultModal","showPlayerMatchesModal","showReplacePlayerModal","showConfirmStartTournamentModal","showConfirmFinishTournamentModal","showConfirmDeleteTournamentModal","showConfirmUndoMatchModal","selectedMatchId","isLoadingTournaments","loadTournaments","loadAvailablePlayers","getAllTournaments","loadTournamentMatches","openCreateTournamentModal","tournament","getAllPlayers","getActiveTournamentMatches","getPlayerMatches","openConfirmStartTournamentModal","multiTournamentId","openConfirmFinishTournamentModal","openConfirmDeleteTournamentModal","indexOf","splice","parseFloat","requestBody","openConfirmUndoMatchModal","multiMatchId","getTrophyIcon","position","fixture","team","filterPlayers","searchTerm","searchLower","log","loadAvailablePlayersForReplacement","currentTeamPlayerIds","some","multiTeamId","complete","TeamsDashboardComponent_p_26_Template","TeamsDashboardComponent_p_27_Template","TeamsDashboardComponent_div_28_Template","TeamsDashboardComponent_div_29_Template","TeamsDashboardComponent_div_39_Template","TeamsDashboardComponent_div_40_Template","TeamsDashboardComponent_div_41_Template","TeamsDashboardComponent_div_42_Template","TeamsDashboardComponent_div_43_Template","TeamsDashboardComponent_div_44_Template","TeamsDashboardComponent_div_45_Template","TeamsDashboardComponent_div_46_Template","TeamsDashboardComponent_div_47_Template","TeamsDashboardComponent_div_48_Template","TeamsDashboardComponent_div_49_Template","TeamsDashboardComponent_div_50_Template","TeamsDashboardComponent_div_51_Template","AdminRoutingModule","RouterModule","forChild","AdminModule","CommonModule","FormsModule","HttpClientModule","PlayerModule","SharedModule"],"sourceRoot":"webpack:///","sources":["./src/app/admin/players/players.component.html","./src/app/admin/players/players.component.ts","./src/app/admin/inbox/inbox.component.html","./src/app/admin/inbox/inbox.component.ts","./src/app/admin/friendlies/friendlies.component.html","./src/app/admin/friendlies/friendlies.component.ts","./src/app/admin/friendlies/friendly-inbox/friendly-inbox.component.html","./src/app/admin/friendlies/friendly-inbox/friendly-inbox.component.ts","./src/app/admin/teams-dashboard/teams-dashboard.component.html","./src/app/admin/admin-routing.module.ts","./src/app/admin/teams-dashboard/teams-dashboard.component.ts","./src/app/admin/admin.module.ts"],"sourcesContent":["<!-- Admin Update Status Component -->\r\n\r\n<div class=\"block sm:flex transition-all duration-600\">\r\n  <!-- Sidebar -->\r\n  <div\r\n    class=\"bg-black bg-opacity-50 backdrop-blur-sm text-white transition-all duration-600\"\r\n    [ngClass]=\"{\r\n      'w-64 p-4 sm:min-h-screen': isSidebarOpen,\r\n      'w-0 p-0': !isSidebarOpen\r\n    }\"\r\n  >\r\n    <h2\r\n      class=\"text-lg font-bold mb-4 flex justify-between overflow-hidden text-white\"\r\n    >\r\n      Players\r\n      <button (click)=\"toggleSidebar()\" class=\"text-gray-300 text-3xl\">\r\n        ×\r\n      </button>\r\n    </h2>\r\n    <ul *ngIf=\"isSidebarOpen\">\r\n      <li\r\n        *ngFor=\"let player of players\"\r\n        class=\"flex items-center justify-between p-2 cursor-pointer rounded-md hover:bg-gray-700\"\r\n        [class.bg-blue-600]=\"selectedPlayer?.playerId === player.playerId\"\r\n        (click)=\"selectPlayer(player)\"\r\n      >\r\n        <span class=\"text-white\">{{ player.fullName }}</span>\r\n        <button\r\n          (click)=\"confirmDelete(player, $event)\"\r\n          class=\"bg-red-600 px-2 py-1 text-sm rounded text-white hover:bg-red-700 transition\"\r\n        >\r\n          X\r\n        </button>\r\n      </li>\r\n    </ul>\r\n    <button\r\n      *ngIf=\"isSidebarOpen\"\r\n      class=\"mt-4 w-full bg-green-600 p-2 rounded text-white hover:bg-green-700 transition\"\r\n      (click)=\"openModal()\"\r\n    >\r\n      Add Player\r\n    </button>\r\n  </div>\r\n\r\n  <!-- Main Content -->\r\n  <div\r\n    class=\"sm:flex-1 sm:p-2 transition-all duration-600 sm:container sm:mx-auto\"\r\n  >\r\n    <div *ngIf=\"selectedPlayer\" class=\"sm:w-4/6 mx-auto\">\r\n      <h2 class=\"text-2xl font-bold mb-4 text-center text-white\">\r\n        Matches for {{ selectedPlayer.fullName }}\r\n      </h2>\r\n\r\n      <table class=\"w-full border-collapse border border-gray-600 text-center\">\r\n        <thead>\r\n          <tr class=\"bg-black bg-opacity-50 backdrop-blur-sm text-white\">\r\n            <th class=\"border border-gray-600 p-2\">Player 1</th>\r\n            <th class=\"border border-gray-600 p-2\">Player 2</th>\r\n            <th class=\"border border-gray-600 p-2\">Result</th>\r\n            <th class=\"border border-gray-600 p-2\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr\r\n            *ngFor=\"let match of displayMatches; let i = index\"\r\n            class=\"border border-gray-600\"\r\n            [ngClass]=\"i % 2 === 0 ? 'bg-gray-900' : 'bg-gray-950'\"\r\n          >\r\n            <td class=\"p-2 font-bold text-white\">{{ match.player1Name }}</td>\r\n            <td class=\"p-2 font-bold text-white\">{{ match.player2Name }}</td>\r\n            <td class=\"p-2 font-bold text-white\">\r\n              {{ match.score1 }} - {{ match.score2 }}\r\n            </td>\r\n            <td class=\"p-2\">\r\n              <button\r\n                class=\"bg-blue-600 px-2 py-1 rounded text-white hover:bg-blue-700 transition-all\"\r\n                (click)=\"updateMatch(match.matchId, match.player1Id)\"\r\n                [disabled]=\"match.isCompleted\"\r\n                [ngClass]=\"{\r\n                  'opacity-50 cursor-not-allowed': match.isCompleted\r\n                }\"\r\n              >\r\n                {{ loadingMatches[match.matchId] ? \"Load..\" : \"Win P1\" }}\r\n              </button>\r\n              <button\r\n                class=\"bg-blue-600 px-2 py-1 rounded text-white mx-1 hover:bg-blue-700 transition-all\"\r\n                (click)=\"updateMatch(match.matchId, match.player2Id)\"\r\n                [disabled]=\"match.isCompleted\"\r\n                [ngClass]=\"{\r\n                  'opacity-50 cursor-not-allowed': match.isCompleted\r\n                }\"\r\n              >\r\n                {{ loadingMatches[match.matchId] ? \"Load..\" : \"Win P2\" }}\r\n              </button>\r\n              <button\r\n                class=\"bg-yellow-600 px-2 py-1 rounded text-white hover:bg-yellow-700 transition-all\"\r\n                (click)=\"updateMatch(match.matchId, null)\"\r\n                [disabled]=\"match.isCompleted\"\r\n                [ngClass]=\"{\r\n                  'opacity-50 cursor-not-allowed': match.isCompleted\r\n                }\"\r\n              >\r\n                {{ loadingMatches[match.matchId] ? \"Load..\" : \"Draw\" }}\r\n              </button>\r\n              <button\r\n                class=\"bg-gray-600 px-2 py-1 rounded text-white ml-2 hover:bg-gray-700 transition-all\"\r\n                (click)=\"resetMatch(match.matchId)\"\r\n              >\r\n                {{ loadingMatches[match.matchId] ? \"Load..\" : \"Undo\" }}\r\n              </button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <hr class=\"my-3 border-gray-600\" />\r\n\r\n    <!-- القائمة الأولية -->\r\n    <div>\r\n      <div class=\"grid grid-cols-2 lg:grid-cols-4 gap-4 pt-5\">\r\n        <button\r\n          (click)=\"toggleSidebar()\"\r\n          class=\"bg-blue-600 text-white px-3 py-2 rounded mb-4 hover:bg-blue-700 transition\"\r\n        >\r\n          ☰ Players\r\n        </button>\r\n        <button\r\n          routerLink=\"/admin/inbox\"\r\n          class=\"bg-orange-600 hover:bg-orange-700 text-white mb-4 px-3 py-2 rounded transition-all relative\"\r\n        >\r\n          Inbox\r\n          <div\r\n            class=\"absolute -top-2 -right-2 w-[30px] h-[30px] rounded-full bg-green-600 flex justify-center items-center\"\r\n            *ngIf=\"totalMessagesLeft > 0\"\r\n          >\r\n            <h4 class=\"text-white font-bold\">{{ totalMessagesLeft }}</h4>\r\n          </div>\r\n        </button>\r\n\r\n        <button\r\n          class=\"bg-green-600 text-white px-3 py-2 rounded mb-4 hover:bg-green-700 transition\"\r\n          (click)=\"openStartLeagueModal()\"\r\n          *ngIf=\"leagueData == null\"\r\n        >\r\n          Start New League\r\n        </button>\r\n        <button\r\n          class=\"bg-red-600 text-white px-3 py-2 rounded mb-4 hover:bg-red-700 transition\"\r\n          *ngIf=\"leagueData != null\"\r\n          (click)=\"showEndLeagueModal = true\"\r\n          s\r\n        >\r\n          End League\r\n        </button>\r\n        <!-- Tournament Stage Button -->\r\n        <button\r\n          class=\"bg-purple-600 text-white px-3 py-2 rounded mb-4 hover:bg-purple-700 transition font-bold\"\r\n          *ngIf=\"showTournamentStageButton && leagueData != null\"\r\n          (click)=\"onTournamentStageButtonClick()\"\r\n        >\r\n          🏆 {{ tournamentStageButtonText }}\r\n        </button>\r\n        <button\r\n          class=\"bg-indigo-600 text-white px-3 py-2 rounded mb-4 hover:bg-indigo-700 transition\"\r\n          (click)=\"openNoteModal()\"\r\n        >\r\n          Notes\r\n        </button>\r\n      </div>\r\n\r\n      <div\r\n        class=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\"\r\n        *ngIf=\"leagueData\"\r\n      >\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">\r\n            League Description\r\n          </h3>\r\n          <p class=\"font-bold text-gray-300\">{{ leagueData.description }}</p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">نوع البطولة</h3>\r\n          <p class=\"font-bold text-gray-300\">\r\n            <span>{{ getLeagueTypeIcon(leagueData.typeOfLeague) }}</span>\r\n            {{ getLeagueTypeText(leagueData.typeOfLeague) }}\r\n          </p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">نظام البطولة</h3>\r\n          <p class=\"font-bold text-gray-300\">\r\n            <span>{{ getSystemTypeIcon(leagueData.systemOfLeague) }}</span>\r\n            {{\r\n              leagueData.systemOfLeague !== undefined\r\n                ? getSystemTypeText(leagueData.systemOfLeague)\r\n                : \"غير محدد\"\r\n            }}\r\n          </p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">Start Date</h3>\r\n          <p class=\"font-bold text-gray-300\">\r\n            {{ leagueData.createdOn | date : \"fullDate\" }}\r\n          </p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">League Name</h3>\r\n          <p class=\"font-bold text-gray-300\">{{ leagueData.name }}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 container mx-auto\">\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">\r\n            Remaining Matches\r\n          </h3>\r\n          <p class=\"text-3xl font-bold text-red-500\">{{ totalMatchesLeft }}</p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">Total Matches</h3>\r\n          <p class=\"text-3xl font-bold text-green-500\">{{ totalMatches }}</p>\r\n        </div>\r\n        <div\r\n          class=\"bg-black bg-opacity-50 backdrop-blur-sm shadow-md rounded p-6 text-center\"\r\n        >\r\n          <h3 class=\"text-lg font-semibold mb-2 text-white\">Total Players</h3>\r\n          <p class=\"text-3xl font-bold text-blue-500\">{{ totalPlayers }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- كل البطولات -->\r\n    <div class=\"text-center\">\r\n      <h2\r\n        class=\"mb-4 text-4xl font-extrabold leading-none tracking-tight md:text-4xl lg:text-4xl text-white\"\r\n      >\r\n        All Leagues\r\n      </h2>\r\n\r\n      <div class=\"max-h-[350px] overflow-x-auto\">\r\n        <table class=\"min-w-full divide-y-2 divide-gray-600\">\r\n          <thead class=\"sticky top-0 bg-black bg-opacity-50 backdrop-blur-sm\">\r\n            <tr class=\"*:font-medium *:text-white\">\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">League Name</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">League Status</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">League Type</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">League System</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">League Date</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">Winner</th>\r\n              <th class=\"px-3 py-2 whitespace-nowrap\">Delete</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"divide-y divide-gray-600\">\r\n            <tr\r\n              *ngFor=\"let league of leagues; let i = index\"\r\n              class=\"*:font-bold *:first:font-medium\"\r\n              [ngClass]=\"{\r\n                'bg-gray-900': i % 2 === 0,\r\n                'bg-gray-950': i % 2 !== 0\r\n              }\"\r\n            >\r\n              <td class=\"px-3 py-2 whitespace-nowrap text-white\">\r\n                {{ league.leagueName }}\r\n              </td>\r\n              <td\r\n                class=\"px-3 py-2 whitespace-nowrap\"\r\n                [class.text-green-500]=\"!league.isFinished\"\r\n                [class.text-red-500]=\"league.isFinished\"\r\n              >\r\n                {{ !league.isFinished ? \"Live Now!!\" : \"Finished\" }}\r\n              </td>\r\n\r\n              <td class=\"px-3 py-2 whitespace-nowrap text-white\">\r\n                {{ getLeagueTypeTextForTable(league.leagueType) }}\r\n              </td>\r\n              <td class=\"px-3 py-2 whitespace-nowrap text-white\">\r\n                {{ getSystemTypeTextForTable(league.systemOfLeague) }}\r\n              </td>\r\n              <td class=\"px-3 py-2 whitespace-nowrap text-white\">\r\n                {{ league.createdOn | date : \"yyyy/MM/dd\" }}\r\n              </td>\r\n              <td class=\"px-3 py-2 whitespace-nowrap text-white\">\r\n                {{ getWinnerForLeague(league) }}\r\n              </td>\r\n              <td class=\"px-3 py-2 whitespace-nowrap\">\r\n                <button\r\n                  (click)=\"openDeleteLeagueModal(league.leagueId)\"\r\n                  class=\"bg-red-600 text-white px-3 py-2 rounded hover:bg-red-700 transition\"\r\n                >\r\n                  Delete League\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Delete League Modal -->\r\n  <div\r\n    *ngIf=\"showDeleteLeagueModal\"\r\n    class=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\"\r\n  >\r\n    <div\r\n      class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg shadow-lg w-96\"\r\n    >\r\n      <h2 class=\"text-xl font-bold text-white mb-4\">Confirm Delete</h2>\r\n      <p class=\"text-gray-300 mb-6\">\r\n        Are you sure you want to delete league \"{{\r\n          selectedLeagueToDelete?.leagueName\r\n        }}\"?\r\n      </p>\r\n      <div class=\"flex justify-end space-x-4\">\r\n        <button\r\n          (click)=\"closeDeleteLeagueModal()\"\r\n          class=\"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          (click)=\"deleteConfirmedLeague()\"\r\n          class=\"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition\"\r\n        >\r\n          Delete\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Delete Confirmation Modal -->\r\n  <div\r\n    *ngIf=\"showDeleteModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n  >\r\n    <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg\">\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Confirm Delete</h2>\r\n      <p class=\"text-gray-300\">\r\n        Are you sure you want to delete\r\n        <strong>{{ selectedPlayerToDelete?.fullName }}</strong\r\n        >?\r\n      </p>\r\n      <div class=\"mt-4 flex justify-end\">\r\n        <button\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded mr-2 hover:bg-gray-700 transition\"\r\n          (click)=\"showDeleteModal = false\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          class=\"bg-red-600 px-4 py-2 text-white rounded hover:bg-red-700 transition\"\r\n          (click)=\"deleteConfirmedPlayer()\"\r\n        >\r\n          Delete\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Add Player Modal -->\r\n  <div\r\n    *ngIf=\"showModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n  >\r\n    <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg\">\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Add New Player</h2>\r\n      <input\r\n        type=\"text\"\r\n        [(ngModel)]=\"newPlayerName\"\r\n        class=\"border border-gray-600 p-2 w-full bg-gray-800 text-white rounded placeholder-gray-400\"\r\n        placeholder=\"Enter player name\"\r\n      />\r\n      <div class=\"mt-4 flex justify-end\">\r\n        <button\r\n          class=\"bg-red-600 px-4 py-2 text-white rounded mr-2 hover:bg-red-700 transition\"\r\n          (click)=\"closeModal()\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n          (click)=\"addPlayer()\"\r\n        >\r\n          Add\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Start League Modal -->\r\n  <div\r\n    *ngIf=\"showStartLeagueModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n  >\r\n    <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg w-96\">\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Start New League</h2>\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >League Name</label\r\n        >\r\n        <input\r\n          type=\"text\"\r\n          [(ngModel)]=\"newLeague.name\"\r\n          class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n          placeholder=\"Enter league name\"\r\n        />\r\n      </div>\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >League Description</label\r\n        >\r\n        <textarea\r\n          [(ngModel)]=\"newLeague.description\"\r\n          class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n          placeholder=\"Enter league description\"\r\n          rows=\"3\"\r\n        ></textarea>\r\n      </div>\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >League Type</label\r\n        >\r\n        <select\r\n          [(ngModel)]=\"newLeague.typeOfLeague\"\r\n          class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white\"\r\n        >\r\n          <option [ngValue]=\"0\">Single</option>\r\n          <option [ngValue]=\"1\">Multi</option>\r\n          <option [ngValue]=\"2\">Groups</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >System Of League</label\r\n        >\r\n        <select\r\n          [(ngModel)]=\"newLeague.systemOfLeague\"\r\n          class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white\"\r\n        >\r\n          <option [ngValue]=\"0\">Points</option>\r\n          <option [ngValue]=\"1\">Classic</option>\r\n        </select>\r\n      </div>\r\n      <!-- Rounds Per Match field - only shown when Points system is selected -->\r\n      <div class=\"mb-4\" *ngIf=\"newLeague.systemOfLeague === 0\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >Rounds Per Match</label\r\n        >\r\n        <input\r\n          type=\"number\"\r\n          [(ngModel)]=\"newLeague.roundsPerMatch\"\r\n          min=\"1\"\r\n          max=\"10\"\r\n          class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n          placeholder=\"Enter number of rounds per match (e.g., 3)\"\r\n        />\r\n        <small class=\"text-gray-400 text-xs mt-1 block\">\r\n          Number of rounds each player will play in a match (Points system only)\r\n        </small>\r\n      </div>\r\n      <div class=\"mt-4 flex justify-end\">\r\n        <button\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded mr-2 hover:bg-gray-700 transition\"\r\n          (click)=\"closeStartLeagueModal()\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n          (click)=\"startLeague()\"\r\n        >\r\n          Start League\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- End League Confirmation Modal -->\r\n  <div\r\n    *ngIf=\"showEndLeagueModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n  >\r\n    <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg\">\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Confirm End League</h2>\r\n      <p class=\"text-gray-300\">\r\n        Are you sure you want to end the current league? This action cannot be\r\n        undone.\r\n      </p>\r\n      <div class=\"mt-4 flex justify-end\">\r\n        <button\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded mr-2 hover:bg-gray-700 transition\"\r\n          (click)=\"showEndLeagueModal = false\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          class=\"bg-red-600 px-4 py-2 text-white rounded hover:bg-red-700 transition\"\r\n          (click)=\"resetTournament(leagueData!.id)\"\r\n        >\r\n          Confirm End\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Notes Modal -->\r\n  <div\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    *ngIf=\"showNoteModal\"\r\n  >\r\n    <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-4 rounded-lg\">\r\n      <div>\r\n        <h2 class=\"font-bold text-white text-center\">Add New Note</h2>\r\n        <div>\r\n          <label for=\"Notes\">\r\n            <span class=\"text-sm font-medium text-gray-300\">Notes</span>\r\n            <div class=\"relative m-2 overflow-hidden rounded border-gray-600\">\r\n              <textarea\r\n                id=\"Notes\"\r\n                class=\"w-full resize-none p-3 border border-gray-600 bg-gray-800 text-white placeholder-gray-400\"\r\n                rows=\"4\"\r\n                [(ngModel)]=\"newNote\"\r\n              ></textarea>\r\n              <div class=\"flex items-center justify-end gap-2 p-1.5\">\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"rounded p-2 font-bold text-white bg-green-600 hover:bg-green-700 transition\"\r\n                  (click)=\"sendNote()\"\r\n                >\r\n                  Save\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <div class=\"p-6\">\r\n        <div *ngFor=\"let note of notes\">\r\n          <div\r\n            class=\"mt-4 flex items-center justify-end\"\r\n            *ngIf=\"note.isDeleted == false\"\r\n          >\r\n            <p class=\"font-bold px-3 text-white\">\r\n              {{ note.content }}\r\n            </p>\r\n            <button\r\n              class=\"bg-red-600 px-4 py-2 text-white rounded mr-2 hover:bg-red-700 transition\"\r\n              (click)=\"toggleDeleteNote(note.id)\"\r\n            >\r\n              Delete\r\n            </button>\r\n            <button\r\n              class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n              (click)=\"toggleHideNote(note)\"\r\n              *ngIf=\"note.isHidden == true\"\r\n            >\r\n              Show\r\n            </button>\r\n            <button\r\n              class=\"bg-purple-600 px-4 py-2 text-white rounded hover:bg-purple-700 transition\"\r\n              (click)=\"toggleHideNote(note)\"\r\n              *ngIf=\"note.isHidden == false\"\r\n            >\r\n              Hide\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <button\r\n        class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        (click)=\"closeNoteModal()\"\r\n      >\r\n        Cancel\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { MatchService } from 'src/app/core/services/match.service';\r\nimport { PlayerService } from './../../core/services/player.service';\r\nimport { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport {\r\n  Player,\r\n  Match,\r\n  StartLeagueDto,\r\n  League,\r\n  AllLeagueRank,\r\n  Note,\r\n  TournamentStage,\r\n  LeagueType,\r\n  SystemOfLeague,\r\n} from 'src/app/models/interfaces';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { LeagueService } from 'src/app/core/services/league.service';\r\nimport { NoteService } from 'src/app/core/services/note.service';\r\nimport {\r\n  AdminDashboardService,\r\n  AdminDashboardData,\r\n} from 'src/app/core/services/admin-dashboard.service';\r\n\r\n@Component({\r\n  selector: 'app-players',\r\n  templateUrl: './players.component.html',\r\n  styleUrls: ['./players.component.css'],\r\n})\r\nexport class PlayersComponent implements OnInit, OnDestroy {\r\n  // Main data properties\r\n  players: Player[] = [];\r\n  selectedPlayer: Player | null = null;\r\n  playerMatches: Match[] = [];\r\n  displayMatches: Match[] = [];\r\n  notes: Note[] = [];\r\n\r\n  // UI state properties\r\n  showModal = false;\r\n  newPlayerName = '';\r\n  isSidebarOpen = false;\r\n  showDeleteModal = false;\r\n  showNoteModal = false;\r\n  showDeleteLeagueModal = false;\r\n  showEndLeagueModal = false;\r\n  loadingMatches: { [matchId: number]: boolean } = {};\r\n\r\n  // League management properties\r\n  leagueData: League | null = null;\r\n  showStartLeagueModal: boolean = false;\r\n  newLeague: StartLeagueDto = {\r\n    name: '',\r\n    description: '',\r\n    typeOfLeague: 0,\r\n    systemOfLeague: 0,\r\n    roundsPerMatch: 3, // Default value for Points system\r\n  };\r\n\r\n  // Statistics properties\r\n  totalMessagesLeft: number = 0;\r\n  totalPlayers: number = 0;\r\n  totalMatches: number = 0;\r\n  totalMatchesLeft: number = 0;\r\n  totalMessages: number = 0;\r\n  leagues: AllLeagueRank[] = [];\r\n  newNote: string = '';\r\n  selectedLeagueToDelete: AllLeagueRank | null = null;\r\n\r\n  // Tournament stage management properties\r\n  currentMatches: Match[] = [];\r\n  showTournamentStageButton = false;\r\n  tournamentStageButtonText = '';\r\n  tournamentStageButtonAction: (() => void) | null = null;\r\n\r\n  // Queue management properties\r\n  private requestQueue: Array<() => Promise<void>> = [];\r\n  private isProcessingQueue = false;\r\n  showResetModal: boolean = false;\r\n\r\n  constructor(\r\n    private playerService: PlayerService,\r\n    private matchService: MatchService,\r\n    private toastr: ToastrService,\r\n    private leagueService: LeagueService,\r\n    private noteService: NoteService,\r\n    private adminDashboardService: AdminDashboardService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    // تحميل البيانات الأساسية مع Smart Caching\r\n    this.loadEssentialData();\r\n  }\r\n\r\n  ngOnDestroy(): void {}\r\n\r\n  private loadEssentialData(): void {\r\n    this.adminDashboardService.getEssentialData().subscribe({\r\n      next: (data: AdminDashboardData) => {\r\n        // ✅ عرض جميع البيانات فوراً من الكاش\r\n        this.players = data.players;\r\n        this.currentMatches = data.matches;\r\n        this.leagueData = data.currentLeague;\r\n        this.leagues = data.allLeagues.reverse();\r\n\r\n        this.notes = data.notes;\r\n\r\n        // ✅ عرض إحصائيات كاملة بما فيها عدد الرسائل\r\n        this.totalPlayers = data.stats.totalPlayers;\r\n        this.totalMatches = data.stats.totalMatches;\r\n        this.totalMatchesLeft = data.stats.totalMatchesLeft;\r\n        this.totalMessagesLeft = data.stats.totalMessagesLeft;\r\n\r\n        // Update tournament stage button\r\n        this.updateTournamentStageButton();\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error('حدث خطأ أثناء تحميل البيانات');\r\n      },\r\n    });\r\n  }\r\n\r\n  toggleSidebar(): void {\r\n    this.isSidebarOpen = !this.isSidebarOpen;\r\n    this.selectedPlayer = null;\r\n  }\r\n\r\n  selectPlayer(player: Player): void {\r\n    this.selectedPlayer = player;\r\n    this.loadMatches();\r\n  }\r\n\r\n  loadMatches(): void {\r\n    if (!this.selectedPlayer) return;\r\n    this.matchService.getAdminMatches().subscribe((matches) => {\r\n      this.playerMatches = matches\r\n        .filter(\r\n          (m) =>\r\n            m.player1Id === this.selectedPlayer!.playerId ||\r\n            m.player2Id === this.selectedPlayer!.playerId\r\n        )\r\n        .sort((a, b) => {\r\n          const nameA =\r\n            (a.player1Id === this.selectedPlayer!.playerId\r\n              ? a.player2Name\r\n              : a.player1Name\r\n            )?.toLowerCase() ?? '';\r\n          const nameB =\r\n            (b.player1Id === this.selectedPlayer!.playerId\r\n              ? b.player2Name\r\n              : b.player1Name\r\n            )?.toLowerCase() ?? '';\r\n          return nameA.localeCompare(nameB);\r\n        });\r\n      this.displayMatches = this.playerMatches.map((match) => {\r\n        if (match.player2Id === this.selectedPlayer!.playerId) {\r\n          return {\r\n            ...match,\r\n            player1Name: match.player2Name,\r\n            player2Name: match.player1Name,\r\n            score1: match.score2,\r\n            score2: match.score1,\r\n            player1Id: match.player2Id,\r\n            player2Id: match.player1Id,\r\n          };\r\n        }\r\n        return { ...match };\r\n      });\r\n      this.playerMatches.forEach((match) => {\r\n        this.loadingMatches[match.matchId] = false;\r\n      });\r\n    });\r\n  }\r\n\r\n  private addToQueue(request: () => Promise<void>): void {\r\n    this.requestQueue.push(request);\r\n    this.processQueue();\r\n  }\r\n\r\n  private async processQueue(): Promise<void> {\r\n    if (this.isProcessingQueue || this.requestQueue.length === 0) return;\r\n\r\n    this.isProcessingQueue = true;\r\n    const request = this.requestQueue.shift();\r\n\r\n    if (request) {\r\n      try {\r\n        await request();\r\n      } catch (error) {}\r\n    }\r\n\r\n    this.isProcessingQueue = false;\r\n    this.processQueue();\r\n  }\r\n\r\n  updateMatch(matchId: number, winnerId: number | null) {\r\n    this.loadingMatches[matchId] = true;\r\n\r\n    this.addToQueue(\r\n      () =>\r\n        new Promise<void>((resolve, reject) => {\r\n          this.matchService.updateMatch(matchId, winnerId).subscribe({\r\n            next: (response) => {\r\n              if (response.success) {\r\n                this.toastr.success(response.message);\r\n                // Invalidate cache and reload essential data\r\n                this.adminDashboardService.invalidateCache('essential');\r\n                this.loadEssentialData();\r\n                this.loadMatches();\r\n              } else {\r\n                this.toastr.error(response.message);\r\n              }\r\n              this.loadingMatches[matchId] = false;\r\n              resolve();\r\n            },\r\n            error: (error) => {\r\n              this.toastr.error(error.error.message);\r\n              this.loadingMatches[matchId] = false;\r\n              reject(error);\r\n            },\r\n          });\r\n        })\r\n    );\r\n  }\r\n\r\n  resetMatch(matchId: number) {\r\n    this.loadingMatches[matchId] = true;\r\n\r\n    this.addToQueue(\r\n      () =>\r\n        new Promise<void>((resolve, reject) => {\r\n          this.matchService.resetMatch(matchId).subscribe({\r\n            next: (response) => {\r\n              if (response.success) {\r\n                this.toastr.success(response.message);\r\n                this.loadMatches();\r\n              } else {\r\n                this.toastr.error(response.message, 'Error');\r\n              }\r\n              this.loadingMatches[matchId] = false;\r\n              resolve();\r\n            },\r\n            error: (error) => {\r\n              this.toastr.error(error.error.message);\r\n              this.loadingMatches[matchId] = false;\r\n              reject(error);\r\n            },\r\n          });\r\n        })\r\n    );\r\n  }\r\n\r\n  deletePlayer(playerId: number, event: Event): void {\r\n    event.stopPropagation();\r\n    this.playerService.deletePlayer(playerId).subscribe(() => {\r\n      this.toastr.warning('Player deleted!', 'Deleted');\r\n      this.loadMatches();\r\n      // Invalidate cache and reload essential data\r\n      this.adminDashboardService.invalidateCache('essential');\r\n      this.loadEssentialData();\r\n      this.updateTournamentStageButton(); // Update button state after deleting player\r\n      if (this.selectedPlayer?.playerId === playerId) {\r\n        this.selectedPlayer = null;\r\n        this.playerMatches = [];\r\n        this.displayMatches = [];\r\n      }\r\n    });\r\n  }\r\n\r\n  openModal(): void {\r\n    this.showModal = true;\r\n  }\r\n\r\n  closeModal(): void {\r\n    this.showModal = false;\r\n    this.newPlayerName = '';\r\n  }\r\n\r\n  addPlayer(): void {\r\n    if (!this.newPlayerName.trim()) return;\r\n    this.playerService.addPlayer(this.newPlayerName).subscribe((response) => {\r\n      if (response.success) {\r\n        this.toastr.success(response.message);\r\n        // Invalidate cache and reload essential data\r\n        this.adminDashboardService.invalidateCache('essential');\r\n        this.loadEssentialData();\r\n        this.loadMatches();\r\n        this.closeModal();\r\n      } else this.toastr.warning(response.message);\r\n    });\r\n  }\r\n\r\n  selectedPlayerToDelete: { playerId: number; fullName: string } | null = null;\r\n\r\n  confirmDelete(player: { playerId: number; fullName: string }, event: Event) {\r\n    event.stopPropagation();\r\n    this.selectedPlayerToDelete = player;\r\n    this.showDeleteModal = true;\r\n  }\r\n\r\n  deleteConfirmedPlayer() {\r\n    if (this.selectedPlayerToDelete) {\r\n      this.playerService\r\n        .deletePlayer(this.selectedPlayerToDelete.playerId)\r\n        .subscribe((response) => {\r\n          if (response.success) {\r\n            this.toastr.success(response.message);\r\n            // Invalidate cache and reload essential data\r\n            this.adminDashboardService.invalidateCache('essential');\r\n            this.loadEssentialData();\r\n            this.loadMatches();\r\n          } else {\r\n            this.toastr.error(response.message, 'Error');\r\n          }\r\n        });\r\n\r\n      this.showDeleteModal = false;\r\n      this.selectedPlayerToDelete = null;\r\n    }\r\n  }\r\n\r\n  resetTournament(id: number): void {\r\n    this.leagueService.resetLeague(id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          this.showResetModal = false;\r\n          this.loadMatches();\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n          this.showEndLeagueModal = false;\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  openStartLeagueModal(): void {\r\n    this.showStartLeagueModal = true;\r\n    this.newLeague = {\r\n      name: '',\r\n      description: '',\r\n      typeOfLeague: 0,\r\n      systemOfLeague: 0,\r\n      roundsPerMatch: 3, // Default value for Points system\r\n    };\r\n  }\r\n\r\n  closeStartLeagueModal(): void {\r\n    this.showStartLeagueModal = false;\r\n  }\r\n\r\n  startLeague(): void {\r\n    if (!this.newLeague.name.trim()) {\r\n      this.toastr.error('League name is required', 'Error');\r\n      return;\r\n    }\r\n\r\n    // Validate rounds per match for Points system\r\n    if (\r\n      this.newLeague.systemOfLeague === 0 &&\r\n      (!this.newLeague.roundsPerMatch || this.newLeague.roundsPerMatch < 1)\r\n    ) {\r\n      this.toastr.error(\r\n        'Rounds per match is required for Points system and must be at least 1',\r\n        'Error'\r\n      );\r\n      return;\r\n    }\r\n\r\n    this.leagueService.startLeague(this.newLeague).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          this.closeStartLeagueModal();\r\n          this.loadMatches();\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n        } else {\r\n          this.toastr.error(response.message, 'Error');\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n        // console.error(err);\r\n      },\r\n    });\r\n  }\r\n\r\n  DeleteLeague(id: number): void {\r\n    this.leagueService.DeleteLeague(id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          this.showDeleteLeagueModal = false;\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  openDeleteLeagueModal(leagueId: number): void {\r\n    this.selectedLeagueToDelete =\r\n      this.leagues.find((l) => l.leagueId === leagueId) || null;\r\n    this.showDeleteLeagueModal = true;\r\n  }\r\n\r\n  closeDeleteLeagueModal(): void {\r\n    this.showDeleteLeagueModal = false;\r\n    this.selectedLeagueToDelete = null;\r\n  }\r\n\r\n  deleteConfirmedLeague(): void {\r\n    if (this.selectedLeagueToDelete) {\r\n      this.DeleteLeague(this.selectedLeagueToDelete.leagueId);\r\n      this.leagues = this.leagues.filter(\r\n        (l) => l.leagueId !== this.selectedLeagueToDelete?.leagueId\r\n      );\r\n      this.closeDeleteLeagueModal();\r\n    }\r\n  }\r\n\r\n  sendNote(): void {\r\n    if (!this.newNote.trim()) return;\r\n\r\n    this.noteService.sendNote(this.newNote).subscribe({\r\n      next: (res) => {\r\n        this.toastr.success(res.message);\r\n        this.newNote = '';\r\n        // Invalidate cache and reload all data\r\n        this.adminDashboardService.invalidateCache('essential');\r\n        this.loadEssentialData();\r\n      },\r\n      error: () => this.toastr.error('حصل مشكلة وانت بتبعت الملاحظة'),\r\n    });\r\n  }\r\n\r\n  toggleHideNote(note: any): void {\r\n    this.noteService.toggleMarHide(note.id, !note.isHidden).subscribe({\r\n      next: (res) => {\r\n        this.toastr.success(res.message);\r\n        this.loadEssentialData(); // ✅ محل getNotes()\r\n      },\r\n      error: () => this.toastr.error('حصل مشكلة وانت بتغير الظهور'),\r\n    });\r\n  }\r\n\r\n  toggleDeleteNote(noteId: number): void {\r\n    this.noteService.DeleteNote(noteId, false).subscribe({\r\n      next: (res) => {\r\n        this.toastr.warning(res.message);\r\n        this.loadEssentialData(); // ✅ محل getNotes()\r\n      },\r\n      error: () => this.toastr.error('حصل مشكلة وانت بتحذف '),\r\n    });\r\n  }\r\n\r\n  openNoteModal(): void {\r\n    this.showNoteModal = true;\r\n  }\r\n  closeNoteModal(): void {\r\n    this.showNoteModal = false;\r\n  }\r\n\r\n  // Method to determine tournament stage and update button\r\n  // This method checks the current tournament stage and shows appropriate buttons\r\n  // For Groups type leagues, it shows buttons to progress through tournament stages\r\n  private updateTournamentStageButton(): void {\r\n    // Only show button for Groups type leagues\r\n    if (!this.leagueData) {\r\n      this.showTournamentStageButton = false;\r\n      return;\r\n    }\r\n\r\n    // Check if it's a Groups type league (can be string 'Groups' or number 2)\r\n    const leagueType = this.leagueData.typeOfLeague as any;\r\n    const isGroupsLeague =\r\n      leagueType === LeagueType.Groups ||\r\n      leagueType === 'Groups' ||\r\n      leagueType === 2;\r\n\r\n    if (!isGroupsLeague) {\r\n      this.showTournamentStageButton = false;\r\n      return;\r\n    }\r\n\r\n    // Check if there are players but no matches (need to start group stage)\r\n    if (this.totalPlayers > 0 && this.currentMatches.length === 0) {\r\n      this.showTournamentStageButton = true;\r\n      this.tournamentStageButtonText = 'ابدأ دور المجموعات';\r\n      this.tournamentStageButtonAction = () => this.startGroupStage();\r\n      return;\r\n    }\r\n\r\n    // Check current stage based on matches\r\n    const groupMatches = this.currentMatches.filter(\r\n      (m) =>\r\n        m.stage === TournamentStage.GroupStage ||\r\n        m.tournamentStage === 'GroupStage'\r\n    );\r\n    const quarterMatches = this.currentMatches.filter(\r\n      (m) =>\r\n        m.stage === TournamentStage.QuarterFinals ||\r\n        m.tournamentStage === 'QuarterFinals'\r\n    );\r\n    const semiMatches = this.currentMatches.filter(\r\n      (m) =>\r\n        m.stage === TournamentStage.SemiFinals ||\r\n        m.tournamentStage === 'SemiFinals'\r\n    );\r\n    const finalMatches = this.currentMatches.filter(\r\n      (m) => m.stage === TournamentStage.Final || m.tournamentStage === 'Final'\r\n    );\r\n\r\n    // Check if all matches in a stage are completed\r\n    const allGroupMatchesCompleted =\r\n      groupMatches.length > 0 &&\r\n      groupMatches.every((match) => match.isCompleted);\r\n    const allQuarterMatchesCompleted =\r\n      quarterMatches.length > 0 &&\r\n      quarterMatches.every((match) => match.isCompleted);\r\n    const allSemiMatchesCompleted =\r\n      semiMatches.length > 0 && semiMatches.every((match) => match.isCompleted);\r\n\r\n    // Show quarter button when group stage is completed and no quarter matches exist\r\n    if (\r\n      groupMatches.length > 0 &&\r\n      allGroupMatchesCompleted &&\r\n      quarterMatches.length === 0\r\n    ) {\r\n      this.showTournamentStageButton = true;\r\n      this.tournamentStageButtonText = 'ابدأ دور ربع النهائي';\r\n      this.tournamentStageButtonAction = () => this.startQuarterStage();\r\n      return;\r\n    }\r\n\r\n    // Show semi button when quarter stage is completed and no semi matches exist\r\n    if (\r\n      quarterMatches.length > 0 &&\r\n      allQuarterMatchesCompleted &&\r\n      semiMatches.length === 0\r\n    ) {\r\n      this.showTournamentStageButton = true;\r\n      this.tournamentStageButtonText = 'ابدأ دور نصف النهائي';\r\n      this.tournamentStageButtonAction = () => this.startSemiFinalStage();\r\n      return;\r\n    }\r\n\r\n    // Show final button when semi stage is completed and no final matches exist\r\n    if (\r\n      semiMatches.length > 0 &&\r\n      allSemiMatchesCompleted &&\r\n      finalMatches.length === 0\r\n    ) {\r\n      this.showTournamentStageButton = true;\r\n      this.tournamentStageButtonText = 'ابدأ النهائي';\r\n      this.tournamentStageButtonAction = () => this.startFinalStage();\r\n      return;\r\n    }\r\n\r\n    if (finalMatches.length > 0) {\r\n      // Final stage is active, hide button\r\n\r\n      this.showTournamentStageButton = false;\r\n      return;\r\n    }\r\n\r\n    // Default: hide button\r\n    this.showTournamentStageButton = false;\r\n  }\r\n\r\n  // Tournament stage action methods\r\n  startGroupStage(): void {\r\n    if (!this.leagueData) return;\r\n\r\n    this.leagueService.createGroupsAndMatches(this.leagueData.id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  startQuarterStage(): void {\r\n    if (!this.leagueData) return;\r\n\r\n    this.leagueService.startKnockoutStage(this.leagueData.id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n        // console.error(err);\r\n      },\r\n    });\r\n  }\r\n\r\n  startSemiFinalStage(): void {\r\n    if (!this.leagueData) return;\r\n\r\n    this.leagueService.startSemiFinals(this.leagueData.id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  startFinalStage(): void {\r\n    if (!this.leagueData) return;\r\n\r\n    this.leagueService.startFinal(this.leagueData.id).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          this.toastr.success(response.message);\r\n          // Invalidate cache and reload essential data\r\n          this.adminDashboardService.invalidateCache('essential');\r\n          this.loadEssentialData();\r\n        } else {\r\n          this.toastr.error(response.message);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.error.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  // Method to handle tournament stage button click\r\n  onTournamentStageButtonClick(): void {\r\n    if (this.tournamentStageButtonAction) {\r\n      this.tournamentStageButtonAction();\r\n    }\r\n  }\r\n\r\n  // Coercion helpers to support both numeric and string values coming from API\r\n  private coerceLeagueType(value: unknown): LeagueType | undefined {\r\n    if (typeof value === 'number') {\r\n      if (\r\n        value === LeagueType.Single ||\r\n        value === LeagueType.Multi ||\r\n        value === LeagueType.Groups\r\n      ) {\r\n        return value as LeagueType;\r\n      }\r\n    }\r\n    if (typeof value === 'string') {\r\n      const v = value.toLowerCase();\r\n      if (v === 'single' || v === '0') return LeagueType.Single;\r\n      if (v === 'multi' || v === '1') return LeagueType.Multi;\r\n      if (v === 'groups' || v === '2') return LeagueType.Groups;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private coerceSystemType(value: unknown): SystemOfLeague | undefined {\r\n    if (typeof value === 'number') {\r\n      if (value === SystemOfLeague.Points || value === SystemOfLeague.Classic) {\r\n        return value as SystemOfLeague;\r\n      }\r\n    }\r\n    if (typeof value === 'string') {\r\n      const v = value.toLowerCase();\r\n      if (v === 'points' || v === '0') return SystemOfLeague.Points;\r\n      if (v === 'classic' || v === '1') return SystemOfLeague.Classic;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  // Helper method to get readable league type (supports number or string)\r\n  getLeagueTypeText(type: unknown): string {\r\n    const t = this.coerceLeagueType(type);\r\n    switch (t) {\r\n      case LeagueType.Single:\r\n        return 'بطولة فردية';\r\n      case LeagueType.Multi:\r\n        return 'بطولة متعددة';\r\n      case LeagueType.Groups:\r\n        return 'بطولة مجموعات';\r\n      default:\r\n        return 'غير محدد';\r\n    }\r\n  }\r\n\r\n  // Helper method to get league type icon\r\n  getLeagueTypeIcon(type: unknown): string {\r\n    const t = this.coerceLeagueType(type);\r\n    if (t === LeagueType.Single) return '👤';\r\n    if (t === LeagueType.Multi) return '👥';\r\n    if (t === LeagueType.Groups) return '🏆';\r\n    return '';\r\n  }\r\n\r\n  // Helper method to get readable system type (supports number or string)\r\n  getSystemTypeText(system: unknown): string {\r\n    const s = this.coerceSystemType(system);\r\n    switch (s) {\r\n      case SystemOfLeague.Points:\r\n        return 'نظام النقاط';\r\n      case SystemOfLeague.Classic:\r\n        return 'النظام الكلاسيكي';\r\n      default:\r\n        return 'غير محدد';\r\n    }\r\n  }\r\n\r\n  // Helper method to get system type icon\r\n  getSystemTypeIcon(system: unknown): string {\r\n    const s = this.coerceSystemType(system);\r\n    if (s === SystemOfLeague.Points) return '📊';\r\n    if (s === SystemOfLeague.Classic) return '⚔️';\r\n    return '';\r\n  }\r\n\r\n  // Helper method to get readable league type for table (handles both string and number)\r\n  getLeagueTypeTextForTable(leagueType: any): string {\r\n    if (leagueType === 0 || leagueType === 'Single') {\r\n      return 'بطولة فردية';\r\n    } else if (leagueType === 1 || leagueType === 'Multi') {\r\n      return 'بطولة متعددة';\r\n    } else if (leagueType === 2 || leagueType === 'Groups') {\r\n      return 'بطولة مجموعات';\r\n    } else {\r\n      return 'غير محدد';\r\n    }\r\n  }\r\n\r\n  // Helper method to get readable system type for table (handles both string and number)\r\n  getSystemTypeTextForTable(systemType: any): string {\r\n    if (systemType === 0 || systemType === 'Points') {\r\n      return 'نظام النقاط';\r\n    } else if (systemType === 1 || systemType === 'Classic') {\r\n      return 'النظام الكلاسيكي';\r\n    } else {\r\n      return 'غير محدد';\r\n    }\r\n  }\r\n\r\n  // دالة جديدة لتحديد الفائز بناءً على نوع البطولة\r\n  getWinnerForLeague(league: AllLeagueRank): string {\r\n    // إذا كانت البطولة من نوع المجموعات\r\n    if (\r\n      league.leagueType === 2 ||\r\n      league.leagueType === LeagueType.Groups ||\r\n      String(league.leagueType) === 'Groups'\r\n    ) {\r\n      // البحث عن ماتش الفاينال في knockoutMatches\r\n      if (league.knockoutMatches && league.knockoutMatches.length > 0) {\r\n        const finalMatch = league.knockoutMatches.find((match) => {\r\n          const stage = match.stage || match.tournamentStage;\r\n          return stage === 'Final';\r\n        });\r\n\r\n        if (finalMatch && finalMatch.isCompleted && finalMatch.winnerId) {\r\n          // البحث عن اسم الفائز\r\n          if (finalMatch.winnerId === finalMatch.player1Id) {\r\n            return finalMatch.player1Name;\r\n          } else if (finalMatch.winnerId === finalMatch.player2Id) {\r\n            return finalMatch.player2Name;\r\n          }\r\n        }\r\n      }\r\n\r\n      // إذا لم نجد فائز في الفاينال، نبحث في الماتشات العادية\r\n      if (league.matches && league.matches.length > 0) {\r\n        const finalMatch = league.matches.find((match) => {\r\n          const stage = match.stage || match.tournamentStage;\r\n          return stage === 'Final';\r\n        });\r\n\r\n        if (finalMatch && finalMatch.isCompleted && finalMatch.winnerId) {\r\n          if (finalMatch.winnerId === finalMatch.player1Id) {\r\n            return finalMatch.player1Name;\r\n          } else if (finalMatch.winnerId === finalMatch.player2Id) {\r\n            return finalMatch.player2Name;\r\n          }\r\n        }\r\n      }\r\n\r\n      // إذا لم نجد فائز بعد، نعود للطريقة القديمة\r\n      return league.players && league.players.length > 0\r\n        ? league.players[0].fullName\r\n        : 'No Winner Yet';\r\n    }\r\n\r\n    // للبطولات الأخرى (فردية أو متعددة)، نستخدم الطريقة القديمة\r\n    return league.players && league.players.length > 0\r\n      ? league.players[0].fullName\r\n      : 'No Winner Yet';\r\n  }\r\n}\r\n","<div\r\n  class=\"container mx-auto p-4 flex flex-col sm:flex-row overflow-hidden h-screen\"\r\n>\r\n  <!-- Chats List -->\r\n  <div\r\n    class=\"w-full sm:w-1/3 border-r border-gray-600 sm:block\"\r\n    [ngClass]=\"{ hidden: selectedChat }\"\r\n  >\r\n    <div class=\"flex items-center justify-between mb-6\">\r\n      <h2 class=\"text-2xl font-bold text-white\">📥 Inbox</h2>\r\n    </div>\r\n\r\n    <!-- No Chats -->\r\n    <div *ngIf=\"playerChats.length === 0\" class=\"text-center text-gray-300\">\r\n      No messages here 📭\r\n    </div>\r\n\r\n    <!-- Chats List -->\r\n    <div\r\n      *ngIf=\"playerChats.length > 0\"\r\n      class=\"space-y-2 overflow-y-auto max-h-[calc(100vh-120px)]\"\r\n    >\r\n      <div\r\n        *ngFor=\"let chat of playerChats; trackBy: trackByPlayerId\"\r\n        class=\"p-4 backdrop-blur-sm border border-gray-600 rounded-lg hover:bg-gray-700 cursor-pointer flex items-center justify-between\"\r\n        (click)=\"openChat(chat.senderId)\"\r\n      >\r\n        <div>\r\n          <p class=\"font-bold text-white\">{{ chat.senderFullName }}</p>\r\n          <p class=\"text-sm text-gray-300 truncate\">{{ chat.lastMessage }}</p>\r\n        </div>\r\n        <span\r\n          *ngIf=\"chat.unreadCount > 0\"\r\n          class=\"bg-green-600 text-white text-xs font-bold rounded-full px-2 py-1\"\r\n        >\r\n          {{ chat.unreadCount }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Chat View -->\r\n  <div\r\n    class=\"w-full sm:w-2/3 flex flex-col h-full relative\"\r\n    [ngClass]=\"{ block: selectedChat, 'hidden sm:flex': !selectedChat }\"\r\n  >\r\n    <div *ngIf=\"selectedChat; else noChatSelected\" class=\"flex flex-col h-full\">\r\n      <!-- Chat Header - Fixed -->\r\n      <div\r\n        class=\"fixed left-0 right-0 z-40 p-2 backdrop-blur-sm border-b border-gray-600 flex items-center justify-between bg-black bg-opacity-90\"\r\n        [ngClass]=\"{ 'sm:left-1/3': selectedChat }\"\r\n        [style.top.px]=\"navbarHeight\"\r\n      >\r\n        <div class=\"flex items-center\">\r\n          <button\r\n            (click)=\"closeChat()\"\r\n            class=\"mr-4 text-gray-300 hover:text-white transition\"\r\n          >\r\n            <i class=\"fa-solid fa-arrow-left\" style=\"color: #ffffff\"></i>\r\n          </button>\r\n          <div>\r\n            <p class=\"font-bold text-white text-sm p-0\">\r\n              {{ selectedChat.senderFullName }}\r\n            </p>\r\n            <p class=\"text-xs text-gray-400 p-0\">\r\n              {{ selectedChat.senderPhoneNumber }}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Messages - Scrollable Area with padding for fixed header and footer -->\r\n      <div\r\n        #messagesContainer\r\n        class=\"flex-1 p-4 overflow-y-auto backdrop-blur-sm\"\r\n        [style.margin-top.px]=\"navbarHeight + 80\"\r\n        style=\"margin-bottom: 80px\"\r\n      >\r\n        <div\r\n          *ngFor=\"\r\n            let message of selectedChat.messages;\r\n            trackBy: trackByMessageId\r\n          \"\r\n          class=\"mb-4\"\r\n          [ngClass]=\"{\r\n            'text-right': !message.isFromAdmin,\r\n            'text-left': message.isFromAdmin\r\n          }\"\r\n        >\r\n          <div\r\n            class=\"inline-block p-3 rounded-lg max-w-xs\"\r\n            [ngClass]=\"{\r\n              'bg-green-700': !message.isFromAdmin,\r\n              'bg-gray-700 ': message.isFromAdmin\r\n            }\"\r\n          >\r\n            <p class=\"text-white\">{{ message.content }}</p>\r\n            <p class=\"text-xs mt-1 text-gray-300\">\r\n              {{ message.sentAt | date : \"MMM d, y, hh:mm a\" }}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Reply Input - Fixed -->\r\n      <div\r\n        class=\"fixed bottom-0 left-0 right-0 z-50 p-4 bg-black bg-opacity-90 backdrop-blur-sm border-t border-gray-600\"\r\n        [ngClass]=\"{ 'sm:left-1/3': selectedChat }\"\r\n      >\r\n        <form (ngSubmit)=\"sendReply()\" class=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"replyMessages[selectedChat.messages[0].id]\"\r\n            [ngModelOptions]=\"{ standalone: true }\"\r\n            (ngModelChange)=\"\r\n              replyMessages[selectedChat.messages[0].id] = $event\r\n            \"\r\n            placeholder=\"Write your reply...\"\r\n            class=\"flex-1 p-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-600 placeholder-gray-400\"\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            class=\"bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition disabled:bg-gray-600\"\r\n            [disabled]=\"!replyMessages[selectedChat.messages[0].id]\"\r\n          >\r\n            Reply\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Placeholder when no chat is selected -->\r\n    <ng-template #noChatSelected>\r\n      <div class=\"w-full flex items-center justify-center text-gray-300\">\r\n        Select a chat to view messages 📩\r\n      </div>\r\n    </ng-template>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  ChangeDetectorRef,\r\n  ViewChild,\r\n  ElementRef,\r\n  AfterViewChecked,\r\n  OnDestroy,\r\n} from '@angular/core';\r\nimport { MessageService } from 'src/app/core/services/message.service';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { Message } from 'src/app/models/interfaces';\r\nimport { AdminDashboardService } from 'src/app/core/services/admin-dashboard.service';\r\nimport { Subscription } from 'rxjs';\r\n\r\ninterface PlayerChat {\r\n  senderId: string;\r\n  senderFullName: string;\r\n  senderPhoneNumber: string;\r\n  lastMessage: string;\r\n  lastMessageDate: string;\r\n  unreadCount: number;\r\n  messages: Message[];\r\n}\r\n\r\n@Component({\r\n  selector: 'app-inbox',\r\n  templateUrl: './inbox.component.html',\r\n  styleUrls: ['./inbox.component.css'],\r\n})\r\nexport class InboxComponent implements OnInit, AfterViewChecked, OnDestroy {\r\n  playerChats: PlayerChat[] = [];\r\n  selectedPlayerId: string | null = null;\r\n  selectedChat: PlayerChat | null = null;\r\n  replyMessages: { [messageId: number]: string } = {};\r\n  private updateStatusSubscription?: Subscription;\r\n  private refreshSubscription?: Subscription;\r\n  navbarHeight = 60; // default navbar height\r\n\r\n  @ViewChild('messagesContainer')\r\n  messagesContainer!: ElementRef<HTMLDivElement>;\r\n\r\n  constructor(\r\n    private messageService: MessageService,\r\n    private toastr: ToastrService,\r\n    private cdr: ChangeDetectorRef,\r\n    private adminDashboardService: AdminDashboardService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadAdminMessages();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.updateStatusSubscription) {\r\n      this.updateStatusSubscription.unsubscribe();\r\n    }\r\n    if (this.refreshSubscription) {\r\n      this.refreshSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n\r\n  private loadAdminMessages(): void {\r\n    // Always load fresh data from server for immediate updates\r\n    this.loadFromServer();\r\n  }\r\n\r\n  private loadFromCache(): void {\r\n    // تم إلغاء الكاش للادمن، سيتم التحميل دائماً من السيرفر\r\n    this.loadFromServer();\r\n  }\r\n\r\n  private loadFromServer(): void {\r\n    this.adminDashboardService.getSecondaryData('messages').subscribe({\r\n      next: (messages) => {\r\n        if (messages && messages.length > 0) {\r\n          const groupedMessages = this.groupMessagesBySender(messages);\r\n          // ترتيب المحادثات حسب الأحدث (آخر رسالة)\r\n          this.playerChats = groupedMessages.sort(\r\n            (a, b) =>\r\n              new Date(b.lastMessageDate).getTime() -\r\n              new Date(a.lastMessageDate).getTime()\r\n          );\r\n  \r\n        } else {\r\n          this.toastr.error('لا يوجد رسائل');\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  // Add refresh method for immediate updates\r\n  refreshMessages(): void {\r\n    this.messageService.getAdminMessages().subscribe({\r\n      next: (response) => {\r\n        if (response && response.messages) {\r\n          const groupedMessages = this.groupMessagesBySender(response.messages);\r\n          // ترتيب المحادثات حسب الأحدث (آخر رسالة)\r\n          this.playerChats = groupedMessages.sort(\r\n            (a, b) =>\r\n              new Date(b.lastMessageDate).getTime() -\r\n              new Date(a.lastMessageDate).getTime()\r\n          );\r\n          \r\n        } else {\r\n          this.toastr.error('لا يوجد رسائل');\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error(err.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n    if (this.selectedChat && this.messagesContainer) {\r\n      this.scrollToBottom();\r\n    }\r\n  }\r\n\r\n  loadMessages(): void {\r\n    this.messageService.getMessages().subscribe({\r\n      next: (response) => {\r\n        if (response && response.messages) {\r\n          this.processMessages(response.messages);\r\n        } else {\r\n          this.toastr.error('لا يوجد رسائل الآن');\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.toastr.error('حصل خطأ أثناء جلب الرسائل');\r\n      },\r\n    });\r\n  }\r\n\r\n  private processMessages(messages: Message[]): void {\r\n    const groupedMessages = this.groupMessagesBySender(messages);\r\n    // ترتيب حسب الأحدث (آخر رسالة)\r\n    this.playerChats = groupedMessages.sort(\r\n      (a, b) =>\r\n        new Date(b.lastMessageDate).getTime() -\r\n        new Date(a.lastMessageDate).getTime()\r\n    );\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  groupMessagesBySender(messages: Message[]): PlayerChat[] {\r\n    const chatMap: { [senderId: string]: PlayerChat } = {};\r\n    messages\r\n      .filter((msg) => !msg.isDeleted)\r\n      .forEach((msg) => {\r\n        const playerId = msg.isFromAdmin ? msg.senderId : msg.senderId;\r\n        if (!chatMap[playerId]) {\r\n          chatMap[playerId] = {\r\n            senderId: playerId,\r\n            senderFullName: msg.senderFullName,\r\n            senderPhoneNumber: msg.senderPhoneNumber,\r\n            lastMessage: '',\r\n            lastMessageDate: '',\r\n            unreadCount: 0,\r\n            messages: [],\r\n          };\r\n        }\r\n        chatMap[playerId].messages.push(msg);\r\n        if (!msg.isFromAdmin && !msg.isRead) {\r\n          chatMap[playerId].unreadCount++;\r\n        }\r\n      });\r\n\r\n    return Object.values(chatMap).map((chat) => {\r\n      // ترتيب الرسائل من الأقدم للأحدث\r\n      chat.messages = chat.messages.sort(\r\n        (a, b) => new Date(a.sentAt).getTime() - new Date(b.sentAt).getTime()\r\n      );\r\n      // آخر رسالة\r\n      const lastMsg = chat.messages[chat.messages.length - 1];\r\n      chat.lastMessage = lastMsg?.content ?? '';\r\n      chat.lastMessageDate = lastMsg?.sentAt ?? '';\r\n      return chat;\r\n    });\r\n  }\r\n\r\n  openChat(playerId: string): void {\r\n    this.selectedPlayerId = playerId;\r\n    this.selectedChat =\r\n      this.playerChats.find((chat) => chat.senderId === playerId) || null;\r\n    if (this.selectedChat) {\r\n      this.selectedChat.messages\r\n        .filter((msg) => !msg.isRead && !msg.isFromAdmin)\r\n        .forEach((msg) => {\r\n          this.messageService.toggleMarkMessage(msg.id, true).subscribe({\r\n            next: (response) => {\r\n              if (response.success) {\r\n                msg.isRead = true;\r\n                this.selectedChat!.unreadCount =\r\n                  this.selectedChat!.messages.filter(\r\n                    (m) => !m.isRead && !m.isFromAdmin\r\n                  ).length;\r\n                this.cdr.detectChanges();\r\n              }\r\n            },\r\n            error: (err) => {\r\n              this.toastr.error('حصل خطأ أثناء تحديث حالة الرسالة');\r\n            },\r\n          });\r\n        });\r\n      this.cdr.detectChanges();\r\n    }\r\n  }\r\n\r\n  closeChat(): void {\r\n    this.selectedPlayerId = null;\r\n    this.selectedChat = null;\r\n    this.replyMessages = {};\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  sendReply(): void {\r\n    if (!this.selectedChat) {\r\n      this.toastr.warning('الرجاء اختيار محادثة');\r\n      return;\r\n    }\r\n    const replyContent =\r\n      this.replyMessages[this.selectedChat.messages[0].id]?.trim();\r\n    if (!replyContent) {\r\n      this.toastr.warning('الرجاء كتابة رد');\r\n      return;\r\n    }\r\n\r\n    this.messageService\r\n      .sendAdminReply(this.selectedChat.senderId, replyContent)\r\n      .subscribe({\r\n        next: (response) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم إرسال الرد');\r\n            this.replyMessages[this.selectedChat!.messages[0].id] = '';\r\n\r\n            const newMessage: Message = {\r\n              id: Math.random(),\r\n              senderId: this.selectedChat!.senderId,\r\n              senderFullName: 'Admin',\r\n              senderPhoneNumber: '',\r\n              content: replyContent,\r\n              isRead: true,\r\n              isDeleted: false,\r\n              sentAt: new Date().toISOString(),\r\n              isFromAdmin: true,\r\n            };\r\n\r\n            // تحديث الرسائل في المحادثة المحددة\r\n            this.selectedChat!.messages.push(newMessage);\r\n            this.selectedChat!.messages.sort(\r\n              (a, b) =>\r\n                new Date(a.sentAt).getTime() - new Date(b.sentAt).getTime()\r\n            );\r\n\r\n            // تحديث آخر رسالة في قائمة المحادثات\r\n            this.selectedChat!.lastMessage = replyContent;\r\n            this.selectedChat!.lastMessageDate = newMessage.sentAt;\r\n\r\n            // إعادة ترتيب قائمة المحادثات حسب الأحدث\r\n            this.playerChats.sort(\r\n              (a, b) =>\r\n                new Date(b.lastMessageDate).getTime() -\r\n                new Date(a.lastMessageDate).getTime()\r\n            );\r\n\r\n            // تحديث المحادثة المحددة بعد إعادة الترتيب\r\n            this.selectedChat =\r\n              this.playerChats.find(\r\n                (chat) => chat.senderId === this.selectedPlayerId\r\n              ) || null;\r\n\r\n            this.cdr.detectChanges();\r\n          } else {\r\n            this.toastr.error(response.message || 'فشل إرسال الرد');\r\n          }\r\n        },\r\n        error: (err) => {\r\n          this.toastr.error('حصل خطأ أثناء إرسال الرد');\r\n        },\r\n      });\r\n  }\r\n\r\n  private scrollToBottom(): void {\r\n    if (this.messagesContainer) {\r\n      const container = this.messagesContainer.nativeElement;\r\n      container.scrollTop = container.scrollHeight;\r\n    }\r\n  }\r\n\r\n  trackByPlayerId(index: number, chat: PlayerChat): string {\r\n    return chat.senderId;\r\n  }\r\n\r\n  trackByMessageId(index: number, message: Message): number {\r\n    return message.id;\r\n  }\r\n}\r\n","<!-- Friendlies Dashboard Component -->\r\n\r\n<div class=\"block sm:flex transition-all duration-600\">\r\n  <!-- Sidebar -->\r\n  <div\r\n    class=\"bg-black bg-opacity-50 backdrop-blur-sm text-white transition-all duration-600\"\r\n    [ngClass]=\"{\r\n      'w-64 p-4 sm:min-h-screen': isSidebarOpen,\r\n      'w-0 p-0': !isSidebarOpen\r\n    }\"\r\n  >\r\n    <h2\r\n      class=\"text-lg font-bold mb-4 flex justify-between overflow-hidden text-white\"\r\n    >\r\n      Friendly Players\r\n      <button (click)=\"toggleSidebar()\" class=\"text-gray-300 text-3xl\">\r\n        ×\r\n      </button>\r\n    </h2>\r\n    <ul *ngIf=\"isSidebarOpen\">\r\n      <li\r\n        *ngFor=\"let player of players\"\r\n        class=\"flex items-center justify-between p-2 cursor-pointer rounded-md hover:bg-gray-700\"\r\n        [class.bg-blue-600]=\"selectedPlayer?.playerId === player.playerId\"\r\n        (click)=\"selectPlayer(player)\"\r\n      >\r\n        <span\r\n          class=\"text-white cursor-pointer hover:text-blue-300\"\r\n          (click)=\"openRecordMatchModal()\"\r\n          >{{ player.fullName }}</span\r\n        >\r\n        <button\r\n          (click)=\"confirmDelete(player, $event)\"\r\n          class=\"bg-red-600 px-2 py-1 text-sm rounded text-white hover:bg-red-700 transition\"\r\n        >\r\n          X\r\n        </button>\r\n      </li>\r\n    </ul>\r\n    <button\r\n      *ngIf=\"isSidebarOpen\"\r\n      class=\"mt-4 w-full bg-green-600 p-2 rounded text-white hover:bg-green-700 transition\"\r\n      (click)=\"openModal()\"\r\n    >\r\n      Add Player\r\n    </button>\r\n  </div>\r\n\r\n  <!-- Main Content -->\r\n  <div\r\n    class=\"sm:flex-1 sm:p-2 transition-all duration-600 sm:container sm:mx-auto\"\r\n  >\r\n    <!-- Friendlies Tab Content -->\r\n    <div *ngIf=\"activeTab === 'friendlies'\">\r\n      <div *ngIf=\"selectedPlayer\" class=\"sm:w-4/6 mx-auto\">\r\n        <h2 class=\"text-2xl font-bold mb-4 text-center text-white\">\r\n          Friendly Matches for {{ selectedPlayer.fullName }}\r\n        </h2>\r\n      </div>\r\n      <hr class=\"my-3 border-gray-600\" />\r\n\r\n      <!-- القائمة الأولية -->\r\n      <div>\r\n        <div class=\"flex justify-evenly pt-5\">\r\n          <button\r\n            (click)=\"toggleSidebar()\"\r\n            class=\"bg-blue-600 text-white px-3 py-2 rounded mb-4 hover:bg-blue-700 transition\"\r\n          >\r\n            ☰ Players\r\n          </button>\r\n\r\n          <button\r\n            routerLink=\"/admin/friendly-inbox\"\r\n            class=\"bg-purple-600 hover:bg-purple-700 text-white mb-4 px-3 py-2 rounded transition-all relative\"\r\n          >\r\n            📬 Friendly Inbox\r\n            <div\r\n              class=\"absolute -top-2 -right-2 w-[30px] h-[30px] rounded-full bg-green-600 flex justify-center items-center\"\r\n              *ngIf=\"totalUnreadFriendlyMessages > 0\"\r\n            >\r\n              <h4 class=\"text-white font-bold\">\r\n                {{ totalUnreadFriendlyMessages }}\r\n              </h4>\r\n            </div>\r\n          </button>\r\n        </div>\r\n\r\n        <div class=\"text-center mb-8\">\r\n          <h2\r\n            class=\"mb-4 text-4xl font-extrabold leading-none tracking-tight md:text-4xl lg:text-4xl text-white\"\r\n          >\r\n            Quick Actions\r\n          </h2>\r\n\r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4\">\r\n            <button\r\n              class=\"bg-teal-600 text-white p-4 rounded-lg hover:bg-teal-700 transition-all\"\r\n              (click)=\"openRecordMatchModal()\"\r\n              [disabled]=\"players.length === 0\"\r\n            >\r\n              <h3 class=\"text-lg font-bold\">Record Match</h3>\r\n              <p class=\"text-sm\">Record a new friendly match</p>\r\n            </button>\r\n\r\n            <button\r\n              class=\"bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 transition-all\"\r\n              (click)=\"openModal()\"\r\n            >\r\n              <h3 class=\"text-lg font-bold\">Add New Player</h3>\r\n              <p class=\"text-sm\">Register a new friendly player</p>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- All Matches Section -->\r\n      <div class=\"mt-8\">\r\n        <!-- Filters Section -->\r\n        <div class=\"mb-6 p-2 bg-gray-800 rounded-lg\">\r\n          <div class=\"mb-4\">\r\n            <h4 class=\"text-lg font-semibold text-white\">Filter Matches</h4>\r\n          </div>\r\n          <div class=\"grid grid-cols-2 md:grid-cols-2 gap-4\">\r\n            <div>\r\n              <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n                >Date Range</label\r\n              >\r\n              <select\r\n                [(ngModel)]=\"filterForm.dateFilter\"\r\n                (ngModelChange)=\"onFilterChange()\"\r\n                class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white\"\r\n              >\r\n                <option [ngValue]=\"DateFilter.AllTime\">All Time</option>\r\n                <option [ngValue]=\"DateFilter.Today\">Today</option>\r\n                <option [ngValue]=\"DateFilter.Last3Days\">Last 3 Days</option>\r\n                <option [ngValue]=\"DateFilter.LastWeek\">Last Week</option>\r\n                <option [ngValue]=\"DateFilter.LastMonth\">Last Month</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n                >Player</label\r\n              >\r\n              <select\r\n                [(ngModel)]=\"filterForm.playerId\"\r\n                (ngModelChange)=\"onFilterChange()\"\r\n                class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white\"\r\n              >\r\n                <option [ngValue]=\"0\">All Players</option>\r\n                <option\r\n                  *ngFor=\"let player of getAllActivePlayers()\"\r\n                  [ngValue]=\"player.playerId\"\r\n                >\r\n                  {{ player.fullName }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"flex justify-center mt-4\">\r\n            <button\r\n              class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n              (click)=\"clearFilters()\"\r\n            >\r\n              Clear Filters\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"overflow-x-auto\">\r\n          <table class=\"w-full text-white\">\r\n            <thead class=\"text-center\">\r\n              <tr class=\"border-b border-gray-600 text-center\">\r\n                <th class=\"p-3\">Date</th>\r\n                <th class=\"p-3\">Player 1</th>\r\n                <th class=\"p-3\">Score</th>\r\n                <th class=\"p-3\">Player 2</th>\r\n                <th class=\"p-3\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr\r\n                *ngFor=\"let match of getPaginatedMatches()\"\r\n                class=\"border-b border-gray-700 hover:bg-gray-800\"\r\n              >\r\n                <td class=\"p-3\">\r\n                  {{ match.playedOn | date : \"shortDate\" }}\r\n                </td>\r\n                <td class=\"p-3\">\r\n                  {{ match.player1Name || getPlayerName(match.player1Id) }}\r\n                </td>\r\n                <td class=\"p-3 text-center\">\r\n                  <span class=\"font-bold text-lg\">\r\n                    {{ match.player1Score }} - {{ match.player2Score }}\r\n                  </span>\r\n                </td>\r\n                <td class=\"p-3\">\r\n                  {{ match.player2Name || getPlayerName(match.player2Id) }}\r\n                </td>\r\n                <td class=\"p-3 text-center\">\r\n                  <div class=\"flex justify-center space-x-2\">\r\n                    <button\r\n                      class=\"bg-blue-600 px-3 py-1 text-white rounded hover:bg-blue-700 transition text-sm\"\r\n                      (click)=\"editMatch(match)\"\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <button\r\n                      class=\"bg-red-600 px-3 py-1 text-white rounded hover:bg-red-700 transition text-sm\"\r\n                      (click)=\"deleteMatchFromList(match.matchId)\"\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <!-- Pagination -->\r\n        <div *ngIf=\"totalPages > 1\" class=\"flex justify-center mt-6\">\r\n          <div class=\"flex space-x-2\">\r\n            <button\r\n              class=\"bg-gray-600 px-3 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n              [disabled]=\"currentPage === 1\"\r\n              (click)=\"changePage(currentPage - 1)\"\r\n            >\r\n              Previous\r\n            </button>\r\n\r\n            <span\r\n              *ngFor=\"let page of [].constructor(totalPages); let i = index\"\r\n              class=\"flex\"\r\n            >\r\n              <button\r\n                class=\"px-3 py-2 text-white rounded transition\"\r\n                [class.bg-blue-600]=\"currentPage === i + 1\"\r\n                [class.bg-gray-600]=\"currentPage !== i + 1\"\r\n                [class.hover:bg-blue-700]=\"currentPage === i + 1\"\r\n                [class.hover:bg-gray-700]=\"currentPage !== i + 1\"\r\n                (click)=\"changePage(i + 1)\"\r\n              >\r\n                {{ i + 1 }}\r\n              </button>\r\n            </span>\r\n\r\n            <button\r\n              class=\"bg-gray-600 px-3 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n              [disabled]=\"currentPage === totalPages\"\r\n              (click)=\"changePage(currentPage + 1)\"\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"text-center mt-4 text-gray-300\">\r\n          Showing {{ (currentPage - 1) * itemsPerPage + 1 }} -\r\n          {{ Math.min(currentPage * itemsPerPage, allMatches.length) }} of\r\n          {{ allMatches.length }} matches\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Quick Actions -->\r\n    </div>\r\n    <!-- End Friendlies Tab -->\r\n\r\n    <!-- Delete Confirmation Modal -->\r\n    <div\r\n      *ngIf=\"showDeleteModal\"\r\n      class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    >\r\n      <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg\">\r\n        <h2 class=\"text-lg font-bold mb-4 text-white\">Confirm Delete</h2>\r\n        <p class=\"text-gray-300\">\r\n          Are you sure you want to delete\r\n          <strong>{{ selectedPlayerToDelete?.fullName }}</strong\r\n          >?\r\n        </p>\r\n        <div class=\"mt-4 flex justify-end\">\r\n          <button\r\n            class=\"bg-gray-600 px-4 py-2 text-white rounded mr-2 hover:bg-gray-700 transition\"\r\n            (click)=\"showDeleteModal = false\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            class=\"bg-red-600 px-4 py-2 text-white rounded hover:bg-red-700 transition\"\r\n            (click)=\"deleteConfirmedPlayer()\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Add Player Modal -->\r\n    <div\r\n      *ngIf=\"showModal\"\r\n      class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    >\r\n      <div class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg\">\r\n        <h2 class=\"text-lg font-bold mb-4 text-white\">\r\n          Add New Friendly Player\r\n        </h2>\r\n        <input\r\n          type=\"text\"\r\n          [(ngModel)]=\"friendlyPlayerName\"\r\n          class=\"border border-gray-600 p-2 w-full bg-gray-800 text-white rounded placeholder-gray-400\"\r\n          placeholder=\"Enter player name\"\r\n        />\r\n        <div class=\"mt-4 flex justify-end\">\r\n          <button\r\n            class=\"bg-red-600 px-4 py-2 text-white rounded mr-2 hover:bg-red-700 transition\"\r\n            (click)=\"closeModal()\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n            (click)=\"addPlayer()\"\r\n          >\r\n            Add\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Record Match Modal -->\r\n    <div\r\n      *ngIf=\"showRecordMatchModal\"\r\n      class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    >\r\n      <div\r\n        class=\"bg-black bg-opacity-50 backdrop-blur-sm p-6 rounded-lg w-96 max-h-[90vh] overflow-y-auto\"\r\n      >\r\n        <h2 class=\"text-lg font-bold mb-4 text-white\">\r\n          {{ selectedPlayerForMatch ? \"Edit Match\" : \"Record New Match\" }}\r\n        </h2>\r\n\r\n        <!-- Player selection for new match -->\r\n        <div *ngIf=\"!selectedPlayerForMatch\" class=\"mb-4\">\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Player 1</label\r\n          >\r\n          <div class=\"relative\">\r\n            <input\r\n              type=\"text\"\r\n              [(ngModel)]=\"matchForm.player1Name\"\r\n              (input)=\"searchPlayer1($event)\"\r\n              (focus)=\"showPlayer1Suggestions = true; showPlayer1Select = true\"\r\n              (blur)=\"hidePlayer1Suggestions()\"\r\n              [placeholder]=\"'Type to search for Player 1...'\"\r\n              class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n              autocomplete=\"off\"\r\n            />\r\n            <!-- Player 1 Select Box -->\r\n            <div\r\n              *ngIf=\"showPlayer1Select\"\r\n              class=\"absolute z-[9999] w-full mt-1 top-full\"\r\n            >\r\n              <select\r\n                (change)=\"selectPlayer1FromSelect($event)\"\r\n                (blur)=\"showPlayer1Select = false\"\r\n                class=\"w-full bg-gray-800 border border-gray-600 rounded-md text-white shadow-2xl min-h-[200px]\"\r\n                size=\"8\"\r\n              >\r\n                <option\r\n                  value=\"\"\r\n                  class=\"text-gray-400 bg-gray-800 py-3 px-4 border-b border-gray-700 text-base\"\r\n                >\r\n                  -- اختر اللاعب الأول --\r\n                </option>\r\n                <option\r\n                  *ngFor=\"let player of getAllActivePlayers()\"\r\n                  [value]=\"player.playerId\"\r\n                  [selected]=\"matchForm.player1Id === player.playerId\"\r\n                  class=\"text-white bg-gray-800 py-3 px-4 border-b border-gray-700 hover:bg-gray-700 cursor-pointer text-base\"\r\n                >\r\n                  {{ player.fullName }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n            <!-- Player 1 Suggestions Dropdown -->\r\n            <div\r\n              *ngIf=\"\r\n                showPlayer1Suggestions && filteredPlayer1Suggestions.length > 0\r\n              \"\r\n              class=\"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto\"\r\n            >\r\n              <div\r\n                *ngFor=\"let player of filteredPlayer1Suggestions\"\r\n                (click)=\"selectPlayer1(player)\"\r\n                class=\"p-2 hover:bg-gray-700 cursor-pointer text-white border-b border-gray-600 last:border-b-0\"\r\n              >\r\n                {{ player.fullName }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            *ngIf=\"\r\n              matchForm.player1Name && !getPlayerByName(matchForm.player1Name)\r\n            \"\r\n            class=\"text-red-400 text-sm mt-1\"\r\n          >\r\n            Player not found. Please select from the list.\r\n          </div>\r\n        </div>\r\n\r\n        <div *ngIf=\"!selectedPlayerForMatch\" class=\"mb-4\">\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Player 2</label\r\n          >\r\n          <div class=\"relative\">\r\n            <input\r\n              type=\"text\"\r\n              [(ngModel)]=\"matchForm.player2Name\"\r\n              (input)=\"searchPlayer2($event)\"\r\n              (focus)=\"showPlayer2Suggestions = true; showPlayer2Select = true\"\r\n              (blur)=\"hidePlayer2Suggestions()\"\r\n              [placeholder]=\"'Type to search for Player 2...'\"\r\n              class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n              autocomplete=\"off\"\r\n            />\r\n            <!-- Player 2 Select Box -->\r\n            <div\r\n              *ngIf=\"showPlayer2Select\"\r\n              class=\"absolute z-[9999] w-full mt-1 top-full\"\r\n            >\r\n              <select\r\n                (change)=\"selectPlayer2FromSelect($event)\"\r\n                (blur)=\"showPlayer2Select = false\"\r\n                class=\"w-full bg-gray-800 border border-gray-600 rounded-md text-white shadow-2xl min-h-[200px]\"\r\n                size=\"6\"\r\n              >\r\n                <option\r\n                  value=\"\"\r\n                  class=\"text-gray-400 bg-gray-800 py-3 px-4 border-b border-gray-700 text-base\"\r\n                >\r\n                  -- اختر اللاعب الثاني --\r\n                </option>\r\n                <option\r\n                  *ngFor=\"\r\n                    let player of getOpponentsForPlayerByName(\r\n                      matchForm.player1Name\r\n                    )\r\n                  \"\r\n                  [value]=\"player.playerId\"\r\n                  [selected]=\"matchForm.player2Id === player.playerId\"\r\n                  class=\"text-white bg-gray-800 py-3 px-4 border-b border-gray-700 hover:bg-gray-700 cursor-pointer text-base\"\r\n                >\r\n                  {{ player.fullName }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n            <!-- Player 2 Suggestions Dropdown -->\r\n            <div\r\n              *ngIf=\"\r\n                showPlayer2Suggestions && filteredPlayer2Suggestions.length > 0\r\n              \"\r\n              class=\"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto\"\r\n            >\r\n              <div\r\n                *ngFor=\"let player of filteredPlayer2Suggestions\"\r\n                (click)=\"selectPlayer2(player)\"\r\n                class=\"p-2 hover:bg-gray-700 cursor-pointer text-white border-b border-gray-600 last:border-b-0\"\r\n              >\r\n                {{ player.fullName }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            *ngIf=\"\r\n              matchForm.player2Name && !getPlayerByName(matchForm.player2Name)\r\n            \"\r\n            class=\"text-red-400 text-sm mt-1\"\r\n          >\r\n            Player not found. Please select from the list.\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Fixed player names for edit mode -->\r\n        <div *ngIf=\"selectedPlayerForMatch\" class=\"mb-4\">\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Player 1</label\r\n          >\r\n          <div\r\n            class=\"border border-gray-600 p-2 w-full rounded bg-gray-700 text-white\"\r\n          >\r\n            {{\r\n              selectedPlayerForMatch.player1Name ||\r\n                getPlayerName(matchForm.player1Id)\r\n            }}\r\n          </div>\r\n        </div>\r\n\r\n        <div *ngIf=\"selectedPlayerForMatch\" class=\"mb-4\">\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Player 2</label\r\n          >\r\n          <div\r\n            class=\"border border-gray-600 p-2 w-full rounded bg-gray-700 text-white\"\r\n          >\r\n            {{\r\n              selectedPlayerForMatch.player2Name ||\r\n                getPlayerName(matchForm.player2Id)\r\n            }}\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grid grid-cols-2 gap-4 mb-4\">\r\n          <div>\r\n            <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n              >Player 1 Score</label\r\n            >\r\n            <input\r\n              type=\"number\"\r\n              [(ngModel)]=\"matchForm.player1Score\"\r\n              min=\"0\"\r\n              (input)=\"validateScore('player1')\"\r\n              placeholder=\"Enter score\"\r\n              class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n              >Player 2 Score</label\r\n            >\r\n            <input\r\n              type=\"number\"\r\n              [(ngModel)]=\"matchForm.player2Score\"\r\n              min=\"0\"\r\n              (input)=\"validateScore('player2')\"\r\n              placeholder=\"Enter score\"\r\n              class=\"border border-gray-600 p-2 w-full rounded bg-gray-800 text-white placeholder-gray-400\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"flex justify-end space-x-4\">\r\n          <button\r\n            class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n            (click)=\"closeRecordMatchModal()\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n            (click)=\"selectedPlayerForMatch ? updateMatch() : recordNewMatch()\"\r\n            [disabled]=\"\r\n              !matchForm.player1Name ||\r\n              !matchForm.player2Name ||\r\n              (!selectedPlayerForMatch &&\r\n                matchForm.player1Name === matchForm.player2Name) ||\r\n              (matchForm.player1Score === 0 && matchForm.player2Score === 0) ||\r\n              isRecordingMatch ||\r\n              !getPlayerByName(matchForm.player1Name) ||\r\n              !getPlayerByName(matchForm.player2Name)\r\n            \"\r\n          >\r\n            {{\r\n              isRecordingMatch\r\n                ? \"Processing...\"\r\n                : selectedPlayerForMatch\r\n                ? \"Update Match\"\r\n                : \"Record Match\"\r\n            }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FriendlyMatchService } from '../../core/services/friendly-match.service';\r\nimport { FriendlyMessageService } from '../../core/services/friendly-message.service';\r\n\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { DateFilter } from 'friendly-match-types';\r\nimport { calculateUnreadCount } from 'friendly-message-types';\r\n\r\n@Component({\r\n  selector: 'app-friendlies',\r\n  templateUrl: './friendlies.component.html',\r\n  styleUrls: ['./friendlies.component.css'],\r\n})\r\nexport class FriendliesComponent implements OnInit {\r\n  // Tab management\r\n  activeTab: 'friendlies' = 'friendlies';\r\n\r\n  // Sidebar state\r\n  isSidebarOpen = false;\r\n\r\n  // Players data\r\n  players: any[] = [];\r\n  selectedPlayer: any = null;\r\n  displayMatches: any[] = [];\r\n\r\n  // Modals\r\n  showModal = false;\r\n  showDeleteModal = false;\r\n  showRecordMatchModal = false;\r\n  selectedPlayerToDelete: any = null;\r\n  selectedPlayerForMatch: any = null;\r\n\r\n  // Form data (for friendly matches)\r\n  friendlyPlayerName = '';\r\n  matchForm = {\r\n    player1Id: 0,\r\n    player2Id: 0,\r\n    player1Name: '',\r\n    player2Name: '',\r\n    player1Score: null as number | null,\r\n    player2Score: null as number | null,\r\n    playedOn: new Date(),\r\n  };\r\n\r\n  // Loading states\r\n  isRecordingMatch = false;\r\n\r\n  // Autocomplete states\r\n  showPlayer1Suggestions = false;\r\n  showPlayer2Suggestions = false;\r\n  showPlayer1Select = false;\r\n  showPlayer2Select = false;\r\n  filteredPlayer1Suggestions: any[] = [];\r\n  filteredPlayer2Suggestions: any[] = [];\r\n\r\n  // Statistics\r\n  totalPlayers = 0;\r\n  totalMatches = 0;\r\n  totalUnreadFriendlyMessages = 0;\r\n\r\n  // All matches pagination\r\n  allMatches: any[] = [];\r\n  currentPage = 1;\r\n  itemsPerPage = 10;\r\n  totalPages = 0;\r\n  Math = Math; // Make Math available in template\r\n\r\n  // Filter options\r\n  filterForm = {\r\n    playerId: 0,\r\n    opponentIds: [] as number[],\r\n    dateFilter: DateFilter.AllTime,\r\n  };\r\n  DateFilter = DateFilter; // Make enum available in template\r\n\r\n  constructor(\r\n    private friendlyMatchService: FriendlyMatchService,\r\n    private friendlyMessageService: FriendlyMessageService,\r\n    private toastr: ToastrService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadPlayers();\r\n    this.loadAllMatches();\r\n    this.loadUnreadFriendlyMessagesCount();\r\n  }\r\n\r\n  loadUnreadFriendlyMessagesCount(): void {\r\n    this.friendlyMessageService.getAllMessages().subscribe({\r\n      next: (response: any) => {\r\n        if (response.success && response.messages) {\r\n          this.totalUnreadFriendlyMessages = calculateUnreadCount(\r\n            response.messages\r\n          );\r\n        } else {\r\n          this.totalUnreadFriendlyMessages = 0;\r\n        }\r\n      },\r\n      error: (error: any) => {\r\n        console.error('Error loading unread friendly messages count:', error);\r\n        this.totalUnreadFriendlyMessages = 0;\r\n      },\r\n    });\r\n  }\r\n\r\n  toggleSidebar(): void {\r\n    this.isSidebarOpen = !this.isSidebarOpen;\r\n  }\r\n\r\n  loadPlayers(): void {\r\n    this.friendlyMatchService.getAllFriendlyPlayers().subscribe({\r\n      next: (players: any) => {\r\n        this.players = players;\r\n        this.totalPlayers = players.length;\r\n        this.calculateStatistics();\r\n      },\r\n      error: (error: any) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل اللاعبين',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  selectPlayer(player: any): void {\r\n    this.selectedPlayer = player;\r\n    this.loadPlayerMatches(player.playerId);\r\n  }\r\n\r\n  loadPlayerMatches(playerId: number): void {\r\n    this.friendlyMatchService.getAllFriendlyMatches().subscribe({\r\n      next: (matches: any) => {\r\n        // Get the player's name\r\n        const player = this.players.find((p) => p.playerId === playerId);\r\n        const playerName = player?.fullName;\r\n\r\n        this.displayMatches = matches.filter(\r\n          (match: any) =>\r\n            match.player1Name === playerName || match.player2Name === playerName\r\n        );\r\n      },\r\n      error: (error: any) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل مباريات اللاعب',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  calculateStatistics(): void {\r\n    this.friendlyMatchService.getAllFriendlyMatches().subscribe({\r\n      next: (matches: any) => {\r\n        this.totalMatches = matches.length;\r\n      },\r\n      error: (error: any) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل الإحصائيات',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  // Modal methods (for friendly players)\r\n  openModal(): void {\r\n    this.showModal = true;\r\n    this.friendlyPlayerName = '';\r\n  }\r\n\r\n  closeModal(): void {\r\n    this.showModal = false;\r\n    this.friendlyPlayerName = '';\r\n  }\r\n\r\n  addPlayer(): void {\r\n    if (!this.friendlyPlayerName.trim()) {\r\n      this.toastr.warning('الرجاء إدخال اسم اللاعب', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    this.friendlyMatchService\r\n      .addFriendlyPlayerAsync(this.friendlyPlayerName)\r\n      .subscribe({\r\n        next: (response: any) => {\r\n          if (response.success) {\r\n            this.toastr.success(\r\n              `تم إضافة اللاعب ${this.friendlyPlayerName} بنجاح`,\r\n              'تم الإضافة'\r\n            );\r\n            // Refresh cache and reload players\r\n            this.friendlyMatchService.refreshFriendlyPlayers();\r\n            this.loadPlayers();\r\n            this.closeModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل إضافة اللاعب',\r\n              'خطأ في الإضافة'\r\n            );\r\n          }\r\n        },\r\n        error: (error: any) => {\r\n          this.toastr.error(\r\n            error.error?.message ||\r\n              error.message ||\r\n              'حصل خطأ أثناء إضافة اللاعب',\r\n            'خطأ في الإضافة'\r\n          );\r\n        },\r\n      });\r\n  }\r\n\r\n  confirmDelete(player: any, event: Event): void {\r\n    event.stopPropagation();\r\n    this.selectedPlayerToDelete = player;\r\n    this.showDeleteModal = true;\r\n  }\r\n\r\n  deleteConfirmedPlayer(): void {\r\n    if (!this.selectedPlayerToDelete) return;\r\n\r\n    this.friendlyMatchService\r\n      .deleteFriendlyPlayerAsync(this.selectedPlayerToDelete.playerId)\r\n      .subscribe({\r\n        next: (response: any) => {\r\n          if (response.success) {\r\n            this.toastr.success(\r\n              `تم حذف اللاعب ${this.selectedPlayerToDelete.fullName} بنجاح`,\r\n              'تم الحذف'\r\n            );\r\n            // Refresh cache and reload players\r\n            this.friendlyMatchService.refreshFriendlyPlayers();\r\n            this.loadPlayers();\r\n            if (\r\n              this.selectedPlayer?.playerId ===\r\n              this.selectedPlayerToDelete.playerId\r\n            ) {\r\n              this.selectedPlayer = null;\r\n              this.displayMatches = [];\r\n            }\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل حذف اللاعب',\r\n              'خطأ في الحذف'\r\n            );\r\n          }\r\n        },\r\n        error: (error: any) => {\r\n          this.toastr.error(\r\n            error.error?.message || error.message || 'حصل خطأ أثناء حذف اللاعب',\r\n            'خطأ في الحذف'\r\n          );\r\n        },\r\n      });\r\n\r\n    this.showDeleteModal = false;\r\n    this.selectedPlayerToDelete = null;\r\n  }\r\n\r\n  getActivePlayersCount(): number {\r\n    return this.players.filter((p) => p.isActive).length;\r\n  }\r\n\r\n  getRecentMatches(): any[] {\r\n    return this.displayMatches.slice(0, 10);\r\n  }\r\n\r\n  // Record Match Modal methods\r\n  openRecordMatchModal(player?: any): void {\r\n    this.selectedPlayerForMatch = player || null;\r\n    if (player) {\r\n      this.matchForm.player1Id = player.playerId;\r\n      this.matchForm.player1Name = player.fullName;\r\n    } else {\r\n      this.matchForm.player1Id = 0;\r\n      this.matchForm.player1Name = '';\r\n    }\r\n    this.matchForm.player2Id = 0;\r\n    this.matchForm.player2Name = '';\r\n    this.matchForm.player1Score = null;\r\n    this.matchForm.player2Score = null;\r\n    this.matchForm.playedOn = new Date();\r\n    this.showRecordMatchModal = true;\r\n  }\r\n\r\n  closeRecordMatchModal(): void {\r\n    this.showRecordMatchModal = false;\r\n    this.selectedPlayerForMatch = null;\r\n    this.matchForm = {\r\n      player1Id: 0,\r\n      player2Id: 0,\r\n      player1Name: '',\r\n      player2Name: '',\r\n      player1Score: 0,\r\n      player2Score: 0,\r\n      playedOn: new Date(),\r\n    };\r\n  }\r\n\r\n  recordNewMatch(): void {\r\n    if (!this.matchForm.player1Name || !this.matchForm.player2Name) {\r\n      this.toastr.warning('الرجاء اختيار كلا اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    // Get player IDs from names\r\n    const player1 = this.getPlayerByName(this.matchForm.player1Name);\r\n    const player2 = this.getPlayerByName(this.matchForm.player2Name);\r\n\r\n    if (!player1 || !player2) {\r\n      this.toastr.warning('الرجاء التأكد من صحة أسماء اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    // Only check for same player in new match mode, not edit mode\r\n    if (!this.selectedPlayerForMatch && player1.playerId === player2.playerId) {\r\n      this.toastr.warning(\r\n        'لا يمكن أن يكون اللاعب الأول والثاني نفس الشخص',\r\n        'تحذير'\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.matchForm.player1Score === null ||\r\n      this.matchForm.player2Score === null\r\n    ) {\r\n      this.toastr.warning('الرجاء إدخال النقاط لكلا اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    if (this.matchForm.player1Score < 0 || this.matchForm.player2Score < 0) {\r\n      this.toastr.warning('لا يمكن أن تكون النقاط سالبة', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.matchForm.player1Score === 0 &&\r\n      this.matchForm.player2Score === 0\r\n    ) {\r\n      this.toastr.warning(\r\n        'يجب أن يكون لدى لاعب واحد على الأقل نقاط إيجابية (0-0 غير مسموح)',\r\n        'تحذير'\r\n      );\r\n      return;\r\n    }\r\n\r\n    const matchData = {\r\n      player1Id: player1.playerId,\r\n      player2Id: player2.playerId,\r\n      player1Score: this.matchForm.player1Score,\r\n      player2Score: this.matchForm.player2Score,\r\n      playedOn: this.matchForm.playedOn,\r\n    };\r\n\r\n    this.isRecordingMatch = true;\r\n\r\n    this.friendlyMatchService.recordFriendlyMatchAsync(matchData).subscribe({\r\n      next: (response) => {\r\n        if (response.success) {\r\n          // Get player names for the toast message\r\n          this.toastr.success(\r\n            `تم تسجيل المباراة بنجاح: ${player1.fullName} (${this.matchForm.player1Score}) - ${player2.fullName} (${this.matchForm.player2Score})`,\r\n            'تم تسجيل المباراة'\r\n          );\r\n\r\n          // Refresh cache and reload data\r\n          this.friendlyMatchService.refreshFriendlyMatches();\r\n          this.friendlyMatchService.refreshFriendlyPlayers();\r\n          this.loadPlayers();\r\n          this.calculateStatistics();\r\n          if (this.selectedPlayer) {\r\n            this.loadPlayerMatches(this.selectedPlayer.playerId);\r\n          }\r\n          this.loadAllMatches();\r\n          this.closeRecordMatchModal();\r\n        } else {\r\n          this.toastr.error(\r\n            response.message || 'فشل تسجيل المباراة',\r\n            'خطأ في التسجيل'\r\n          );\r\n        }\r\n        this.isRecordingMatch = false;\r\n      },\r\n      error: (error) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تسجيل المباراة',\r\n          'خطأ في التسجيل'\r\n        );\r\n        this.isRecordingMatch = false;\r\n      },\r\n    });\r\n  }\r\n\r\n  getOpponentsForPlayer(playerId: number): any[] {\r\n    // In edit mode, allow selecting any player except the current player1\r\n    if (this.selectedPlayerForMatch) {\r\n      return this.players.filter(\r\n        (p) => p.playerId !== playerId && p.isActive !== false\r\n      );\r\n    }\r\n    // In new match mode, filter out the selected player1\r\n    return this.players.filter(\r\n      (p) => p.playerId !== playerId && p.isActive !== false\r\n    );\r\n  }\r\n\r\n  getOpponentsForPlayerByName(playerName: string): any[] {\r\n    const player = this.getPlayerByName(playerName);\r\n    if (!player) return this.getAllActivePlayers();\r\n\r\n    // In edit mode, allow selecting any player except the current player1\r\n    if (this.selectedPlayerForMatch) {\r\n      return this.players.filter(\r\n        (p) => p.playerId !== player.playerId && p.isActive !== false\r\n      );\r\n    }\r\n    // In new match mode, filter out the selected player1\r\n    return this.players.filter(\r\n      (p) => p.playerId !== player.playerId && p.isActive !== false\r\n    );\r\n  }\r\n\r\n  getAllActivePlayers(): any[] {\r\n    // If isActive is undefined, consider all players as active\r\n    return this.players.filter((p) => p.isActive !== false);\r\n  }\r\n\r\n  validateScore(player: 'player1' | 'player2'): void {\r\n    if (player === 'player1') {\r\n      if (\r\n        this.matchForm.player1Score !== null &&\r\n        this.matchForm.player1Score < 0\r\n      ) {\r\n        this.matchForm.player1Score = 0;\r\n      }\r\n    } else {\r\n      if (\r\n        this.matchForm.player2Score !== null &&\r\n        this.matchForm.player2Score < 0\r\n      ) {\r\n        this.matchForm.player2Score = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  // All matches management\r\n  loadAllMatches(): void {\r\n    this.friendlyMatchService.getAllFriendlyMatches().subscribe({\r\n      next: (matches: any) => {\r\n        this.allMatches = matches.sort(\r\n          (a: any, b: any) =>\r\n            new Date(b.playedOn).getTime() - new Date(a.playedOn).getTime()\r\n        );\r\n        this.totalMatches = matches.length;\r\n        this.totalPages = Math.ceil(this.allMatches.length / this.itemsPerPage);\r\n      },\r\n      error: (error) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل المباريات',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  // Cache-based filtering\r\n  loadFilteredMatchesFromCache(): void {\r\n    this.friendlyMatchService.getAllFriendlyMatches().subscribe({\r\n      next: (allMatches: any) => {\r\n        let filteredMatches = [...allMatches];\r\n\r\n        // Apply date filter\r\n        if (this.filterForm.dateFilter !== DateFilter.AllTime) {\r\n          const now = new Date();\r\n          let cutoffDate: Date;\r\n\r\n          switch (this.filterForm.dateFilter) {\r\n            case DateFilter.Today:\r\n              cutoffDate = new Date(\r\n                now.getFullYear(),\r\n                now.getMonth(),\r\n                now.getDate()\r\n              );\r\n              break;\r\n            case DateFilter.Last3Days:\r\n              cutoffDate = new Date(now.getTime() - 3 * 24 * 60 * 60 * 1000);\r\n              break;\r\n            case DateFilter.LastWeek:\r\n              cutoffDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n              break;\r\n            case DateFilter.LastMonth:\r\n              cutoffDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n              break;\r\n            default:\r\n              cutoffDate = new Date(0);\r\n          }\r\n\r\n          filteredMatches = filteredMatches.filter(\r\n            (match) => new Date(match.playedOn) >= cutoffDate\r\n          );\r\n        }\r\n\r\n        // Apply player filter\r\n        if (this.filterForm.playerId) {\r\n          // Get the selected player's name\r\n          const selectedPlayer = this.players.find(\r\n            (p) => p.playerId === this.filterForm.playerId\r\n          );\r\n          const selectedPlayerName = selectedPlayer?.fullName;\r\n\r\n          filteredMatches = filteredMatches.filter((match) => {\r\n            const isMatch =\r\n              match.player1Name === selectedPlayerName ||\r\n              match.player2Name === selectedPlayerName;\r\n\r\n            return isMatch;\r\n          });\r\n\r\n          // Reorder matches so selected player is always Player 1\r\n          filteredMatches = this.reorderMatchesForSelectedPlayer(\r\n            filteredMatches,\r\n            selectedPlayerName\r\n          );\r\n        }\r\n\r\n        // Apply opponent filter\r\n        if (\r\n          this.filterForm.opponentIds &&\r\n          this.filterForm.opponentIds.length > 0\r\n        ) {\r\n          // Get opponent names\r\n          const opponentNames = this.filterForm.opponentIds\r\n            .map((id) => {\r\n              const player = this.players.find((p) => p.playerId === id);\r\n              return player?.fullName;\r\n            })\r\n            .filter((name) => name);\r\n\r\n          filteredMatches = filteredMatches.filter(\r\n            (match) =>\r\n              opponentNames.includes(match.player1Name) ||\r\n              opponentNames.includes(match.player2Name)\r\n          );\r\n        }\r\n\r\n        // Sort by date (newest first)\r\n        filteredMatches.sort(\r\n          (a, b) =>\r\n            new Date(b.playedOn).getTime() - new Date(a.playedOn).getTime()\r\n        );\r\n\r\n        this.allMatches = filteredMatches;\r\n        this.totalMatches = filteredMatches.length;\r\n        this.totalPages = Math.ceil(this.allMatches.length / this.itemsPerPage);\r\n      },\r\n      error: (error) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل المباريات المفلترة',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  // Helper method to reorder matches so selected player is always Player 1\r\n  private reorderMatchesForSelectedPlayer(\r\n    matches: any[],\r\n    selectedPlayerName: string\r\n  ): any[] {\r\n    return matches.map((match) => {\r\n      // If the selected player is already Player 1, keep as is\r\n      if (match.player1Name === selectedPlayerName) {\r\n        return match;\r\n      }\r\n\r\n      // If the selected player is Player 2, swap the players\r\n      if (match.player2Name === selectedPlayerName) {\r\n        return {\r\n          ...match,\r\n          player1Name: match.player2Name,\r\n          player2Name: match.player1Name,\r\n          player1Score: match.player2Score,\r\n          player2Score: match.player1Score,\r\n          player1Id: match.player2Id,\r\n          player2Id: match.player1Id,\r\n        };\r\n      }\r\n\r\n      // If neither player matches (shouldn't happen with our filter), keep as is\r\n      return match;\r\n    });\r\n  }\r\n\r\n  loadFilteredMatches(): void {\r\n    const filter: any = {\r\n      page: this.currentPage,\r\n      pageSize: this.itemsPerPage,\r\n      dateFilter: this.filterForm.dateFilter,\r\n    };\r\n\r\n    if (this.filterForm.playerId) {\r\n      filter.playerId = this.filterForm.playerId;\r\n    }\r\n    if (this.filterForm.opponentIds && this.filterForm.opponentIds.length > 0) {\r\n      filter.opponentIds = this.filterForm.opponentIds;\r\n    }\r\n\r\n    this.friendlyMatchService.getFilteredMatches(filter).subscribe({\r\n      next: (result: any) => {\r\n        this.allMatches = result.matches;\r\n        this.totalMatches = result.totalCount;\r\n        this.totalPages = result.totalPages;\r\n      },\r\n      error: (error: any) => {\r\n        this.toastr.error(\r\n          error.error?.message ||\r\n            error.message ||\r\n            'حصل خطأ أثناء تحميل المباريات المفلترة',\r\n          'خطأ في التحميل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  onFilterChange(): void {\r\n    this.currentPage = 1;\r\n    this.loadFilteredMatchesFromCache();\r\n  }\r\n\r\n  clearFilters(): void {\r\n    this.filterForm = {\r\n      playerId: 0,\r\n      opponentIds: [],\r\n      dateFilter: DateFilter.AllTime,\r\n    };\r\n    this.currentPage = 1;\r\n    this.loadAllMatches();\r\n  }\r\n\r\n  getPaginatedMatches(): any[] {\r\n    const startIndex = (this.currentPage - 1) * this.itemsPerPage;\r\n    const endIndex = startIndex + this.itemsPerPage;\r\n    return this.allMatches.slice(startIndex, endIndex);\r\n  }\r\n\r\n  changePage(page: number): void {\r\n    if (page >= 1 && page <= this.totalPages) {\r\n      this.currentPage = page;\r\n    }\r\n  }\r\n\r\n  getPlayerName(playerId: number): string {\r\n    const player = this.players.find((p) => p.playerId === playerId);\r\n    return player ? player.fullName : 'Unknown Player';\r\n  }\r\n\r\n  // Search and validation methods for player names\r\n  searchPlayer1(event: any): void {\r\n    const playerName = event.target.value;\r\n    this.matchForm.player1Name = playerName;\r\n\r\n    // Filter suggestions\r\n    if (playerName.trim()) {\r\n      this.filteredPlayer1Suggestions = this.getAllActivePlayers().filter(\r\n        (player) =>\r\n          player.fullName.toLowerCase().includes(playerName.toLowerCase())\r\n      );\r\n    } else {\r\n      this.filteredPlayer1Suggestions = [];\r\n    }\r\n\r\n    const player = this.getPlayerByName(playerName);\r\n    if (player) {\r\n      this.matchForm.player1Id = player.playerId;\r\n      // Update player2 options when player1 changes\r\n      this.matchForm.player2Name = '';\r\n      this.matchForm.player2Id = 0;\r\n      this.filteredPlayer2Suggestions = [];\r\n    } else {\r\n      this.matchForm.player1Id = 0;\r\n    }\r\n  }\r\n\r\n  searchPlayer2(event: any): void {\r\n    const playerName = event.target.value;\r\n    this.matchForm.player2Name = playerName;\r\n\r\n    // Filter suggestions based on player1\r\n    if (playerName.trim()) {\r\n      this.filteredPlayer2Suggestions = this.getOpponentsForPlayerByName(\r\n        this.matchForm.player1Name\r\n      ).filter((player) =>\r\n        player.fullName.toLowerCase().includes(playerName.toLowerCase())\r\n      );\r\n    } else {\r\n      this.filteredPlayer2Suggestions = [];\r\n    }\r\n\r\n    const player = this.getPlayerByName(playerName);\r\n    if (player) {\r\n      this.matchForm.player2Id = player.playerId;\r\n    } else {\r\n      this.matchForm.player2Id = 0;\r\n    }\r\n  }\r\n\r\n  selectPlayer1(player: any): void {\r\n    this.matchForm.player1Name = player.fullName;\r\n    this.matchForm.player1Id = player.playerId;\r\n    this.showPlayer1Suggestions = false;\r\n    this.showPlayer1Select = false;\r\n    this.filteredPlayer1Suggestions = [];\r\n\r\n    // Clear player2 when player1 changes\r\n    this.matchForm.player2Name = '';\r\n    this.matchForm.player2Id = 0;\r\n    this.filteredPlayer2Suggestions = [];\r\n  }\r\n\r\n  selectPlayer2(player: any): void {\r\n    this.matchForm.player2Name = player.fullName;\r\n    this.matchForm.player2Id = player.playerId;\r\n    this.showPlayer2Suggestions = false;\r\n    this.showPlayer2Select = false;\r\n    this.filteredPlayer2Suggestions = [];\r\n  }\r\n\r\n  selectPlayer1FromSelect(event: any): void {\r\n    const playerId = parseInt(event.target.value);\r\n    if (playerId) {\r\n      const player = this.players.find((p) => p.playerId === playerId);\r\n      if (player) {\r\n        this.matchForm.player1Name = player.fullName;\r\n        this.matchForm.player1Id = player.playerId;\r\n        // Clear player2 when player1 changes\r\n        this.matchForm.player2Name = '';\r\n        this.matchForm.player2Id = 0;\r\n        this.filteredPlayer2Suggestions = [];\r\n      }\r\n    } else {\r\n      this.matchForm.player1Name = '';\r\n      this.matchForm.player1Id = 0;\r\n    }\r\n    this.showPlayer1Select = false;\r\n  }\r\n\r\n  selectPlayer2FromSelect(event: any): void {\r\n    const playerId = parseInt(event.target.value);\r\n    if (playerId) {\r\n      const player = this.players.find((p) => p.playerId === playerId);\r\n      if (player) {\r\n        this.matchForm.player2Name = player.fullName;\r\n        this.matchForm.player2Id = player.playerId;\r\n      }\r\n    } else {\r\n      this.matchForm.player2Name = '';\r\n      this.matchForm.player2Id = 0;\r\n    }\r\n    this.showPlayer2Select = false;\r\n  }\r\n\r\n  hidePlayer1Suggestions(): void {\r\n    setTimeout(() => {\r\n      this.showPlayer1Suggestions = false;\r\n      this.showPlayer1Select = false;\r\n    }, 200);\r\n  }\r\n\r\n  hidePlayer2Suggestions(): void {\r\n    setTimeout(() => {\r\n      this.showPlayer2Suggestions = false;\r\n      this.showPlayer2Select = false;\r\n    }, 200);\r\n  }\r\n\r\n  getPlayerByName(playerName: string): any {\r\n    return this.players.find((p) => p.fullName === playerName);\r\n  }\r\n\r\n  // Edit match functionality\r\n  editMatch(match: any): void {\r\n    // Find player IDs by names\r\n    const player1 = this.players.find((p) => p.fullName === match.player1Name);\r\n    const player2 = this.players.find((p) => p.fullName === match.player2Name);\r\n\r\n    this.matchForm = {\r\n      player1Id: player1?.playerId || 0,\r\n      player2Id: player2?.playerId || 0,\r\n      player1Name: match.player1Name,\r\n      player2Name: match.player2Name,\r\n      player1Score: match.player1Score,\r\n      player2Score: match.player2Score,\r\n      playedOn: new Date(match.playedOn),\r\n    };\r\n    this.selectedPlayerForMatch = match;\r\n    this.showRecordMatchModal = true;\r\n  }\r\n\r\n  updateMatch(): void {\r\n    if (!this.selectedPlayerForMatch) return;\r\n\r\n    if (!this.matchForm.player1Name || !this.matchForm.player2Name) {\r\n      this.toastr.warning('الرجاء التأكد من أسماء اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    // Get player IDs from names\r\n    const player1 = this.getPlayerByName(this.matchForm.player1Name);\r\n    const player2 = this.getPlayerByName(this.matchForm.player2Name);\r\n\r\n    if (!player1 || !player2) {\r\n      this.toastr.warning('الرجاء التأكد من صحة أسماء اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    // In edit mode, we don't need to check for same player since names are fixed\r\n\r\n    if (\r\n      this.matchForm.player1Score === null ||\r\n      this.matchForm.player2Score === null\r\n    ) {\r\n      this.toastr.warning('الرجاء إدخال النقاط لكلا اللاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    if (this.matchForm.player1Score < 0 || this.matchForm.player2Score < 0) {\r\n      this.toastr.warning('لا يمكن أن تكون النقاط سالبة', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.matchForm.player1Score === 0 &&\r\n      this.matchForm.player2Score === 0\r\n    ) {\r\n      this.toastr.warning(\r\n        'يجب أن يكون لدى لاعب واحد على الأقل نقاط إيجابية (0-0 غير مسموح)',\r\n        'تحذير'\r\n      );\r\n      return;\r\n    }\r\n\r\n    this.isRecordingMatch = true;\r\n\r\n    this.friendlyMatchService\r\n      .updateFriendlyMatchAsync(this.selectedPlayerForMatch.matchId, {\r\n        player1Id: player1.playerId,\r\n        player2Id: player2.playerId,\r\n        player1Score: this.matchForm.player1Score,\r\n        player2Score: this.matchForm.player2Score,\r\n      })\r\n      .subscribe({\r\n        next: (response: any) => {\r\n          if (response.success) {\r\n            this.toastr.success(\r\n              `تم تحديث المباراة بنجاح: ${player1.fullName} (${this.matchForm.player1Score}) - ${player2.fullName} (${this.matchForm.player2Score})`,\r\n              'تم تحديث المباراة'\r\n            );\r\n\r\n            // Refresh cache and reload data\r\n            this.friendlyMatchService.refreshFriendlyMatches();\r\n            this.loadAllMatches();\r\n            this.calculateStatistics();\r\n            if (this.selectedPlayer) {\r\n              this.loadPlayerMatches(this.selectedPlayer.playerId);\r\n            }\r\n            this.closeRecordMatchModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل تحديث المباراة',\r\n              'خطأ في التحديث'\r\n            );\r\n          }\r\n          this.isRecordingMatch = false;\r\n        },\r\n        error: (error: any) => {\r\n          this.toastr.error(\r\n            error.error?.message ||\r\n              error.message ||\r\n              'حصل خطأ أثناء تحديث المباراة',\r\n            'خطأ في التحديث'\r\n          );\r\n          this.isRecordingMatch = false;\r\n        },\r\n      });\r\n  }\r\n\r\n  deleteMatchFromList(matchId: number): void {\r\n    if (confirm('هل أنت متأكد من حذف هذه المباراة؟')) {\r\n      this.friendlyMatchService.deleteFriendlyMatchAsync(matchId).subscribe({\r\n        next: (response: any) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم حذف المباراة بنجاح', 'تم الحذف');\r\n            // Refresh cache and reload data\r\n            this.friendlyMatchService.refreshFriendlyMatches();\r\n            this.loadAllMatches();\r\n            this.calculateStatistics();\r\n            if (this.selectedPlayer) {\r\n              this.loadPlayerMatches(this.selectedPlayer.playerId);\r\n            }\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل حذف المباراة',\r\n              'خطأ في الحذف'\r\n            );\r\n          }\r\n        },\r\n        error: (error: any) => {\r\n          this.toastr.error(\r\n            error.error?.message ||\r\n              error.message ||\r\n              'حصل خطأ أثناء حذف المباراة',\r\n            'خطأ في الحذف'\r\n          );\r\n        },\r\n      });\r\n    }\r\n  }\r\n}\r\n","<div\r\n  class=\"container mx-auto p-4 flex flex-col sm:flex-row overflow-hidden h-screen\"\r\n>\r\n  <!-- Chats List -->\r\n  <div\r\n    class=\"w-full sm:w-1/3 border-r border-gray-600 sm:block\"\r\n    [ngClass]=\"{ hidden: selectedChat }\"\r\n  >\r\n    <div class=\"flex items-center justify-between mb-6\">\r\n      <h2 class=\"text-2xl font-bold text-white\">📬 Friendly Inbox</h2>\r\n    </div>\r\n\r\n    <!-- No Chats -->\r\n    <div *ngIf=\"playerChats.length === 0\" class=\"text-center text-gray-300\">\r\n      No friendly messages here 📭\r\n    </div>\r\n\r\n    <!-- Chats List -->\r\n    <div\r\n      *ngIf=\"playerChats.length > 0\"\r\n      class=\"space-y-2 overflow-y-auto max-h-[calc(100vh-120px)]\"\r\n    >\r\n      <div\r\n        *ngFor=\"let chat of playerChats; trackBy: trackByPlayerId\"\r\n        class=\"p-4 backdrop-blur-sm border border-gray-600 rounded-lg hover:bg-gray-700 cursor-pointer flex items-center justify-between\"\r\n        (click)=\"openChat(chat.senderId)\"\r\n      >\r\n        <div>\r\n          <p class=\"font-bold text-white\">{{ chat.senderFullName }}</p>\r\n          <p class=\"text-sm text-gray-300 truncate\">{{ chat.lastMessage }}</p>\r\n        </div>\r\n        <span\r\n          *ngIf=\"chat.unreadCount > 0\"\r\n          class=\"bg-green-600 text-white text-xs font-bold rounded-full px-2 py-1\"\r\n        >\r\n          {{ chat.unreadCount }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Chat View -->\r\n  <div\r\n    class=\"w-full sm:w-2/3 flex flex-col h-full relative\"\r\n    [ngClass]=\"{ block: selectedChat, 'hidden sm:flex': !selectedChat }\"\r\n  >\r\n    <div *ngIf=\"selectedChat; else noChatSelected\" class=\"flex flex-col h-full\">\r\n      <!-- Chat Header - Fixed -->\r\n      <div\r\n        class=\"fixed left-0 right-0 z-40 p-2 backdrop-blur-sm border-b border-gray-600 flex items-center justify-between bg-black bg-opacity-90\"\r\n        [ngClass]=\"{ 'sm:left-1/3': selectedChat }\"\r\n        [style.top.px]=\"navbarHeight\"\r\n      >\r\n        <div class=\"flex items-center\">\r\n          <button\r\n            (click)=\"closeChat()\"\r\n            class=\"mr-4 text-gray-300 hover:text-white transition\"\r\n          >\r\n            <i class=\"fa-solid fa-arrow-left\" style=\"color: #ffffff\"></i>\r\n          </button>\r\n          <div>\r\n            <p class=\"font-bold text-white text-sm p-0\">\r\n              {{ selectedChat.senderFullName }}\r\n            </p>\r\n            <p class=\"text-xs text-gray-400 p-0\">\r\n              {{ selectedChat.senderPhoneNumber }}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Messages - Scrollable Area with padding for fixed header and footer -->\r\n      <div\r\n        #messagesContainer\r\n        class=\"flex-1 p-4 overflow-y-auto backdrop-blur-sm\"\r\n        [style.margin-top.px]=\"navbarHeight + 80\"\r\n        style=\"margin-bottom: 80px\"\r\n      >\r\n        <div\r\n          *ngFor=\"\r\n            let message of selectedChat.messages;\r\n            trackBy: trackByMessageId\r\n          \"\r\n          class=\"mb-4\"\r\n          [ngClass]=\"{\r\n            'text-right': !message.isFromAdmin,\r\n            'text-left': message.isFromAdmin\r\n          }\"\r\n        >\r\n          <div\r\n            class=\"inline-block p-3 rounded-lg max-w-xs\"\r\n            [ngClass]=\"{\r\n              'bg-green-700': !message.isFromAdmin,\r\n              'bg-gray-700 ': message.isFromAdmin\r\n            }\"\r\n          >\r\n            <p class=\"text-white\">{{ message.content }}</p>\r\n            <p class=\"text-xs mt-1 text-gray-300\">\r\n              {{ message.sentAt | date : \"MMM d, y, hh:mm a\" }}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Reply Input - Fixed -->\r\n      <div\r\n        class=\"fixed bottom-0 left-0 right-0 z-50 p-4 bg-black bg-opacity-90 backdrop-blur-sm border-t border-gray-600\"\r\n        [ngClass]=\"{ 'sm:left-1/3': selectedChat }\"\r\n      >\r\n        <form (ngSubmit)=\"sendReply()\" class=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"replyMessages[selectedChat.messages[0].id]\"\r\n            [ngModelOptions]=\"{ standalone: true }\"\r\n            (ngModelChange)=\"\r\n              replyMessages[selectedChat.messages[0].id] = $event\r\n            \"\r\n            placeholder=\"Write your reply...\"\r\n            class=\"flex-1 p-2 border border-gray-600 rounded-lg bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-600 placeholder-gray-400\"\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            class=\"bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition disabled:bg-gray-600\"\r\n            [disabled]=\"!replyMessages[selectedChat.messages[0].id]\"\r\n          >\r\n            Reply\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Placeholder when no chat is selected -->\r\n    <ng-template #noChatSelected>\r\n      <div class=\"w-full flex items-center justify-center text-gray-300\">\r\n        Select a friendly chat to view messages 📩\r\n      </div>\r\n    </ng-template>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  ChangeDetectorRef,\r\n  ViewChild,\r\n  ElementRef,\r\n  AfterViewChecked,\r\n  OnDestroy,\r\n} from '@angular/core';\r\nimport { FriendlyMessageService } from '../../../core/services/friendly-message.service';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport {\r\n  FriendlyMessageDto,\r\n  FriendlyMessageResponse,\r\n} from 'friendly-message-types';\r\nimport { Subscription } from 'rxjs';\r\n\r\ninterface PlayerChat {\r\n  senderId: string; // استخدام string فقط للتوافق مع GUID\r\n  senderFullName: string;\r\n  senderPhoneNumber: string; // إضافة رقم الهاتف\r\n  lastMessage: string;\r\n  lastMessageDate: string;\r\n  unreadCount: number;\r\n  messages: FriendlyMessageDto[];\r\n}\r\n\r\n@Component({\r\n  selector: 'app-friendly-inbox',\r\n  templateUrl: './friendly-inbox.component.html',\r\n  styleUrls: ['./friendly-inbox.component.css'],\r\n})\r\nexport class FriendlyInboxComponent\r\n  implements OnInit, AfterViewChecked, OnDestroy\r\n{\r\n  playerChats: PlayerChat[] = [];\r\n  selectedPlayerId: string | null = null;\r\n  selectedChat: PlayerChat | null = null;\r\n  replyMessages: { [messageId: number]: string } = {};\r\n  private updateStatusSubscription?: Subscription;\r\n  private refreshSubscription?: Subscription;\r\n  navbarHeight = 60; // default navbar height\r\n\r\n  @ViewChild('messagesContainer')\r\n  messagesContainer!: ElementRef<HTMLDivElement>;\r\n\r\n  constructor(\r\n    private friendlyMessageService: FriendlyMessageService,\r\n    private toastr: ToastrService,\r\n    private cdr: ChangeDetectorRef\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadFriendlyMessages();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.updateStatusSubscription) {\r\n      this.updateStatusSubscription.unsubscribe();\r\n    }\r\n    if (this.refreshSubscription) {\r\n      this.refreshSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private loadFriendlyMessages(): void {\r\n    this.friendlyMessageService.getAllMessages().subscribe({\r\n      next: (response: FriendlyMessageResponse) => {\r\n        if (response.success && response.messages) {\r\n          const groupedMessages = this.groupMessagesBySender(response.messages);\r\n          // ترتيب المحادثات حسب الأحدث (آخر رسالة)\r\n          this.playerChats = groupedMessages.sort(\r\n            (a, b) =>\r\n              new Date(b.lastMessageDate).getTime() -\r\n              new Date(a.lastMessageDate).getTime()\r\n          );\r\n\r\n          // عرض رسالة النجاح مع عدد الرسائل\r\n          const totalMessages = response.messages.length;\r\n          const unreadMessages = response.messages.filter(\r\n            (msg) => !msg.isRead && !msg.isFromAdmin\r\n          ).length;\r\n        } else {\r\n          this.toastr.error(response.message || 'لا يوجد رسائل ودية');\r\n        }\r\n      },\r\n      error: (err: any) => {\r\n        this.toastr.error(\r\n          err.error?.message || err.message || 'حصل خطأ أثناء جلب الرسائل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  // Add refresh method for immediate updates\r\n  refreshMessages(): void {\r\n    this.friendlyMessageService.getAllMessages().subscribe({\r\n      next: (response: FriendlyMessageResponse) => {\r\n        if (response.success && response.messages) {\r\n          const groupedMessages = this.groupMessagesBySender(response.messages);\r\n          // ترتيب المحادثات حسب الأحدث (آخر رسالة)\r\n          this.playerChats = groupedMessages.sort(\r\n            (a, b) =>\r\n              new Date(b.lastMessageDate).getTime() -\r\n              new Date(a.lastMessageDate).getTime()\r\n          );\r\n\r\n          // عرض رسالة التحديث مع عدد الرسائل\r\n          const totalMessages = response.messages.length;\r\n          const unreadMessages = response.messages.filter(\r\n            (msg) => !msg.isRead && !msg.isFromAdmin\r\n          ).length;\r\n\r\n          if (totalMessages > 0) {\r\n            this.toastr.info(\r\n              `تم تحديث ${totalMessages} رسالة${\r\n                unreadMessages > 0\r\n                  ? ` (${unreadMessages} رسالة غير مقروءة)`\r\n                  : ''\r\n              }`,\r\n              'تم تحديث الرسائل'\r\n            );\r\n          } else {\r\n            this.toastr.info('لا توجد رسائل ودية حالياً', 'معلومات');\r\n          }\r\n        } else {\r\n          this.toastr.error(response.message || 'لا يوجد رسائل ودية');\r\n        }\r\n      },\r\n      error: (err: any) => {\r\n        this.toastr.error(\r\n          err.error?.message || err.message || 'حصل خطأ أثناء جلب الرسائل'\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n    if (this.selectedChat && this.messagesContainer) {\r\n      this.scrollToBottom();\r\n    }\r\n  }\r\n\r\n  groupMessagesBySender(messages: FriendlyMessageDto[]): PlayerChat[] {\r\n    const chatMap: { [senderId: string | number]: PlayerChat } = {};\r\n    messages.forEach((msg) => {\r\n      // استخدام senderId كـ playerId (قد يكون string أو number)\r\n      let playerId = msg.senderId || msg.playerId;\r\n\r\n      // إذا كان senderId هو GUID، نستخدمه كما هو\r\n      if (typeof playerId === 'string' && playerId.includes('-')) {\r\n        // هذا GUID، نستخدمه كما هو\r\n      } else if (typeof playerId === 'string') {\r\n        // محاولة تحويل إلى number\r\n        const parsedId = parseInt(playerId, 10);\r\n        if (!isNaN(parsedId) && parsedId > 0) {\r\n          playerId = parsedId;\r\n        }\r\n      }\r\n\r\n      // تأكد من أن playerId موجود\r\n      if (!playerId) {\r\n        return; // تخطي هذه الرسالة\r\n      }\r\n\r\n      if (!chatMap[playerId]) {\r\n        chatMap[playerId] = {\r\n          senderId: String(playerId), // تحويل إلى string\r\n          senderFullName:\r\n            msg.senderFullName || msg.playerFullName || `اللاعب ${playerId}`, // fallback للاسم\r\n          senderPhoneNumber: msg.senderPhoneNumber || 'غير متوفر', // استخدام الحقل الصحيح مع fallback\r\n          lastMessage: '',\r\n          lastMessageDate: '',\r\n          unreadCount: 0,\r\n          messages: [],\r\n        };\r\n      }\r\n      chatMap[playerId].messages.push(msg);\r\n      if (!msg.isFromAdmin && !msg.isRead) {\r\n        chatMap[playerId].unreadCount++;\r\n      }\r\n    });\r\n\r\n    const result = Object.values(chatMap).map((chat) => {\r\n      // ترتيب الرسائل من الأقدم للأحدث\r\n      chat.messages = chat.messages.sort(\r\n        (a, b) => new Date(a.sentAt).getTime() - new Date(b.sentAt).getTime()\r\n      );\r\n      // آخر رسالة\r\n      const lastMsg = chat.messages[chat.messages.length - 1];\r\n      chat.lastMessage = lastMsg?.content ?? '';\r\n      chat.lastMessageDate = lastMsg?.sentAt ?? '';\r\n      return chat;\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  openChat(playerId: string): void {\r\n    this.selectedPlayerId = playerId;\r\n    this.selectedChat =\r\n      this.playerChats.find((chat) => chat.senderId === playerId) || null;\r\n\r\n    if (this.selectedChat) {\r\n      // تأكد من وجود اسم اللاعب\r\n      if (!this.selectedChat.senderFullName) {\r\n        this.selectedChat.senderFullName = `اللاعب ${this.selectedChat.senderId}`;\r\n      }\r\n      // Mark messages as read when opening chat\r\n      this.selectedChat.messages\r\n        .filter((msg) => !msg.isRead && !msg.isFromAdmin)\r\n        .forEach((msg) => {\r\n          this.friendlyMessageService.markMessageAsRead(msg.id).subscribe({\r\n            next: (response: any) => {\r\n              if (response.success) {\r\n                msg.isRead = true;\r\n                this.selectedChat!.unreadCount =\r\n                  this.selectedChat!.messages.filter(\r\n                    (m) => !m.isRead && !m.isFromAdmin\r\n                  ).length;\r\n                this.cdr.detectChanges();\r\n              }\r\n            },\r\n            error: (err: any) => {\r\n              this.toastr.error(\r\n                err.error?.message ||\r\n                  err.message ||\r\n                  'حصل خطأ أثناء تحديث حالة الرسالة',\r\n                'خطأ في التحديث'\r\n              );\r\n            },\r\n          });\r\n        });\r\n      this.cdr.detectChanges();\r\n    }\r\n  }\r\n\r\n  closeChat(): void {\r\n    this.selectedPlayerId = null;\r\n    this.selectedChat = null;\r\n    this.replyMessages = {};\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  sendReply(): void {\r\n    if (!this.selectedChat) {\r\n      this.toastr.warning('الرجاء اختيار محادثة');\r\n      return;\r\n    }\r\n\r\n    if (!this.selectedChat.senderId) {\r\n      this.toastr.error('خطأ: معرف اللاعب غير صحيح');\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !this.selectedChat.messages ||\r\n      this.selectedChat.messages.length === 0\r\n    ) {\r\n      this.toastr.error('خطأ: لا توجد رسائل في هذه المحادثة');\r\n      return;\r\n    }\r\n\r\n    const replyContent =\r\n      this.replyMessages[this.selectedChat.messages[0].id]?.trim();\r\n    if (!replyContent) {\r\n      this.toastr.warning('الرجاء كتابة رد');\r\n      return;\r\n    }\r\n\r\n    this.friendlyMessageService\r\n      .sendAdminReply(this.selectedChat.senderId, replyContent)\r\n      .subscribe({\r\n        next: (response: FriendlyMessageResponse) => {\r\n          if (response.success) {\r\n            const playerName =\r\n              this.selectedChat!.senderFullName ||\r\n              `اللاعب ${this.selectedChat!.senderId}`;\r\n            this.toastr.success(\r\n              `تم إرسال الرد بنجاح إلى ${playerName}`,\r\n              'تم الإرسال'\r\n            );\r\n            this.replyMessages[this.selectedChat!.messages[0].id] = '';\r\n\r\n            const newMessage: FriendlyMessageDto = {\r\n              id: Math.random(),\r\n              senderId: this.selectedChat!.senderId,\r\n              senderFullName:\r\n                this.selectedChat!.senderFullName ||\r\n                `اللاعب ${this.selectedChat!.senderId}`,\r\n              senderPhoneNumber:\r\n                this.selectedChat!.senderPhoneNumber || 'غير متوفر',\r\n              content: replyContent,\r\n              isRead: true,\r\n              sentAt: new Date().toISOString(),\r\n              isFromAdmin: true,\r\n              messageType: 'admin_reply',\r\n            };\r\n\r\n            // تحديث الرسائل في المحادثة المحددة\r\n            this.selectedChat!.messages.push(newMessage);\r\n            this.selectedChat!.messages.sort(\r\n              (a, b) =>\r\n                new Date(a.sentAt).getTime() - new Date(b.sentAt).getTime()\r\n            );\r\n\r\n            // تحديث آخر رسالة في قائمة المحادثات\r\n            this.selectedChat!.lastMessage = replyContent;\r\n            this.selectedChat!.lastMessageDate = newMessage.sentAt;\r\n\r\n            // تحديث اسم اللاعب إذا كان غير موجود\r\n            if (!this.selectedChat!.senderFullName) {\r\n              this.selectedChat!.senderFullName = `اللاعب ${\r\n                this.selectedChat!.senderId\r\n              }`;\r\n            }\r\n\r\n            // إعادة ترتيب قائمة المحادثات حسب الأحدث\r\n            this.playerChats.sort(\r\n              (a, b) =>\r\n                new Date(b.lastMessageDate).getTime() -\r\n                new Date(a.lastMessageDate).getTime()\r\n            );\r\n\r\n            // تحديث المحادثة المحددة بعد إعادة الترتيب\r\n            this.selectedChat =\r\n              this.playerChats.find(\r\n                (chat) => chat.senderId === this.selectedPlayerId\r\n              ) || null;\r\n\r\n            this.cdr.detectChanges();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل إرسال الرد',\r\n              'خطأ في الإرسال'\r\n            );\r\n          }\r\n        },\r\n        error: (err: any) => {\r\n          this.toastr.error(\r\n            err.error?.message || err.message || 'حصل خطأ أثناء إرسال الرد',\r\n            'خطأ في الإرسال'\r\n          );\r\n        },\r\n      });\r\n  }\r\n\r\n  private scrollToBottom(): void {\r\n    if (this.messagesContainer) {\r\n      const container = this.messagesContainer.nativeElement;\r\n      container.scrollTop = container.scrollHeight;\r\n    }\r\n  }\r\n\r\n  trackByPlayerId(index: number, chat: PlayerChat): string {\r\n    return chat.senderId;\r\n  }\r\n\r\n  trackByMessageId(index: number, message: FriendlyMessageDto): number {\r\n    return message.id;\r\n  }\r\n}\r\n","<div class=\"md:container mx-auto\">\r\n  <!-- Teams Tournament Dashboard -->\r\n  <div class=\"p-6\">\r\n    <!-- Header -->\r\n    <div class=\"mb-6\">\r\n      <h2 class=\"text-2xl font-bold text-white mb-4\">\r\n        Teams Tournament Management\r\n      </h2>\r\n\r\n      <!-- Quick Actions -->\r\n      <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n        <button\r\n          class=\"bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 transition-all\"\r\n          (click)=\"openCreateTournamentModal()\"\r\n        >\r\n          <h3 class=\"text-lg font-bold\">Create Tournament</h3>\r\n          <p class=\"text-sm\">Create a new teams tournament</p>\r\n        </button>\r\n\r\n        <button\r\n          class=\"bg-purple-600 text-white p-4 rounded-lg hover:bg-purple-700 transition-all\"\r\n          (click)=\"showAddPlayerModal = true\"\r\n        >\r\n          <h3 class=\"text-lg font-bold\">Add Player</h3>\r\n          <p class=\"text-sm\">Add new player to the pool</p>\r\n        </button>\r\n\r\n        <div class=\"bg-gray-700 p-4 rounded-lg\">\r\n          <h3 class=\"text-lg font-bold text-white\">Statistics</h3>\r\n          <p class=\"text-sm text-gray-300\">\r\n            Tournaments: {{ tournaments.length }}\r\n          </p>\r\n          <p class=\"text-sm text-gray-300\">\r\n            Available Players: {{ availablePlayers.length }}\r\n          </p>\r\n        </div>\r\n\r\n        <div class=\"bg-blue-700 p-4 rounded-lg\">\r\n          <h3 class=\"text-lg font-bold text-white\">Active Tournament</h3>\r\n          <p class=\"text-sm text-gray-300\" *ngIf=\"activeTournament\">\r\n            {{ activeTournament.name }}\r\n          </p>\r\n          <p class=\"text-sm text-gray-300\" *ngIf=\"!activeTournament\">\r\n            No active tournament\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Loading Tournaments -->\r\n    <div *ngIf=\"isLoadingTournaments\" class=\"flex justify-center py-8\">\r\n      <div\r\n        class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"\r\n      ></div>\r\n    </div>\r\n\r\n    <!-- Tournaments List -->\r\n    <div *ngIf=\"!isLoadingTournaments\" class=\"space-y-4\">\r\n      <h3 class=\"text-xl font-semibold text-white\">All Tournaments</h3>\r\n\r\n      <div *ngIf=\"tournaments.length === 0\" class=\"text-center py-8\">\r\n        <p class=\"text-gray-400\">No tournaments created yet.</p>\r\n      </div>\r\n\r\n      <!-- Tournaments Grid -->\r\n      <div\r\n        *ngIf=\"tournaments.length > 0\"\r\n        class=\"grid grid-cols-1 lg:grid-cols-1 gap-6\"\r\n      >\r\n        <div\r\n          *ngFor=\"let tournament of tournaments\"\r\n          class=\"bg-black bg-opacity-50 rounded-lg p-6 border border-gray-700\"\r\n        >\r\n          <!-- Tournament Header -->\r\n          <div class=\"flex justify-between items-start mb-4\">\r\n            <div>\r\n              <h4 class=\"text-xl font-bold text-white mb-2\">\r\n                {{ tournament.name }}\r\n              </h4>\r\n              <div class=\"flex items-center space-x-4 text-sm\">\r\n                <span class=\"text-gray-300\"\r\n                  >Status:\r\n                  <span [class]=\"getStatusColor(tournament.status)\">{{\r\n                    tournament.status\r\n                  }}</span></span\r\n                >\r\n                <span class=\"text-gray-300\"\r\n                  >Teams: {{ tournament.teams.length }}/{{\r\n                    tournament.teamCount\r\n                  }}</span\r\n                >\r\n                <span class=\"text-gray-300\"\r\n                  >Players per team: {{ tournament.playersPerTeam }}</span\r\n                >\r\n                <span class=\"text-sm text-gray-300\"\r\n                  >Scoring System: {{ tournament.systemOfScoring }}</span\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Tournament Actions -->\r\n          <div class=\"flex flex-wrap gap-2 mb-4\">\r\n            <!-- Create Team Button -->\r\n            <button\r\n              *ngIf=\"\r\n                tournament.status === 'Created' &&\r\n                getRemainingTeams(tournament) > 0\r\n              \"\r\n              (click)=\"openCreateTeamModal(tournament)\"\r\n              class=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all\"\r\n            >\r\n              Create Team ({{ getRemainingTeams(tournament) }} remaining)\r\n            </button>\r\n\r\n            <!-- Start Tournament Button -->\r\n            <button\r\n              *ngIf=\"canStartTournament(tournament)\"\r\n              (click)=\"startTournament(tournament)\"\r\n              class=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm transition-all\"\r\n            >\r\n              Start Tournament\r\n            </button>\r\n\r\n            <!-- Finish Tournament Button -->\r\n            <button\r\n              *ngIf=\"canFinishTournament(tournament)\"\r\n              (click)=\"finishTournament(tournament)\"\r\n              class=\"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded text-sm transition-all\"\r\n            >\r\n              Finish Tournament\r\n            </button>\r\n\r\n            <!-- Delete Tournament Button -->\r\n            <button\r\n              *ngIf=\"canDeleteTournament(tournament)\"\r\n              (click)=\"deleteTournament(tournament)\"\r\n              class=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm transition-all\"\r\n            >\r\n              Delete Tournament\r\n            </button>\r\n          </div>\r\n\r\n          <!-- Teams List -->\r\n          <div *ngIf=\"tournament.teams.length > 0\" class=\"mb-4\">\r\n            <h5 class=\"text-lg font-semibold text-white mb-3\">Teams</h5>\r\n            <div class=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n              <div\r\n                *ngFor=\"let team of tournament.teams\"\r\n                class=\"bg-black bg-opacity-80 rounded p-3\"\r\n              >\r\n                <div class=\"font-medium text-white mb-2 text-center\">\r\n                  {{ team.teamName }}\r\n                </div>\r\n                <div class=\"text-sm text-gray-300 grid grid-cols-3 gap-2 mb-3\">\r\n                  <span\r\n                    *ngFor=\"let playerName of getTeamPlayersNames(team)\"\r\n                    class=\"px-2 py-2 text-center items-center justify-center flex bg-black bg-opacity-50 border border-gray-600 rounded-full text-white text-xs\"\r\n                  >\r\n                    {{ playerName }}\r\n                  </span>\r\n                </div>\r\n\r\n                <!-- Team Actions -->\r\n                <div class=\"flex justify-center\">\r\n                  <button\r\n                    *ngIf=\"tournament.status === 'Started'\"\r\n                    (click)=\"openReplacePlayerModal(team)\"\r\n                    class=\"bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 rounded text-xs transition-all\"\r\n                    title=\"Replace Player\"\r\n                  >\r\n                    🔄 Replace Player\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- No Teams Message -->\r\n          <div *ngIf=\"tournament.teams.length === 0\" class=\"text-center py-4\">\r\n            <p class=\"text-gray-400\">No teams created yet.</p>\r\n            <p class=\"text-sm text-gray-500\">\r\n              Create teams to start the tournament\r\n            </p>\r\n          </div>\r\n\r\n          <!-- Tournament Progress -->\r\n          <div class=\"mt-4 pt-4 border-t border-gray-700\">\r\n            <div class=\"flex justify-between text-sm text-gray-400\">\r\n              <span>Progress</span>\r\n              <span\r\n                >{{\r\n                  (tournament.teams.length / tournament.teamCount) * 100\r\n                    | number : \"1.0-0\"\r\n                }}%</span\r\n              >\r\n            </div>\r\n            <div class=\"w-full bg-gray-700 rounded-full h-2 mt-1\">\r\n              <div\r\n                class=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                [style.width.%]=\"\r\n                  (tournament.teams.length / tournament.teamCount) * 100\r\n                \"\r\n              ></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Tournament Players Section -->\r\n    <div class=\"mt-8\">\r\n      <h3 class=\"text-xl font-semibold text-white mb-4\">Tournament Players</h3>\r\n\r\n      <!-- Search Bar -->\r\n      <div class=\"mb-4\">\r\n        <div class=\"relative\">\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"playerSearchTerm\"\r\n            (input)=\"filterPlayers()\"\r\n            placeholder=\"Search players by name...\"\r\n            class=\"w-full px-4 py-2 pl-10 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n          />\r\n          <div\r\n            class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\"\r\n          >\r\n            <svg\r\n              class=\"h-5 w-5 text-gray-400\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                stroke-linecap=\"round\"\r\n                stroke-linejoin=\"round\"\r\n                stroke-width=\"2\"\r\n                d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\r\n              ></path>\r\n            </svg>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div *ngIf=\"isLoadingPlayers\" class=\"flex justify-center py-8\">\r\n        <div\r\n          class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"\r\n        ></div>\r\n      </div>\r\n\r\n      <!-- Players Grid -->\r\n      <div\r\n        *ngIf=\"!isLoadingPlayers && filteredPlayers.length > 0\"\r\n        class=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\"\r\n      >\r\n        <div\r\n          *ngFor=\"let player of filteredPlayers\"\r\n          class=\"bg-black bg-opacity-50 p-4 rounded-lg cursor-pointer hover:bg-gray-400 transition-all border-2 border-gray-600\"\r\n          (click)=\"selectPlayer(player)\"\r\n        >\r\n          <div class=\"text-center\">\r\n            <div class=\"text-base font-bold text-white\">\r\n              {{ player.fullName }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        *ngIf=\"!isLoadingPlayers && filteredPlayers.length === 0\"\r\n        class=\"text-center py-8\"\r\n      >\r\n        <p\r\n          class=\"text-gray-400\"\r\n          *ngIf=\"playerSearchTerm && playerSearchTerm.trim() !== ''\"\r\n        >\r\n          No players found matching \"{{ playerSearchTerm }}\"\r\n        </p>\r\n        <p\r\n          class=\"text-gray-400\"\r\n          *ngIf=\"!playerSearchTerm || playerSearchTerm.trim() === ''\"\r\n        >\r\n          No players available. Add players first.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Create Tournament Modal -->\r\n  <div\r\n    *ngIf=\"showCreateTournamentModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    (click)=\"closeCreateTournamentModal()\"\r\n  >\r\n    <div\r\n      class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4 relative\"\r\n      (click)=\"$event.stopPropagation()\"\r\n    >\r\n      <!-- Fixed Close Button -->\r\n      <button\r\n        (click)=\"closeCreateTournamentModal()\"\r\n        class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n      >\r\n        Exit ×\r\n      </button>\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Create New Tournament</h2>\r\n\r\n      <div class=\"space-y-4\">\r\n        <div>\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Tournament Name</label\r\n          >\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"createTournamentForm.name\"\r\n            placeholder=\"Enter tournament name\"\r\n            class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded placeholder-gray-400\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >Scoring System</label\r\n          >\r\n          <select\r\n            [(ngModel)]=\"createTournamentForm.systemOfScoring\"\r\n            class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded\"\r\n          >\r\n            <option value=\"Classic\">Classic (Win/Draw/Loss)</option>\r\n            <option value=\"Points\">Points System</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"grid grid-cols-2 gap-4\">\r\n          <div>\r\n            <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n              >Teams Count</label\r\n            >\r\n            <input\r\n              type=\"number\"\r\n              [(ngModel)]=\"createTournamentForm.teamCount\"\r\n              min=\"2\"\r\n              max=\"16\"\r\n              class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n              >Players per Team</label\r\n            >\r\n            <input\r\n              type=\"number\"\r\n              [(ngModel)]=\"createTournamentForm.playersPerTeam\"\r\n              min=\"1\"\r\n              max=\"10\"\r\n              class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"flex justify-end space-x-4 mt-6\">\r\n        <button\r\n          (click)=\"closeCreateTournamentModal()\"\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          (click)=\"createTournament()\"\r\n          [disabled]=\"isCreatingTournament || !createTournamentForm.name.trim()\"\r\n          class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition disabled:opacity-50\"\r\n        >\r\n          {{ isCreatingTournament ? \"Creating...\" : \"Create Tournament\" }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Create Team Modal -->\r\n  <div\r\n    *ngIf=\"showCreateTeamModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    (click)=\"closeCreateTeamModal()\"\r\n  >\r\n    <div\r\n      class=\"bg-gray-800 p-6 rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto relative\"\r\n      (click)=\"$event.stopPropagation()\"\r\n    >\r\n      <!-- Fixed Close Button -->\r\n      <button\r\n        (click)=\"closeCreateTeamModal()\"\r\n        class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n      >\r\n        Exit ×\r\n      </button>\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">\r\n        Create Team for {{ activeTournament?.name }}\r\n      </h2>\r\n\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n          >Team Name</label\r\n        >\r\n        <input\r\n          type=\"text\"\r\n          [(ngModel)]=\"createTeamForm.teamName\"\r\n          placeholder=\"Enter team name\"\r\n          class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded placeholder-gray-400\"\r\n        />\r\n      </div>\r\n\r\n      <div class=\"mb-4\">\r\n        <label class=\"block text-sm font-medium mb-2 text-gray-300\">\r\n          Select Players ({{ createTeamForm.playerIds.length }}/{{\r\n            activeTournament?.playersPerTeam\r\n          }})\r\n        </label>\r\n\r\n        <!-- Loading Players -->\r\n        <div *ngIf=\"isLoadingPlayers\" class=\"flex justify-center py-4\">\r\n          <div\r\n            class=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"\r\n          ></div>\r\n        </div>\r\n\r\n        <!-- No Players Message -->\r\n        <div\r\n          *ngIf=\"!isLoadingPlayers && availablePlayers.length === 0\"\r\n          class=\"text-center py-4 text-gray-400\"\r\n        >\r\n          No players available. Add players first.\r\n        </div>\r\n\r\n        <!-- Players Grid -->\r\n        <div\r\n          *ngIf=\"!isLoadingPlayers && availablePlayers.length > 0\"\r\n          class=\"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto\"\r\n        >\r\n          <div\r\n            *ngFor=\"let player of availablePlayers\"\r\n            (click)=\"togglePlayerSelection(player.playerId)\"\r\n            class=\"p-3 rounded border cursor-pointer transition-all\"\r\n            [class.bg-blue-600]=\"isPlayerSelected(player.playerId)\"\r\n            [class.border-blue-500]=\"isPlayerSelected(player.playerId)\"\r\n            [class.bg-gray-700]=\"!isPlayerSelected(player.playerId)\"\r\n            [class.border-gray-600]=\"!isPlayerSelected(player.playerId)\"\r\n          >\r\n            <div class=\"text-white font-medium\">{{ player.fullName }}</div>\r\n            <div class=\"text-xs text-gray-300\">\r\n              Tournaments: {{ player.multiParticipations }} | Titles:\r\n              {{ player.multiTitlesWon }}\r\n            </div>\r\n            <!-- Selection Indicator -->\r\n            <div\r\n              *ngIf=\"isPlayerSelected(player.playerId)\"\r\n              class=\"text-blue-200 text-xs mt-1\"\r\n            >\r\n              ✓ Selected\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"flex justify-end space-x-4 mt-6\">\r\n        <button\r\n          (click)=\"closeCreateTeamModal()\"\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          (click)=\"createTeam()\"\r\n          [disabled]=\"\r\n            isCreatingTeam ||\r\n            !createTeamForm.teamName.trim() ||\r\n            createTeamForm.playerIds.length !== activeTournament?.playersPerTeam\r\n          \"\r\n          class=\"bg-blue-600 px-4 py-2 text-white rounded hover:bg-blue-700 transition disabled:opacity-50\"\r\n        >\r\n          {{ isCreatingTeam ? \"Creating...\" : \"Create Team\" }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Add Player Modal -->\r\n  <div\r\n    *ngIf=\"showAddPlayerModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    (click)=\"showAddPlayerModal = false\"\r\n  >\r\n    <div\r\n      class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4 relative\"\r\n      (click)=\"$event.stopPropagation()\"\r\n    >\r\n      <!-- Fixed Close Button -->\r\n      <button\r\n        (click)=\"showAddPlayerModal = false\"\r\n        class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n      >\r\n        Exit ×\r\n      </button>\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Add New Player</h2>\r\n\r\n      <input\r\n        type=\"text\"\r\n        [(ngModel)]=\"newPlayerName\"\r\n        placeholder=\"Enter player name\"\r\n        class=\"border border-gray-600 p-2 w-full bg-gray-700 text-white rounded placeholder-gray-400\"\r\n      />\r\n\r\n      <div class=\"flex justify-end space-x-4 mt-6\">\r\n        <button\r\n          (click)=\"showAddPlayerModal = false\"\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          (click)=\"addNewPlayer()\"\r\n          [disabled]=\"isAddingPlayer || !newPlayerName.trim()\"\r\n          class=\"bg-purple-600 px-4 py-2 text-white rounded hover:bg-purple-700 transition disabled:opacity-50\"\r\n        >\r\n          {{ isAddingPlayer ? \"Adding...\" : \"Add Player\" }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Record Match Result Modal -->\r\n  <div\r\n    *ngIf=\"showRecordResultModal\"\r\n    class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n    (click)=\"closeRecordResultModal()\"\r\n  >\r\n    <div\r\n      class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4 relative\"\r\n      (click)=\"$event.stopPropagation()\"\r\n    >\r\n      <!-- Fixed Close Button -->\r\n      <button\r\n        (click)=\"closeRecordResultModal()\"\r\n        class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n      >\r\n        Exit ×\r\n      </button>\r\n      <h2 class=\"text-lg font-bold mb-4 text-white\">Record Match Result</h2>\r\n\r\n      <div class=\"grid grid-cols-2 gap-4 mb-4\">\r\n        <div>\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >{{ getPlayerName(selectedPlayer1Id) }}\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"recordingScore1\"\r\n            placeholder=\"Enter score\"\r\n            class=\"w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium mb-1 text-gray-300\"\r\n            >{{ getPlayerName(selectedPlayer2Id) }}\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            [(ngModel)]=\"recordingScore2\"\r\n            placeholder=\"Enter score\"\r\n            class=\"w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        *ngIf=\"activeTournament?.systemOfScoring === 'Classic'\"\r\n        class=\"mb-4 text-xs text-gray-400\"\r\n      >\r\n        Classic System: Winner will be determined automatically based on scores\r\n      </div>\r\n\r\n      <div class=\"flex justify-end space-x-4\">\r\n        <button\r\n          (click)=\"closeRecordResultModal()\"\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          (click)=\"recordMatchResult()\"\r\n          [disabled]=\"\r\n            isRecordingResult ||\r\n            !recordingScore1.trim() ||\r\n            !recordingScore2.trim()\r\n          \"\r\n          class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition disabled:opacity-50\"\r\n        >\r\n          {{ isRecordingResult ? \"Recording...\" : \"Record Result\" }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Player Matches Modal -->\r\n  <div\r\n    *ngIf=\"showPlayerMatchesModal\"\r\n    class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\r\n    (click)=\"closePlayerMatchesModal()\"\r\n  >\r\n    <div\r\n      class=\"bg-black bg-opacity-50 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden relative\"\r\n      (click)=\"$event.stopPropagation()\"\r\n    >\r\n      <!-- Fixed Close Button -->\r\n      <button\r\n        (click)=\"closePlayerMatchesModal()\"\r\n        class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n      >\r\n        Exit ×\r\n      </button>\r\n\r\n      <!-- Modal Content with Scroll -->\r\n      <div class=\"p-6 overflow-y-auto\" style=\"max-height: calc(90vh - 2rem)\">\r\n        <!-- Modal Header -->\r\n        <div class=\"flex justify-between items-center mb-6\">\r\n          <h3 class=\"text-2xl font-bold text-white\">\r\n            Matches for {{ selectedPlayer?.fullName }}\r\n          </h3>\r\n        </div>\r\n\r\n        <!-- Search Bar for Opponents -->\r\n        <div class=\"mb-4\">\r\n          <div class=\"relative\">\r\n            <input\r\n              type=\"text\"\r\n              [(ngModel)]=\"opponentSearchTerm\"\r\n              (input)=\"filterPlayerMatches()\"\r\n              placeholder=\"Search opponents by name...\"\r\n              class=\"w-full px-4 py-2 pl-10 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n            />\r\n            <div\r\n              class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\"\r\n            >\r\n              <svg\r\n                class=\"h-5 w-5 text-gray-400\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  stroke-linecap=\"round\"\r\n                  stroke-linejoin=\"round\"\r\n                  stroke-width=\"2\"\r\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\r\n                ></path>\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Loading State -->\r\n        <div *ngIf=\"isLoadingMatches\" class=\"flex justify-center py-8\">\r\n          <div\r\n            class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"\r\n          ></div>\r\n        </div>\r\n\r\n        <!-- Matches List -->\r\n        <div\r\n          *ngIf=\"!isLoadingMatches && filteredPlayerMatches.length > 0\"\r\n          class=\"space-y-4\"\r\n        >\r\n          <div\r\n            *ngFor=\"let match of filteredPlayerMatches\"\r\n            class=\"bg-black bg-opacity-50 rounded-lg p-4\"\r\n          >\r\n            <div class=\"flex justify-between items-center\">\r\n              <div class=\"flex-1\">\r\n                <span class=\"text-white font-semibold\">{{\r\n                  match.player1Name\r\n                }}</span>\r\n              </div>\r\n\r\n              <div class=\"px-4 text-center\">\r\n                <div *ngIf=\"match.isCompleted\" class=\"font-bold text-lg\">\r\n                  <span\r\n                    [class]=\"\r\n                      (match.score1 || 0) > (match.score2 || 0)\r\n                        ? 'text-green-400'\r\n                        : (match.score1 || 0) < (match.score2 || 0)\r\n                        ? 'text-red-400'\r\n                        : 'text-yellow-400'\r\n                    \"\r\n                  >\r\n                    {{ match.score1 || 0 }}\r\n                  </span>\r\n                  <span class=\"text-white mx-2\">-</span>\r\n                  <span\r\n                    [class]=\"\r\n                      (match.score2 || 0) > (match.score1 || 0)\r\n                        ? 'text-green-400'\r\n                        : (match.score2 || 0) < (match.score1 || 0)\r\n                        ? 'text-red-400'\r\n                        : 'text-yellow-400'\r\n                    \"\r\n                  >\r\n                    {{ match.score2 || 0 }}\r\n                  </span>\r\n                </div>\r\n                <div *ngIf=\"!match.isCompleted\" class=\"text-gray-400 text-sm\">\r\n                  Pending\r\n                  <button\r\n                    *ngIf=\"activeTournament?.status === 'Started'\"\r\n                    (click)=\"openRecordResultModal(match)\"\r\n                    class=\"ml-2 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs transition-all\"\r\n                  >\r\n                    Record\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Undo Button for completed matches -->\r\n              <div\r\n                *ngIf=\"\r\n                  match.isCompleted && activeTournament?.status === 'Started'\r\n                \"\r\n                class=\"ml-2\"\r\n              >\r\n                <button\r\n                  (click)=\"undoMatchResult(match)\"\r\n                  class=\"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-all\"\r\n                >\r\n                  Undo\r\n                </button>\r\n              </div>\r\n              <div class=\"flex-1 text-right\">\r\n                <span class=\"text-white font-semibold\">{{\r\n                  match.player2Name\r\n                }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- No Matches Message -->\r\n        <div\r\n          *ngIf=\"!isLoadingMatches && filteredPlayerMatches.length === 0\"\r\n          class=\"text-center py-8\"\r\n        >\r\n          <p\r\n            class=\"text-gray-400\"\r\n            *ngIf=\"opponentSearchTerm && opponentSearchTerm.trim() !== ''\"\r\n          >\r\n            No opponents found matching \"{{ opponentSearchTerm }}\"\r\n          </p>\r\n          <p\r\n            class=\"text-gray-400\"\r\n            *ngIf=\"!opponentSearchTerm || opponentSearchTerm.trim() === ''\"\r\n          >\r\n            No matches found for this player.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Confirmation Modals -->\r\n\r\n<!-- Start Tournament Confirmation Modal -->\r\n<div\r\n  *ngIf=\"showConfirmStartTournamentModal\"\r\n  class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n>\r\n  <div class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4\">\r\n    <div class=\"text-center mb-6\">\r\n      <div\r\n        class=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\"\r\n      >\r\n        <svg\r\n          class=\"h-6 w-6 text-green-600\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M5 13l4 4L19 7\"\r\n          />\r\n        </svg>\r\n      </div>\r\n      <h3 class=\"text-lg font-medium text-white mb-2\">تأكيد بدء البطولة</h3>\r\n      <p class=\"text-sm text-gray-300\">\r\n        هل أنت متأكد من بدء البطولة \"{{ tournamentToConfirm?.name }}\"؟\r\n      </p>\r\n    </div>\r\n\r\n    <div class=\"flex justify-end space-x-4\">\r\n      <button\r\n        (click)=\"closeConfirmStartTournamentModal()\"\r\n        class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n      >\r\n        إلغاء\r\n      </button>\r\n      <button\r\n        (click)=\"confirmStartTournament()\"\r\n        class=\"bg-green-600 px-4 py-2 text-white rounded hover:bg-green-700 transition\"\r\n      >\r\n        بدء البطولة\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Finish Tournament Confirmation Modal -->\r\n<div\r\n  *ngIf=\"showConfirmFinishTournamentModal\"\r\n  class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n>\r\n  <div class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4\">\r\n    <div class=\"text-center mb-6\">\r\n      <div\r\n        class=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 mb-4\"\r\n      >\r\n        <svg\r\n          class=\"h-6 w-6 text-yellow-600\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      </div>\r\n      <h3 class=\"text-lg font-medium text-white mb-2\">تأكيد إنهاء البطولة</h3>\r\n      <p class=\"text-sm text-gray-300\">\r\n        هل أنت متأكد من إنهاء البطولة \"{{ tournamentToConfirm?.name }}\"؟\r\n      </p>\r\n    </div>\r\n\r\n    <div class=\"flex justify-end space-x-4\">\r\n      <button\r\n        (click)=\"closeConfirmFinishTournamentModal()\"\r\n        class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n      >\r\n        إلغاء\r\n      </button>\r\n      <button\r\n        (click)=\"confirmFinishTournament()\"\r\n        class=\"bg-yellow-600 px-4 py-2 text-white rounded hover:bg-yellow-700 transition\"\r\n      >\r\n        إنهاء البطولة\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Delete Tournament Confirmation Modal -->\r\n<div\r\n  *ngIf=\"showConfirmDeleteTournamentModal\"\r\n  class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n>\r\n  <div class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4\">\r\n    <div class=\"text-center mb-6\">\r\n      <div\r\n        class=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4\"\r\n      >\r\n        <svg\r\n          class=\"h-6 w-6 text-red-600\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"\r\n          />\r\n        </svg>\r\n      </div>\r\n      <h3 class=\"text-lg font-medium text-white mb-2\">تأكيد حذف البطولة</h3>\r\n      <p class=\"text-sm text-gray-300 mb-4\">\r\n        هل أنت متأكد من حذف البطولة \"{{ tournamentToConfirm?.name }}\"؟\r\n      </p>\r\n      <p class=\"text-xs text-red-400\">\r\n        ⚠️ سيتم حذف كل البيانات المرتبطة بها نهائياً\r\n      </p>\r\n    </div>\r\n\r\n    <div class=\"flex justify-end space-x-4\">\r\n      <button\r\n        (click)=\"closeConfirmDeleteTournamentModal()\"\r\n        class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n      >\r\n        إلغاء\r\n      </button>\r\n      <button\r\n        (click)=\"confirmDeleteTournament()\"\r\n        class=\"bg-red-600 px-4 py-2 text-white rounded hover:bg-red-700 transition\"\r\n      >\r\n        حذف البطولة\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Undo Match Result Confirmation Modal -->\r\n<div\r\n  *ngIf=\"showConfirmUndoMatchModal\"\r\n  class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n>\r\n  <div class=\"bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4\">\r\n    <div class=\"text-center mb-6\">\r\n      <div\r\n        class=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-orange-100 mb-4\"\r\n      >\r\n        <svg\r\n          class=\"h-6 w-6 text-orange-600\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n          />\r\n        </svg>\r\n      </div>\r\n      <h3 class=\"text-lg font-medium text-white mb-2\">تأكيد إلغاء النتيجة</h3>\r\n      <p class=\"text-sm text-gray-300 mb-4\">\r\n        هل أنت متأكد من إلغاء نتيجة المباراة؟\r\n      </p>\r\n      <div class=\"text-xs text-gray-400 bg-gray-700 p-3 rounded\">\r\n        <p>{{ matchToUndo?.player1Name }} vs {{ matchToUndo?.player2Name }}</p>\r\n        <p>النتيجة: {{ matchToUndo?.score1 }} - {{ matchToUndo?.score2 }}</p>\r\n      </div>\r\n\r\n      <div class=\"flex justify-end space-x-4\">\r\n        <button\r\n          (click)=\"closeConfirmUndoMatchModal()\"\r\n          class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n        >\r\n          إلغاء\r\n        </button>\r\n        <button\r\n          (click)=\"confirmUndoMatchResult()\"\r\n          class=\"bg-orange-600 px-4 py-2 text-white rounded hover:bg-orange-700 transition\"\r\n        >\r\n          إلغاء النتيجة\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Replace Player Modal -->\r\n<div\r\n  *ngIf=\"showReplacePlayerModal\"\r\n  class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50\"\r\n  (click)=\"closeReplacePlayerModal()\"\r\n>\r\n  <div\r\n    class=\"bg-gray-800 p-6 rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto relative\"\r\n    (click)=\"$event.stopPropagation()\"\r\n  >\r\n    <!-- Fixed Close Button -->\r\n    <button\r\n      (click)=\"closeReplacePlayerModal()\"\r\n      class=\"absolute top-4 right-5 z-10 p-2 text-gray-100 hover:text-white text-lg font-bold transition-colors bg-gray-800 bg-opacity-70 rounded-full h-8 flex items-center justify-center\"\r\n    >\r\n      Exit ×\r\n    </button>\r\n\r\n    <h2 class=\"text-lg font-bold mb-4 text-white\">\r\n      Replace Player in {{ selectedTeamForReplacement?.teamName }}\r\n    </h2>\r\n\r\n    <div class=\"mb-4\">\r\n      <label class=\"block text-sm font-medium mb-2 text-gray-300\">\r\n        Select Player to Replace\r\n      </label>\r\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-2 mb-4\">\r\n        <div\r\n          *ngFor=\"let player of selectedTeamForReplacement?.players || []\"\r\n          (click)=\"selectPlayerToReplace(player.playerId)\"\r\n          class=\"p-3 rounded border cursor-pointer transition-all\"\r\n          [class.bg-red-600]=\"\r\n            replacePlayerForm.replacedPlayerId === player.playerId\r\n          \"\r\n          [class.border-red-500]=\"\r\n            replacePlayerForm.replacedPlayerId === player.playerId\r\n          \"\r\n          [class.bg-gray-700]=\"\r\n            replacePlayerForm.replacedPlayerId !== player.playerId\r\n          \"\r\n          [class.border-gray-600]=\"\r\n            replacePlayerForm.replacedPlayerId !== player.playerId\r\n          \"\r\n        >\r\n          <div class=\"text-white font-medium\">{{ player.fullName }}</div>\r\n          <div class=\"text-xs text-gray-300\">\r\n            Tournaments: {{ player.multiParticipations }} | Titles:\r\n            {{ player.multiTitlesWon }}\r\n          </div>\r\n          <!-- Selection Indicator -->\r\n          <div\r\n            *ngIf=\"replacePlayerForm.replacedPlayerId === player.playerId\"\r\n            class=\"text-red-200 text-xs mt-1\"\r\n          >\r\n            ✓ Selected for Replacement\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"mb-4\">\r\n      <label class=\"block text-sm font-medium mb-2 text-gray-300\">\r\n        Select New Player\r\n      </label>\r\n\r\n      <!-- Loading Players -->\r\n      <div *ngIf=\"isLoadingPlayers\" class=\"flex justify-center py-4\">\r\n        <div\r\n          class=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"\r\n        ></div>\r\n      </div>\r\n\r\n      <!-- No Players Message -->\r\n      <div\r\n        *ngIf=\"!isLoadingPlayers && availablePlayersForReplacement.length === 0\"\r\n        class=\"text-center py-4 text-gray-400\"\r\n      >\r\n        No available players for replacement.\r\n      </div>\r\n\r\n      <!-- Available Players Grid -->\r\n      <div\r\n        *ngIf=\"!isLoadingPlayers && availablePlayersForReplacement.length > 0\"\r\n        class=\"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto\"\r\n      >\r\n        <div\r\n          *ngFor=\"let player of availablePlayersForReplacement\"\r\n          (click)=\"selectNewPlayer(player.playerId)\"\r\n          class=\"p-3 rounded border cursor-pointer transition-all\"\r\n          [class.bg-blue-600]=\"\r\n            replacePlayerForm.newPlayerId === player.playerId\r\n          \"\r\n          [class.border-blue-500]=\"\r\n            replacePlayerForm.newPlayerId === player.playerId\r\n          \"\r\n          [class.bg-gray-700]=\"\r\n            replacePlayerForm.newPlayerId !== player.playerId\r\n          \"\r\n          [class.border-gray-600]=\"\r\n            replacePlayerForm.newPlayerId !== player.playerId\r\n          \"\r\n        >\r\n          <div class=\"text-white font-medium\">{{ player.fullName }}</div>\r\n          <div class=\"text-xs text-gray-300\">\r\n            Tournaments: {{ player.multiParticipations }} | Titles:\r\n            {{ player.multiTitlesWon }}\r\n          </div>\r\n          <!-- Selection Indicator -->\r\n          <div\r\n            *ngIf=\"replacePlayerForm.newPlayerId === player.playerId\"\r\n            class=\"text-blue-200 text-xs mt-1\"\r\n          >\r\n            ✓ Selected as Replacement\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"flex justify-end space-x-4 mt-6\">\r\n      <button\r\n        (click)=\"closeReplacePlayerModal()\"\r\n        class=\"bg-gray-600 px-4 py-2 text-white rounded hover:bg-gray-700 transition\"\r\n      >\r\n        Cancel\r\n      </button>\r\n      <button\r\n        (click)=\"replacePlayer()\"\r\n        [disabled]=\"\r\n          isReplacingPlayer ||\r\n          !replacePlayerForm.replacedPlayerId ||\r\n          !replacePlayerForm.newPlayerId\r\n        \"\r\n        class=\"bg-orange-600 px-4 py-2 text-white rounded hover:bg-orange-700 transition disabled:opacity-50\"\r\n      >\r\n        {{ isReplacingPlayer ? \"Replacing...\" : \"Replace Player\" }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { PlayersComponent } from './players/players.component';\r\nimport { InboxComponent } from './inbox/inbox.component';\r\nimport { FriendliesComponent } from './friendlies/friendlies.component';\r\nimport { FriendlyInboxComponent } from './friendlies/friendly-inbox/friendly-inbox.component';\r\nimport { TeamsDashboardComponent } from './teams-dashboard/teams-dashboard.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: PlayersComponent, data: { title: 'Players' } },\r\n  {\r\n    path: 'players',\r\n    component: PlayersComponent,\r\n    data: { title: 'Admin Dashboard' },\r\n  },\r\n  { path: 'inbox', component: InboxComponent, data: { title: 'Inbox' } },\r\n  {\r\n    path: 'friendlies',\r\n    component: FriendliesComponent,\r\n    data: { title: 'Friendlies' },\r\n  },\r\n  {\r\n    path: 'friendly-inbox',\r\n    component: FriendlyInboxComponent,\r\n    data: { title: 'Friendly Inbox' },\r\n  },\r\n  {\r\n    path: 'teams-dashboard',\r\n    component: TeamsDashboardComponent,\r\n    data: { title: 'Teams Dashboard' },\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class AdminRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport {\r\n  MultiTournamentService,\r\n  CreateTournamentDto,\r\n  TeamCreateDto,\r\n  MultiTournamentDto,\r\n  PlayerDetail,\r\n  AddPlayerDto,\r\n  TeamMatchesDto,\r\n  MatchDetail,\r\n  TeamDetail,\r\n  ApiResponse,\r\n} from '../../core/services/multi-tournament.service';\r\n\r\n@Component({\r\n  selector: 'app-teams-dashboard',\r\n  templateUrl: './teams-dashboard.component.html',\r\n  styleUrls: ['./teams-dashboard.component.css'],\r\n})\r\nexport class TeamsDashboardComponent implements OnInit {\r\n  // Data\r\n  tournaments: MultiTournamentDto[] = [];\r\n  activeTournament: MultiTournamentDto | null = null;\r\n  availablePlayers: PlayerDetail[] = [];\r\n  availablePlayersForReplacement: PlayerDetail[] = [];\r\n  filteredPlayers: PlayerDetail[] = [];\r\n  tournamentMatches: TeamMatchesDto[] = [];\r\n  filteredPlayerMatches: MatchDetail[] = [];\r\n  selectedPlayer: PlayerDetail | null = null;\r\n\r\n  // Modals\r\n  showCreateTournamentModal = false;\r\n  showCreateTeamModal = false;\r\n  showAddPlayerModal = false;\r\n  showRecordResultModal = false;\r\n  showPlayerMatchesModal = false;\r\n  showReplacePlayerModal = false;\r\n\r\n  // Confirmation Modals\r\n  showConfirmStartTournamentModal = false;\r\n  showConfirmFinishTournamentModal = false;\r\n  showConfirmDeleteTournamentModal = false;\r\n  showConfirmUndoMatchModal = false;\r\n\r\n  // Confirmation Data\r\n  tournamentToConfirm: MultiTournamentDto | null = null;\r\n  matchToUndo: MatchDetail | null = null;\r\n  selectedTeamForReplacement: TeamDetail | null = null;\r\n\r\n  // Forms\r\n  createTournamentForm: CreateTournamentDto = {\r\n    name: '',\r\n    systemOfScoring: 'Classic',\r\n    teamCount: 4,\r\n    playersPerTeam: 3,\r\n  };\r\n\r\n  createTeamForm: TeamCreateDto = {\r\n    teamName: '',\r\n    playerIds: [],\r\n  };\r\n\r\n  replacePlayerForm = {\r\n    replacedPlayerId: 0,\r\n    newPlayerId: 0,\r\n  };\r\n\r\n  newPlayerName = '';\r\n  playerSearchTerm = '';\r\n  opponentSearchTerm = '';\r\n\r\n  // Match Recording\r\n  selectedMatchId: number | null = null;\r\n  selectedPlayer1Id: number | null = null;\r\n  selectedPlayer2Id: number | null = null;\r\n  recordingScore1: string = '';\r\n  recordingScore2: string = '';\r\n\r\n  // Loading States\r\n  isLoadingTournaments = false;\r\n  isLoadingPlayers = false;\r\n  isLoadingMatches = false;\r\n  isCreatingTournament = false;\r\n  isCreatingTeam = false;\r\n  isAddingPlayer = false;\r\n  isRecordingResult = false;\r\n  isReplacingPlayer = false;\r\n\r\n  constructor(\r\n    private multiTournamentService: MultiTournamentService,\r\n    private toastr: ToastrService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadTournaments();\r\n    this.loadAvailablePlayers();\r\n  }\r\n\r\n  // Tournament Management\r\n  loadTournaments(): void {\r\n    this.isLoadingTournaments = true;\r\n\r\n    this.multiTournamentService.getAllTournaments().subscribe({\r\n      next: (response: ApiResponse<MultiTournamentDto[]>) => {\r\n        if (response.success && response.data) {\r\n          this.tournaments = response.data;\r\n          this.activeTournament =\r\n            this.tournaments.find((t) => t.isActive) || null;\r\n\r\n          if (this.activeTournament) {\r\n            this.loadTournamentMatches();\r\n          }\r\n        }\r\n        this.isLoadingTournaments = false;\r\n      },\r\n      error: (error) => {\r\n        console.error('Error loading tournaments:', error);\r\n        this.toastr.error('خطأ في تحميل البطولات', 'خطأ');\r\n        this.isLoadingTournaments = false;\r\n      },\r\n    });\r\n  }\r\n\r\n  createTournament(): void {\r\n    if (!this.createTournamentForm.name.trim()) {\r\n      this.toastr.warning('يرجى إدخال اسم البطولة', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    this.isCreatingTournament = true;\r\n\r\n    this.multiTournamentService\r\n      .createTournament(this.createTournamentForm)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم إنشاء البطولة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.closeCreateTournamentModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل في إنشاء البطولة',\r\n              'خطأ'\r\n            );\r\n          }\r\n          this.isCreatingTournament = false;\r\n        },\r\n        error: (error) => {\r\n          console.error('Error creating tournament:', error);\r\n          this.toastr.error('خطأ في إنشاء البطولة', 'خطأ');\r\n          this.isCreatingTournament = false;\r\n        },\r\n      });\r\n  }\r\n\r\n  // Modal Controls\r\n  openCreateTournamentModal(): void {\r\n    this.createTournamentForm = {\r\n      name: '',\r\n      systemOfScoring: 'Classic',\r\n      teamCount: 4,\r\n      playersPerTeam: 3,\r\n    };\r\n    this.showCreateTournamentModal = true;\r\n  }\r\n\r\n  closeCreateTournamentModal(): void {\r\n    this.showCreateTournamentModal = false;\r\n  }\r\n\r\n  // Helper Methods\r\n  getRemainingTeams(tournament: MultiTournamentDto): number {\r\n    return tournament.teamCount - tournament.teams.length;\r\n  }\r\n\r\n  canStartTournament(tournament: MultiTournamentDto): boolean {\r\n    return (\r\n      tournament.status === 'Created' &&\r\n      tournament.teams.length === tournament.teamCount\r\n    );\r\n  }\r\n\r\n  getStatusColor(status: string): string {\r\n    switch (status) {\r\n      case 'Created':\r\n        return 'text-yellow-400';\r\n      case 'Started':\r\n        return 'text-green-400';\r\n      case 'Finished':\r\n        return 'text-blue-400';\r\n      default:\r\n        return 'text-gray-400';\r\n    }\r\n  }\r\n\r\n  // Player Management\r\n  loadAvailablePlayers(): void {\r\n    this.isLoadingPlayers = true;\r\n\r\n    this.multiTournamentService.getAllPlayers().subscribe({\r\n      next: (response: ApiResponse<PlayerDetail[]>) => {\r\n        if (response.success && response.data) {\r\n          this.availablePlayers = response.data.filter((p) => p.isActive);\r\n          this.filteredPlayers = [...this.availablePlayers];\r\n        }\r\n        this.isLoadingPlayers = false;\r\n      },\r\n      error: (error) => {\r\n        console.error('Error loading players:', error);\r\n        this.toastr.error('خطأ في تحميل اللاعبين', 'خطأ');\r\n        this.isLoadingPlayers = false;\r\n      },\r\n    });\r\n  }\r\n\r\n  // Match Management\r\n  loadTournamentMatches(): void {\r\n    if (!this.activeTournament) return;\r\n\r\n    this.isLoadingMatches = true;\r\n\r\n    this.multiTournamentService.getActiveTournamentMatches().subscribe({\r\n      next: (response: ApiResponse<TeamMatchesDto[]>) => {\r\n        if (response.success && response.data) {\r\n          this.tournamentMatches = response.data;\r\n          // Initialize filtered player matches if a player is selected\r\n          if (this.selectedPlayer) {\r\n            this.filteredPlayerMatches = this.getPlayerMatches(\r\n              this.selectedPlayer.playerId || 0\r\n            );\r\n          }\r\n        }\r\n        this.isLoadingMatches = false;\r\n      },\r\n      error: (error) => {\r\n        console.error('Error loading tournament matches:', error);\r\n        this.toastr.error('خطأ في تحميل المباريات', 'خطأ');\r\n        this.isLoadingMatches = false;\r\n      },\r\n    });\r\n  }\r\n\r\n  // Start Tournament\r\n  startTournament(tournament: MultiTournamentDto): void {\r\n    this.openConfirmStartTournamentModal(tournament);\r\n  }\r\n\r\n  // Confirm and Start Tournament\r\n  confirmStartTournament(): void {\r\n    if (!this.tournamentToConfirm) return;\r\n\r\n    this.multiTournamentService\r\n      .startTournament(this.tournamentToConfirm.multiTournamentId)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم بدء البطولة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.closeConfirmStartTournamentModal();\r\n          } else {\r\n            this.toastr.error(response.message || 'فشل في بدء البطولة', 'خطأ');\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error starting tournament:', error);\r\n          this.toastr.error('خطأ في بدء البطولة', 'خطأ');\r\n        },\r\n      });\r\n  }\r\n\r\n  // Finish Tournament\r\n  finishTournament(tournament: MultiTournamentDto): void {\r\n    this.openConfirmFinishTournamentModal(tournament);\r\n  }\r\n\r\n  // Confirm and Finish Tournament\r\n  confirmFinishTournament(): void {\r\n    if (!this.tournamentToConfirm) return;\r\n\r\n    this.multiTournamentService\r\n      .finishTournament(this.tournamentToConfirm.multiTournamentId)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم إنهاء البطولة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.closeConfirmFinishTournamentModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل في إنهاء البطولة',\r\n              'خطأ'\r\n            );\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error finishing tournament:', error);\r\n          this.toastr.error('خطأ في إنهاء البطولة', 'خطأ');\r\n        },\r\n      });\r\n  }\r\n\r\n  // Delete Tournament\r\n  deleteTournament(tournament: MultiTournamentDto): void {\r\n    this.openConfirmDeleteTournamentModal(tournament);\r\n  }\r\n\r\n  // Confirm and Delete Tournament\r\n  confirmDeleteTournament(): void {\r\n    if (!this.tournamentToConfirm) return;\r\n\r\n    this.multiTournamentService\r\n      .deleteTournament(this.tournamentToConfirm.multiTournamentId)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم حذف البطولة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.closeConfirmDeleteTournamentModal();\r\n          } else {\r\n            this.toastr.error(response.message || 'فشل في حذف البطولة', 'خطأ');\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error deleting tournament:', error);\r\n          this.toastr.error('خطأ في حذف البطولة', 'خطأ');\r\n        },\r\n      });\r\n  }\r\n\r\n  // Create Team\r\n  createTeam(): void {\r\n    if (!this.createTeamForm.teamName.trim()) {\r\n      this.toastr.warning('يرجى إدخال اسم الفريق', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.createTeamForm.playerIds.length !==\r\n      (this.activeTournament?.playersPerTeam || 3)\r\n    ) {\r\n      this.toastr.warning(\r\n        `يجب اختيار ${this.activeTournament?.playersPerTeam} لاعبين بالضبط`,\r\n        'تحذير'\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!this.activeTournament) return;\r\n\r\n    this.isCreatingTeam = true;\r\n\r\n    this.multiTournamentService\r\n      .createTeam(this.activeTournament.multiTournamentId, this.createTeamForm)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success(\r\n              `تم إنشاء الفريق \"${this.createTeamForm.teamName}\" بنجاح`,\r\n              'نجاح'\r\n            );\r\n            this.loadTournaments();\r\n            this.closeCreateTeamModal();\r\n          } else {\r\n            this.toastr.error(response.message || 'فشل في إنشاء الفريق', 'خطأ');\r\n          }\r\n          this.isCreatingTeam = false;\r\n        },\r\n        error: (error) => {\r\n          console.error('Error creating team:', error);\r\n          this.toastr.error('خطأ في إنشاء الفريق', 'خطأ');\r\n          this.isCreatingTeam = false;\r\n        },\r\n      });\r\n  }\r\n\r\n  // Add Player\r\n  addNewPlayer(): void {\r\n    if (!this.newPlayerName.trim()) {\r\n      this.toastr.warning('يرجى إدخال اسم اللاعب', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    this.isAddingPlayer = true;\r\n\r\n    this.multiTournamentService\r\n      .addNewPlayer({ fullName: this.newPlayerName.trim() })\r\n      .subscribe({\r\n        next: (response: ApiResponse<PlayerDetail>) => {\r\n          if (response.success) {\r\n            this.toastr.success(\r\n              `تم إضافة اللاعب ${this.newPlayerName} بنجاح`,\r\n              'نجاح'\r\n            );\r\n            this.loadAvailablePlayers();\r\n            this.showAddPlayerModal = false;\r\n            this.newPlayerName = '';\r\n          } else {\r\n            this.toastr.error(response.message || 'فشل في إضافة اللاعب', 'خطأ');\r\n          }\r\n          this.isAddingPlayer = false;\r\n        },\r\n        error: (error) => {\r\n          console.error('Error adding player:', error);\r\n          this.toastr.error('خطأ في إضافة اللاعب', 'خطأ');\r\n          this.isAddingPlayer = false;\r\n        },\r\n      });\r\n  }\r\n\r\n  // Team Management\r\n  togglePlayerSelection(playerId: number): void {\r\n    const index = this.createTeamForm.playerIds.indexOf(playerId);\r\n    if (index === -1) {\r\n      if (\r\n        this.createTeamForm.playerIds.length <\r\n        (this.activeTournament?.playersPerTeam || 3)\r\n      ) {\r\n        this.createTeamForm.playerIds.push(playerId);\r\n      } else {\r\n        this.toastr.warning(\r\n          `يمكن اختيار ${this.activeTournament?.playersPerTeam} لاعبين فقط`,\r\n          'تحذير'\r\n        );\r\n      }\r\n    } else {\r\n      this.createTeamForm.playerIds.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  isPlayerSelected(playerId: number): boolean {\r\n    return this.createTeamForm.playerIds.includes(playerId);\r\n  }\r\n\r\n  // Match Recording\r\n  recordMatchResult(): void {\r\n    if (!this.selectedMatchId || !this.activeTournament) return;\r\n\r\n    // Validate scores\r\n    if (!this.recordingScore1.trim() || !this.recordingScore2.trim()) {\r\n      this.toastr.warning('يرجى إدخال النتيجة للاعبين', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    // Parse scores to numbers\r\n    const score1 = parseFloat(this.recordingScore1);\r\n    const score2 = parseFloat(this.recordingScore2);\r\n\r\n    // Check if scores are valid numbers\r\n    if (isNaN(score1) || isNaN(score2)) {\r\n      this.toastr.warning('يرجى إدخال أرقام صحيحة', 'تحذير');\r\n      return;\r\n    }\r\n\r\n    let requestBody: any = {};\r\n\r\n    if (this.activeTournament.systemOfScoring === 'Classic') {\r\n      // Classic system: determine winner automatically based on scores\r\n      if (score1 > score2) {\r\n        requestBody.winnerId = this.selectedPlayer1Id;\r\n      } else if (score2 > score1) {\r\n        requestBody.winnerId = this.selectedPlayer2Id;\r\n      } else {\r\n        requestBody.winnerId = null; // Draw\r\n      }\r\n    } else {\r\n      // Points system: send scores directly\r\n      requestBody.score1 = score1;\r\n      requestBody.score2 = score2;\r\n    }\r\n\r\n    this.isRecordingResult = true;\r\n\r\n    this.multiTournamentService\r\n      .recordMatchResult(this.selectedMatchId, requestBody)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم تسجيل نتيجة المباراة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.loadTournamentMatches();\r\n            this.closeRecordResultModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل في تسجيل النتيجة',\r\n              'خطأ'\r\n            );\r\n          }\r\n          this.isRecordingResult = false;\r\n        },\r\n        error: (error) => {\r\n          console.error('Error recording match result:', error);\r\n          this.toastr.error('خطأ في تسجيل نتيجة المباراة', 'خطأ');\r\n          this.isRecordingResult = false;\r\n        },\r\n      });\r\n  }\r\n\r\n  undoMatchResult(match: MatchDetail): void {\r\n    this.openConfirmUndoMatchModal(match);\r\n  }\r\n\r\n  // Confirm and Undo Match Result\r\n  confirmUndoMatchResult(): void {\r\n    if (!this.matchToUndo) return;\r\n\r\n    this.multiTournamentService\r\n      .undoMatchResult(this.matchToUndo.multiMatchId)\r\n      .subscribe({\r\n        next: (response: ApiResponse) => {\r\n          if (response.success) {\r\n            this.toastr.success('تم إلغاء نتيجة المباراة بنجاح', 'نجاح');\r\n            this.loadTournaments();\r\n            this.loadTournamentMatches();\r\n            this.closeConfirmUndoMatchModal();\r\n          } else {\r\n            this.toastr.error(\r\n              response.message || 'فشل في إلغاء النتيجة',\r\n              'خطأ'\r\n            );\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error undoing match result:', error);\r\n          this.toastr.error('خطأ في إلغاء نتيجة المباراة', 'خطأ');\r\n        },\r\n      });\r\n  }\r\n\r\n  // Modal Controls\r\n  openCreateTeamModal(tournament: MultiTournamentDto): void {\r\n    this.activeTournament = tournament;\r\n    this.createTeamForm = {\r\n      teamName: '',\r\n      playerIds: [],\r\n    };\r\n    this.showCreateTeamModal = true;\r\n  }\r\n\r\n  closeCreateTeamModal(): void {\r\n    this.showCreateTeamModal = false;\r\n    this.activeTournament = null;\r\n  }\r\n\r\n  closeRecordResultModal(): void {\r\n    this.showRecordResultModal = false;\r\n    this.selectedMatchId = null;\r\n    this.selectedPlayer1Id = null;\r\n    this.selectedPlayer2Id = null;\r\n    this.recordingScore1 = '';\r\n    this.recordingScore2 = '';\r\n  }\r\n\r\n  // Confirmation Modal Controls\r\n  openConfirmStartTournamentModal(tournament: MultiTournamentDto): void {\r\n    this.tournamentToConfirm = tournament;\r\n    this.showConfirmStartTournamentModal = true;\r\n  }\r\n\r\n  closeConfirmStartTournamentModal(): void {\r\n    this.showConfirmStartTournamentModal = false;\r\n    this.tournamentToConfirm = null;\r\n  }\r\n\r\n  openConfirmFinishTournamentModal(tournament: MultiTournamentDto): void {\r\n    this.tournamentToConfirm = tournament;\r\n    this.showConfirmFinishTournamentModal = true;\r\n  }\r\n\r\n  closeConfirmFinishTournamentModal(): void {\r\n    this.showConfirmFinishTournamentModal = false;\r\n    this.tournamentToConfirm = null;\r\n  }\r\n\r\n  openConfirmDeleteTournamentModal(tournament: MultiTournamentDto): void {\r\n    this.tournamentToConfirm = tournament;\r\n    this.showConfirmDeleteTournamentModal = true;\r\n  }\r\n\r\n  closeConfirmDeleteTournamentModal(): void {\r\n    this.showConfirmDeleteTournamentModal = false;\r\n    this.tournamentToConfirm = null;\r\n  }\r\n\r\n  openConfirmUndoMatchModal(match: MatchDetail): void {\r\n    this.matchToUndo = match;\r\n    this.showConfirmUndoMatchModal = true;\r\n  }\r\n\r\n  closeConfirmUndoMatchModal(): void {\r\n    this.showConfirmUndoMatchModal = false;\r\n    this.matchToUndo = null;\r\n  }\r\n\r\n  getTrophyIcon(position: number): string {\r\n    switch (position) {\r\n      case 1:\r\n        return '🥇';\r\n      case 2:\r\n        return '🥈';\r\n      case 3:\r\n        return '🥉';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  canFinishTournament(tournament: MultiTournamentDto): boolean {\r\n    return tournament.status === 'Started';\r\n  }\r\n\r\n  canDeleteTournament(tournament: MultiTournamentDto): boolean {\r\n    return tournament.status === 'Created';\r\n  }\r\n\r\n  openRecordResultModal(match: MatchDetail): void {\r\n    this.selectedMatchId = match.multiMatchId;\r\n    this.selectedPlayer1Id = match.player1Id;\r\n    this.selectedPlayer2Id = match.player2Id;\r\n    this.recordingScore1 = '';\r\n    this.recordingScore2 = '';\r\n    this.showRecordResultModal = true;\r\n    // Close player matches modal when opening record result modal\r\n    this.showPlayerMatchesModal = false;\r\n  }\r\n\r\n  // Close Player Matches Modal\r\n  closePlayerMatchesModal(): void {\r\n    this.showPlayerMatchesModal = false;\r\n    this.selectedPlayer = null;\r\n  }\r\n\r\n  // Player Selection\r\n  selectPlayer(player: PlayerDetail): void {\r\n    this.selectedPlayer = player;\r\n    this.opponentSearchTerm = '';\r\n    this.showPlayerMatchesModal = true;\r\n    this.loadTournamentMatches();\r\n  }\r\n\r\n  // Get Player Matches\r\n  getPlayerMatches(playerId: number): MatchDetail[] {\r\n    if (!this.tournamentMatches || this.tournamentMatches.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    const playerMatches: MatchDetail[] = [];\r\n\r\n    this.tournamentMatches.forEach((fixture) => {\r\n      fixture.matches.forEach((match) => {\r\n        if (match.player1Id === playerId || match.player2Id === playerId) {\r\n          playerMatches.push(match);\r\n        }\r\n      });\r\n    });\r\n\r\n    return playerMatches;\r\n  }\r\n\r\n  // Get Player Name by ID\r\n  getPlayerName(playerId: number | null): string {\r\n    if (!playerId) return 'Unknown Player';\r\n\r\n    const player = this.availablePlayers.find((p) => p.playerId === playerId);\r\n    return player ? player.fullName : 'Unknown Player';\r\n  }\r\n\r\n  // Get Team Players Names\r\n  getTeamPlayersNames(team: TeamDetail): string[] {\r\n    if (!team.players || team.players.length === 0) {\r\n      return ['No players'];\r\n    }\r\n    return team.players.map((p) => p.fullName);\r\n  }\r\n\r\n  // Filter Players by Search Term\r\n  filterPlayers(): void {\r\n    if (!this.playerSearchTerm || this.playerSearchTerm.trim() === '') {\r\n      this.filteredPlayers = [...this.availablePlayers];\r\n    } else {\r\n      const searchTerm = this.playerSearchTerm.trim();\r\n      this.filteredPlayers = this.availablePlayers.filter((player) =>\r\n        player.fullName.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n    }\r\n  }\r\n\r\n  // Filter Player Matches by Opponent Name\r\n  filterPlayerMatches(): void {\r\n    if (!this.selectedPlayer) return;\r\n\r\n    const allMatches = this.getPlayerMatches(this.selectedPlayer.playerId || 0);\r\n\r\n    if (!this.opponentSearchTerm || this.opponentSearchTerm.trim() === '') {\r\n      this.filteredPlayerMatches = allMatches;\r\n    } else {\r\n      const searchTerm = this.opponentSearchTerm.trim();\r\n      this.filteredPlayerMatches = allMatches.filter((match) => {\r\n        const player1Name = match.player1Name?.toLowerCase() || '';\r\n        const player2Name = match.player2Name?.toLowerCase() || '';\r\n        const searchLower = searchTerm.toLowerCase();\r\n\r\n        // Search in both player names (excluding the selected player)\r\n        if (match.player1Id === this.selectedPlayer?.playerId) {\r\n          return player2Name.includes(searchLower);\r\n        } else if (match.player2Id === this.selectedPlayer?.playerId) {\r\n          return player1Name.includes(searchLower);\r\n        }\r\n        return false;\r\n      });\r\n    }\r\n  }\r\n\r\n  // ============================\r\n  // 🔄 Player Replacement\r\n  // ============================\r\n\r\n  // Open Replace Player Modal\r\n  openReplacePlayerModal(team: TeamDetail): void {\r\n    console.log('🔍 openReplacePlayerModal called with team:', team);\r\n    this.selectedTeamForReplacement = team;\r\n    this.replacePlayerForm = {\r\n      replacedPlayerId: 0,\r\n      newPlayerId: 0,\r\n    };\r\n\r\n    // Load available players for replacement (excluding current team players)\r\n    this.loadAvailablePlayersForReplacement(team);\r\n    this.showReplacePlayerModal = true;\r\n    console.log(\r\n      '🔍 showReplacePlayerModal set to:',\r\n      this.showReplacePlayerModal\r\n    );\r\n  }\r\n\r\n  // Close Replace Player Modal\r\n  closeReplacePlayerModal(): void {\r\n    this.showReplacePlayerModal = false;\r\n    this.selectedTeamForReplacement = null;\r\n    this.replacePlayerForm = {\r\n      replacedPlayerId: 0,\r\n      newPlayerId: 0,\r\n    };\r\n  }\r\n\r\n  // Load Available Players for Replacement\r\n  loadAvailablePlayersForReplacement(team: TeamDetail): void {\r\n    if (!team.players) return;\r\n\r\n    // Get current team player IDs\r\n    const currentTeamPlayerIds = team.players.map((p) => p.playerId);\r\n\r\n    // Filter out players who are already in this team or other teams in active tournament\r\n    this.availablePlayersForReplacement = this.availablePlayers.filter(\r\n      (player) => {\r\n        // Exclude current team players\r\n        if (currentTeamPlayerIds.includes(player.playerId)) {\r\n          return false;\r\n        }\r\n\r\n        // Exclude players who are already in other teams in active tournament\r\n        if (this.activeTournament) {\r\n          const isInOtherTeam = this.activeTournament.teams.some(\r\n            (t) =>\r\n              t.multiTeamId !== team.multiTeamId &&\r\n              t.players.some((p) => p.playerId === player.playerId)\r\n          );\r\n          if (isInOtherTeam) {\r\n            return false;\r\n          }\r\n        }\r\n\r\n        return true;\r\n      }\r\n    );\r\n  }\r\n\r\n  // Select Player to Replace\r\n  selectPlayerToReplace(playerId: number): void {\r\n    this.replacePlayerForm.replacedPlayerId = playerId;\r\n  }\r\n\r\n  // Select New Player\r\n  selectNewPlayer(playerId: number): void {\r\n    this.replacePlayerForm.newPlayerId = playerId;\r\n  }\r\n\r\n  // Replace Player\r\n  replacePlayer(): void {\r\n    if (\r\n      !this.selectedTeamForReplacement ||\r\n      !this.replacePlayerForm.replacedPlayerId ||\r\n      !this.replacePlayerForm.newPlayerId\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.isReplacingPlayer = true;\r\n\r\n    this.multiTournamentService\r\n      .replacePlayer(this.selectedTeamForReplacement.multiTeamId, {\r\n        replacedPlayerId: this.replacePlayerForm.replacedPlayerId,\r\n        newPlayerId: this.replacePlayerForm.newPlayerId,\r\n      })\r\n      .subscribe({\r\n        next: (response) => {\r\n          if (response.success) {\r\n            this.toastr.success('Player replaced successfully!');\r\n            this.closeReplacePlayerModal();\r\n            // Reload tournaments to get updated data\r\n            this.loadTournaments();\r\n          } else {\r\n            this.toastr.error(response.message || 'Failed to replace player');\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error replacing player:', error);\r\n          this.toastr.error('An error occurred while replacing the player');\r\n        },\r\n        complete: () => {\r\n          this.isReplacingPlayer = false;\r\n        },\r\n      });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule } from '@angular/router';\r\n\r\nimport { AdminRoutingModule } from './admin-routing.module';\r\nimport { PlayersComponent } from './players/players.component';\r\n\r\nimport { FriendliesComponent } from './friendlies/friendlies.component';\r\nimport { FriendlyInboxComponent } from './friendlies/friendly-inbox/friendly-inbox.component';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { FindPlayerPipe } from '../pipes/find-player.pipe';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { UtcToLocalPipe } from '../pipes/utcToLocal.pipe';\r\nimport { PlayerModule } from '../player/player.module';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { TeamsDashboardComponent } from './teams-dashboard/teams-dashboard.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    PlayersComponent,\r\n    FriendliesComponent,\r\n    FriendlyInboxComponent,\r\n    FindPlayerPipe,\r\n    UtcToLocalPipe,\r\n    TeamsDashboardComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    AdminRoutingModule,\r\n    RouterModule,\r\n    FormsModule,\r\n    HttpClientModule,\r\n    PlayerModule,\r\n    SharedModule,\r\n  ],\r\n})\r\nexport class AdminModule {}\r\n"],"x_google_ignoreList":[]}